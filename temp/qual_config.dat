
-----------------ctrx_d_qual_medicare_benf-------------------
{
  "final_table_schema": "{\"qmb_sk\": \"double\", \"mbr_sk\": \"double\", \"cag_sk\": \"double\", \"carrier_sk\": \"double\", \"carrier_id\": \"string\", \"account_id\": \"string\", \"employer_group_id\": \"string\", \"mbr_id\": \"string\", \"qmb_medicare_id\": \"string\", \"qmb_seq_no\": \"double\", \"qmb_medicaid_dual_sts_cd\": \"string\", \"qmb_from_dt_sk\": \"double\", \"qmb_from_dt\": \"date\", \"qmb_thru_dt_sk\": \"double\", \"qmb_thru_dt\": \"date\", \"qmb_status_cd\": \"string\", \"src_env_sk\": \"double\", \"sec_flg\": \"double\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "pipeline_name": "ctd_qual_medicare_benf",
  "primary_key": "carrier_id,account_id,employer_group_id,mbr_id,qmb_medicare_id,qmb_seq_no,src_env_sk",
  "reformat_rules": "{\n  \"qmb_thru_dt_sk\": \"in1_qmb_thru_dt_sk\",\n  \"cag_sk\": \"in1_cag_sk\",\n  \"mbr_id\": \"getDefaultedElseTrimmed(CAST(ahabcd AS STRING), '')\",\n  \"sec_flg\": \"0\",\n  \"mbr_sk\": \"in1_mbr_sk\",\n  \"qmb_sk\": \"-1\",\n  \"qmb_seq_no\": \"CASE WHEN isNullOrBlank(ahp0bt) THEN '' ELSE coalesce(ahp0bt, force_error('Not a valid number')) END\",\n  \"qmb_from_dt\": \"CASE WHEN coalesce((array_contains(array(6, 7), length(trim(ahm5cg))) AND ((NOT (CASE WHEN (length(trim((19000000 + trim(CAST(ahm5cg AS DECIMAL(9,0)))))) = 8) THEN date_format(to_date(trim((19000000 + trim(CAST(ahm5cg AS DECIMAL(9,0))))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim((19000000 + trim(ahm5cg)))) = 8) THEN date_format(to_date(trim((19000000 + trim(ahm5cg))), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce(((length(trim(ahm5cg)) = 8) AND ((NOT (CASE WHEN (length(trim(trim(CAST(ahm5cg AS DECIMAL(9,0))))) = 8) THEN date_format(to_date(trim(trim(CAST(ahm5cg AS DECIMAL(9,0)))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(trim(ahm5cg))) = 8) THEN date_format(to_date(trim(trim(ahm5cg)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\",\n  \"qmb_from_dt_sk\": \"in1_qmb_from_dt_sk\",\n  \"qmb_medicaid_dual_sts_cd\": \"getDefaultedElseTrimmed(CAST(ahiiax AS STRING), '-')\",\n  \"carrier_sk\": \"in1_carrier_sk\",\n  \"account_id\": \"getDefaultedElseTrimmed(CAST(ahaccd AS STRING), '')\",\n  \"carrier_id\": \"getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '')\",\n  \"qmb_medicare_id\": \"getDefaultedElseTrimmed(CAST(ahg1vi AS STRING), '')\",\n  \"employer_group_id\": \"getDefaultedElseTrimmed(CAST(ahadcd AS STRING), '')\",\n  \"qmb_status_cd\": \"getDefaultedElseTrimmed(CAST(ahijax AS STRING), '-')\",\n  \"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"qmb_thru_dt\": \"CASE WHEN coalesce((array_contains(array(6, 7), length(trim(ahm6cg))) AND ((NOT (CASE WHEN (length(trim((19000000 + trim(CAST(ahm6cg AS DECIMAL(9,0)))))) = 8) THEN date_format(to_date(trim((19000000 + trim(CAST(ahm6cg AS DECIMAL(9,0))))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim((19000000 + trim(ahm6cg)))) = 8) THEN date_format(to_date(trim((19000000 + trim(ahm6cg))), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce(((length(trim(ahm6cg)) = 8) AND ((NOT (CASE WHEN (length(trim(trim(CAST(ahm6cg AS DECIMAL(9,0))))) = 8) THEN date_format(to_date(trim(trim(CAST(ahm6cg AS DECIMAL(9,0)))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(trim(ahm6cg))) = 8) THEN date_format(to_date(trim(trim(ahm6cg)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\",\n  \"ahm6cg\": \"ahm6cg\",\n  \"ahm5cg\": \"ahm5cg\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_cag\",\n    \"join-cond\": \"in1.carrier_id = getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '') AND in1.account_id = getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '') AND in1.employer_group_id = getDefaultedElseTrimmed(CAST(ahadcd AS STRING), '')\",\n    \"val-cols\": [\n      \"in1.cag_sk as in1_cag_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_carrier\",\n    \"join-cond\": \"in1.carrier_id = getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '')\",\n    \"val-cols\": [\n      \"in1.carrier_sk as in1_carrier_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_date\",\n    \"join-cond\": \"in1.cal_day_dt = CASE WHEN coalesce((array_contains(array(6, 7), length(trim(in0.ahm5cg))) AND ((NOT (CASE WHEN (length(trim((19000000 + trim(CAST(in0.ahm5cg AS DECIMAL(9,0)))))) = 8) THEN date_format(to_date(trim((19000000 + trim(CAST(in0.ahm5cg AS DECIMAL(9,0))))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim((19000000 + trim(in0.ahm5cg)))) = 8) THEN date_format(to_date(trim((19000000 + trim(in0.ahm5cg))), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce(((length(trim(in0.ahm5cg)) = 8) AND ((NOT (CASE WHEN (length(trim(trim(CAST(in0.ahm5cg AS DECIMAL(9,0))))) = 8) THEN date_format(to_date(trim(trim(CAST(in0.ahm5cg AS DECIMAL(9,0)))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(trim(in0.ahm5cg))) = 8) THEN date_format(to_date(trim(trim(in0.ahm5cg)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\",\n    \"val-cols\": [\n      \"in1.dt_sk as in1_qmb_from_dt_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_member\",\n    \"join-cond\": \"in1.carrier_id = getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '') AND in1.account_id = getDefaultedElseTrimmed(CAST(ahaccd AS STRING), '') AND in1.employer_group_id = getDefaultedElseTrimmed(CAST(ahadcd AS STRING), '') AND in1.mbr_id = getDefaultedElseTrimmed(CAST(ahabcd AS STRING), '')\",\n    \"val-cols\": [\n      \"in1.mbr_sk as in1_mbr_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_date\",\n    \"join-cond\": \"in1.cal_day_dt = CASE WHEN coalesce((array_contains(array(6, 7), length(trim(in0.ahm6cg))) AND ((NOT (CASE WHEN (length(trim((19000000 + trim(CAST(in0.ahm6cg AS DECIMAL(9,0)))))) = 8) THEN date_format(to_date(trim((19000000 + trim(CAST(in0.ahm6cg AS DECIMAL(9,0))))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim((19000000 + trim(in0.ahm6cg)))) = 8) THEN date_format(to_date(trim((19000000 + trim(in0.ahm6cg))), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce(((length(trim(in0.ahm6cg)) = 8) AND ((NOT (CASE WHEN (length(trim(trim(CAST(in0.ahm6cg AS DECIMAL(9,0))))) = 8) THEN date_format(to_date(trim(trim(CAST(in0.ahm6cg AS DECIMAL(9,0)))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(trim(in0.ahm6cg))) = 8) THEN date_format(to_date(trim(trim(in0.ahm6cg)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\",\n    \"val-cols\": [\n      \"in1.dt_sk as in1_qmb_thru_dt_sk\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"SELECT rcqmbp.ahabcd , rcqmbp.ahaacd , rcqmbp.ahaccd , rcqmbp.ahadcd , rcqmbp.ahg1vi , rcqmbp.ahp0bt , rcqmbp.ahiiax , rcqmbp.ahm5cg , rcqmbp.ahm6cg , rcqmbp.ahijax , rcqmbp.ahakvn , rcqmbp.ahc2dt , rcqmbp.ahadtm , rcqmbp.ahalvn , rcqmbp.ahadvn , rcqmbp.ahbmdt , rcqmbp.ahabtm , rcqmbp.ahaevn, src_env_sk FROM rxclaims.rcqmbp  rcqmbp WHERE rcqmbp.UPDATE_TIMESTAMP between '2023-10-16 01:00:00' and date_format(now(), 'yyyy-MM-dd HH:mm:ss')\"\n}]",
  "source_table": "RCQMBP",
  "target_table": "d_qual_medicare_benf",
  "sk_service_col": "qmb_sk",
  "read_incremental_files_flag": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"d_cag\",\n    \"sk-col\": \"cag_sk\",\n    \"nk-col\": [\n      \"getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '')\",\n      \"getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '')\",\n      \"getDefaultedElseTrimmed(CAST(ahadcd AS STRING), '')\"\n    ]\n  },\n  {\n    \"table-name\": \"d_carrier\",\n    \"sk-col\": \"carrier_sk\",\n    \"nk-col\": [\n      \"getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '')\"\n    ]\n  },\n  {\n    \"table-name\": \"d_date\",\n    \"sk-col\": \"dt_sk\",\n    \"nk-col\": [\n      \"CASE WHEN coalesce((array_contains(array(6, 7), length(trim(ahm5cg))) AND ((NOT (CASE WHEN (length(trim((19000000 + trim(CAST(ahm5cg AS DECIMAL(9,0)))))) = 8) THEN date_format(to_date(trim((19000000 + trim(CAST(ahm5cg AS DECIMAL(9,0))))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim((19000000 + trim(ahm5cg)))) = 8) THEN date_format(to_date(trim((19000000 + trim(ahm5cg))), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce(((length(trim(ahm5cg)) = 8) AND ((NOT (CASE WHEN (length(trim(trim(CAST(ahm5cg AS DECIMAL(9,0))))) = 8) THEN date_format(to_date(trim(trim(CAST(ahm5cg AS DECIMAL(9,0)))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(trim(ahm5cg))) = 8) THEN date_format(to_date(trim(trim(ahm5cg)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\"\n    ]\n  },\n  {\n    \"table-name\": \"d_member\",\n    \"sk-col\": \"mbr_sk\",\n    \"nk-col\": [\n      \"getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '')\",\n      \"getDefaultedElseTrimmed(CAST(ahaccd AS STRING), '')\",\n      \"getDefaultedElseTrimmed(CAST(ahadcd AS STRING), '')\",\n      \"getDefaultedElseTrimmed(CAST(ahabcd AS STRING), '')\"\n    ]\n  },\n  {\n    \"table-name\": \"d_date\",\n    \"sk-col\": \"dt_sk\",\n    \"nk-col\": [\n      \"CASE WHEN coalesce((array_contains(array(6, 7), length(trim(ahm6cg))) AND ((NOT (CASE WHEN (length(trim((19000000 + trim(CAST(ahm6cg AS DECIMAL(9,0)))))) = 8) THEN date_format(to_date(trim((19000000 + trim(CAST(ahm6cg AS DECIMAL(9,0))))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim((19000000 + trim(ahm6cg)))) = 8) THEN date_format(to_date(trim((19000000 + trim(ahm6cg))), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce(((length(trim(ahm6cg)) = 8) AND ((NOT (CASE WHEN (length(trim(trim(CAST(ahm6cg AS DECIMAL(9,0))))) = 8) THEN date_format(to_date(trim(trim(CAST(ahm6cg AS DECIMAL(9,0)))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(trim(ahm6cg))) = 8) THEN date_format(to_date(trim(trim(ahm6cg)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\"\n    ]\n  }\n]"
}
ghp_CqFc6aIm0m4dlmUdmw1xh2gqw9tSNr12OvF
-----------------orx_d_member_adjustment-------------------
{
  "final_table_schema": "{\"mad_sk\": \"long\", \"mbr_sk\": \"long\", \"cag_sk\": \"long\", \"carrier_sk\": \"long\", \"mbr_id\": \"string\", \"carrier_id\": \"string\", \"account_id\": \"string\", \"employer_group_id\": \"string\", \"mad_adjtmnt_dt\": \"date\", \"mad_seq_nbr\": \"short\", \"mad_stat_cd\": \"string\", \"acm_accumultn_cd\": \"string\", \"adj_adjtmnt_cd\": \"string\", \"mad_adjtmnt_amt\": \"decimal(9, 2)\", \"mad_ben_ded_typ_cd\": \"string\", \"mad_clt_bnft_cd\": \"string\", \"mad_rec_ts\": \"timestamp\", \"mad_rec_order\": \"long\", \"mad_rec_id\": \"string\", \"mad_amt_typ_cd\": \"string\", \"mad_sender_typ_cd\": \"string\", \"mad_sender_id\": \"string\", \"mad_sender_desc\": \"string\", \"mad_sender_claim_nbr\": \"string\", \"mad_sender_claim_seq_nbr\": \"string\", \"mad_sender_claim_stat_cd\": \"string\", \"mad_sender_ts\": \"timestamp\", \"mad_adj_time\": \"timestamp\", \"mad_adj_ms\": \"short\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "pipeline_name": "orx_d_member_adjustment",
  "primary_key": "mbr_id,carrier_id,account_id,employer_group_id,mad_adjtmnt_dt,mad_seq_nbr,src_env_sk",
  "reformat_rules": "{\n  \"mad_sk\": \"-1\",\n  \"mad_sender_typ_cd\": \"i5b4h9\",\n  \"mad_clt_bnft_cd\": \"i5dgih\",\n  \"mad_seq_nbr\": \"CAST(i5emn1 AS DECIMAL(38,0))\",\n  \"cag_sk\": \"in1_cag_sk\",\n  \"mad_sender_claim_nbr\": \"i5dmih\",\n  \"mad_adjtmnt_dt\": \"CASE WHEN coalesce(((length(CAST(i5h1dt AS STRING)) = 8) AND ((NOT (CASE WHEN (length(trim(CAST(i5h1dt AS STRING))) = 8) THEN date_format(to_date(trim(CAST(i5h1dt AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(CAST(i5h1dt AS STRING))) = 8) THEN date_format(to_date(trim(CAST(i5h1dt AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce((array_contains(array(6, 7), length(CAST(i5h1dt AS STRING))) AND ((NOT (CASE WHEN (length(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING))) = 8) THEN date_format(to_date(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING))) = 8) THEN date_format(to_date(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE NULL END\",\n  \"mbr_id\": \"i5abcd\",\n  \"mad_stat_cd\": \"i5yns2\",\n  \"mad_rec_ts\": \"CASE WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 20), 'yyyy-MM-dd HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(substring(i5dhih, 1, 25), 'yyyy-MM-ddHH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(substring(i5dhih, 1, 25), 1, 19), 'yyyy-MM-ddHH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd-HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 20), 'yyyy-MM-dd-HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 22), 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.'), 'yyyyMMdd HH:mm:ss') ELSE '19000101 00:00:00' END\",\n  \"mad_ben_ded_typ_cd\": \"i5d6s2\",\n  \"mad_sender_id\": \"i5dkih\",\n  \"mbr_sk\": \"in1_mbr_sk\",\n  \"acm_accumultn_cd\": \"i5rjc2\",\n  \"mad_adj_ms\": \"CAST(i5hibr AS DECIMAL(38,0))\",\n  \"carrier_sk\": \"in1_carrier_sk\",\n  \"mad_sender_claim_seq_nbr\": \"i5dnih\",\n  \"mad_rec_id\": \"i5djih\",\n  \"account_id\": \"i5accd\",\n  \"mad_rec_order\": \"CAST(i5yshr AS DECIMAL(38,0))\",\n  \"carrier_id\": \"i5aacd\",\n  \"mad_amt_typ_cd\": \"i5b3h9\",\n  \"mad_adj_time\": \"date_format(to_timestamp(lpad(CAST(i5bltx AS STRING), 6, '0'), 'HHmmss'), 'HH:mm:ss.SSSSSS')\",\n  \"mad_adjtmnt_amt\": \"i5nbpr\",\n  \"employer_group_id\": \"i5adcd\",\n  \"adj_adjtmnt_cd\": \"i5rkc2\",\n  \"mad_sender_claim_stat_cd\": \"i5doih\",\n  \"mad_sender_desc\": \"i5dlih\",\n  \"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"mad_sender_ts\": \"CASE WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd-HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 20), 'yyyy-MM-dd-HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(substring(i5dpih, 1, 25), 'yyyy-MM-ddHH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(substring(i5dpih, 1, 25), 1, 19), 'yyyy-MM-ddHH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 20), 'yyyy-MM-dd HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 22), 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.'), 'yyyyMMdd HH:mm:ss') ELSE '19000101 00:00:00' END\",\n  \"i5accd\": \"i5accd\",\n  \"i5aacd\": \"i5aacd\",\n  \"i5adcd\": \"i5adcd\",\n  \"i5abcd\": \"i5abcd\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_cag\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd AND in1.account_id = in0.i5accd AND in1.employer_group_id = in0.i5adcd\",\n    \"val-cols\": [\n      \"in1.cag_sk as in1_cag_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_carrier\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd\",\n    \"val-cols\": [\n      \"in1.carrier_sk as in1_carrier_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_member\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd AND in1.account_id = in0.i5accd AND in1.employer_group_id = in0.i5adcd AND in1.mbr_id = in0.i5abcd\",\n    \"val-cols\": [\n      \"in1.mbr_sk as in1_mbr_sk\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "d_member_adjustment",
  "sk_service_col": "mad_sk",
  "read_incremental_files_flag": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"d_cag\",\n    \"sk-col\": \"cag_sk\",\n    \"nk-col\": [\n      \"i5aacd\",\n      \"i5accd\",\n      \"i5adcd\"\n    ]\n  },\n  {\n    \"table-name\": \"d_carrier\",\n    \"sk-col\": \"carrier_sk\",\n    \"nk-col\": [\n      \"i5aacd\"\n    ]\n  },\n  {\n    \"table-name\": \"d_member\",\n    \"sk-col\": \"mbr_sk\",\n    \"nk-col\": [\n      \"i5aacd\",\n      \"i5accd\",\n      \"i5adcd\",\n      \"i5abcd\"\n    ]\n  }\n]"
}
-----------------ctrx_d_member_adjustment-------------------
{
  "final_table_schema": "{\"mad_sk\": \"long\", \"mbr_sk\": \"long\", \"cag_sk\": \"long\", \"carrier_sk\": \"long\", \"mbr_id\": \"string\", \"carrier_id\": \"string\", \"account_id\": \"string\", \"employer_group_id\": \"string\", \"mad_adjtmnt_dt\": \"date\", \"mad_seq_nbr\": \"short\", \"mad_stat_cd\": \"string\", \"acm_accumultn_cd\": \"string\", \"adj_adjtmnt_cd\": \"string\", \"mad_adjtmnt_amt\": \"decimal(9, 2)\", \"mad_ben_ded_typ_cd\": \"string\", \"mad_clt_bnft_cd\": \"string\", \"mad_rec_ts\": \"timestamp\", \"mad_rec_order\": \"long\", \"mad_rec_id\": \"string\", \"mad_amt_typ_cd\": \"string\", \"mad_sender_typ_cd\": \"string\", \"mad_sender_id\": \"string\", \"mad_sender_desc\": \"string\", \"mad_sender_claim_nbr\": \"string\", \"mad_sender_claim_seq_nbr\": \"string\", \"mad_sender_claim_stat_cd\": \"string\", \"mad_sender_ts\": \"timestamp\", \"mad_adj_time\": \"timestamp\", \"mad_adj_ms\": \"short\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "pipeline_name": "ctrx_d_member_adjustment",
  "primary_key": "mbr_id,carrier_id,account_id,employer_group_id,mad_adjtmnt_dt,mad_seq_nbr,src_env_sk",
  "reformat_rules": "{\n  \"mad_sk\": \"-1\",\n  \"mad_sender_typ_cd\": \"i5b4h9\",\n  \"mad_clt_bnft_cd\": \"i5dgih\",\n  \"mad_seq_nbr\": \"CAST(i5emn1 AS DECIMAL(38,0))\",\n  \"cag_sk\": \"in1_cag_sk\",\n  \"mad_sender_claim_nbr\": \"i5dmih\",\n  \"mad_adjtmnt_dt\": \"CASE WHEN coalesce(((length(CAST(i5h1dt AS STRING)) = 8) AND ((NOT (CASE WHEN (length(trim(CAST(i5h1dt AS STRING))) = 8) THEN date_format(to_date(trim(CAST(i5h1dt AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(CAST(i5h1dt AS STRING))) = 8) THEN date_format(to_date(trim(CAST(i5h1dt AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce((array_contains(array(6, 7), length(CAST(i5h1dt AS STRING))) AND ((NOT (CASE WHEN (length(trim(CAST((19000000 + CAST(i5h1dt AS STRING)) AS STRING))) = 8) THEN date_format(to_date(trim(CAST((19000000 + CAST(i5h1dt AS STRING)) AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING))) = 8) THEN date_format(to_date(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\",\n  \"mbr_id\": \"i5abcd\",\n  \"mad_stat_cd\": \"i5yns2\",\n  \"mad_rec_ts\": \"CASE WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd-HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 20), 'yyyy-MM-dd-HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(substring(i5dhih, 1, 25), 'yyyy-MM-ddHH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(substring(i5dhih, 1, 25), 1, 19), 'yyyy-MM-ddHH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 20), 'yyyy-MM-dd HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 22), 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.'), 'yyyyMMdd HH:mm:ss') ELSE '19000101 00:00:00' END\",\n  \"mad_ben_ded_typ_cd\": \"i5d6s2\",\n  \"mad_sender_id\": \"i5dkih\",\n  \"mbr_sk\": \"in1_mbr_sk\",\n  \"acm_accumultn_cd\": \"i5rjc2\",\n  \"mad_adj_ms\": \"CAST(i5hibr AS DECIMAL(38,0))\",\n  \"carrier_sk\": \"in1_carrier_sk\",\n  \"mad_sender_claim_seq_nbr\": \"i5dnih\",\n  \"mad_rec_id\": \"i5djih\",\n  \"account_id\": \"i5accd\",\n  \"mad_rec_order\": \"CAST(i5yshr AS DECIMAL(38,0))\",\n  \"carrier_id\": \"i5aacd\",\n  \"mad_amt_typ_cd\": \"i5b3h9\",\n  \"mad_adj_time\": \"date_format(to_timestamp(lpad(CAST(i5bltx AS STRING), 6, '0'), 'HHmmss'), 'HH:mm:ss.SSSSSS')\",\n  \"mad_adjtmnt_amt\": \"i5nbpr\",\n  \"employer_group_id\": \"i5adcd\",\n  \"adj_adjtmnt_cd\": \"i5rkc2\",\n  \"mad_sender_claim_stat_cd\": \"i5doih\",\n  \"mad_sender_desc\": \"i5dlih\",\n  \"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"mad_sender_ts\": \"CASE WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 22), 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd-HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 20), 'yyyy-MM-dd-HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(substring(i5dpih, 1, 25), 'yyyy-MM-ddHH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(substring(i5dpih, 1, 25), 1, 19), 'yyyy-MM-ddHH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 20), 'yyyy-MM-dd HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') ELSE '19000101 00:00:00' END\",\n  \"i5accd\": \"i5accd\",\n  \"i5aacd\": \"i5aacd\",\n  \"i5adcd\": \"i5adcd\",\n  \"i5abcd\": \"i5abcd\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_cag\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd AND in1.account_id = in0.i5accd AND in1.employer_group_id = in0.i5adcd\",\n    \"val-cols\": [\n      \"in1.cag_sk as in1_cag_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_carrier\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd\",\n    \"val-cols\": [\n      \"in1.carrier_sk as in1_carrier_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_member\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd AND in1.account_id = in0.i5accd AND in1.employer_group_id = in0.i5adcd AND in1.mbr_id = in0.i5abcd\",\n    \"val-cols\": [\n      \"in1.mbr_sk as in1_mbr_sk\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "d_member_adjustment",
  "sk_service_col": "mad_sk",
  "read_incremental_files_flag": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"d_cag\",\n    \"sk-col\": \"cag_sk\",\n    \"nk-col\": [\n      \"i5aacd\",\n      \"i5accd\",\n      \"i5adcd\"\n    ]\n  },\n  {\n    \"table-name\": \"d_carrier\",\n    \"sk-col\": \"carrier_sk\",\n    \"nk-col\": [\n      \"i5aacd\"\n    ]\n  },\n  {\n    \"table-name\": \"d_member\",\n    \"sk-col\": \"mbr_sk\",\n    \"nk-col\": [\n      \"i5aacd\",\n      \"i5accd\",\n      \"i5adcd\",\n      \"i5abcd\"\n    ]\n  }\n]"
}
-----------------ctrx_f_claim_mic_detail-------------------
{
  "final_table_schema": "{\"claim_nbr\": \"long\", \"claim_seq_nbr\": \"int\", \"claim_stat_id\": \"string\", \"claim_mic_seq_no\": \"int\", \"claim_stat_sk\": \"long\", \"carrier_sk\": \"long\", \"carrier_acct_sk\": \"long\", \"cag_sk\": \"long\", \"mbr_sk\": \"long\", \"final_pln_sk\": \"long\", \"phr_sk\": \"long\", \"pbr_sk\": \"long\", \"compound_sk\": \"long\", \"prod_sk\": \"long\", \"gpi_sk\": \"long\", \"drug_sk\": \"long\", \"ahfs_cd_sk\": \"long\", \"drug_rx_otc_ind_sk\": \"long\", \"drug_maint_cd_sk\": \"long\", \"admin_rte_sk\": \"long\", \"gnrc_mdspn_ind_sk\": \"long\", \"gnrc_ind_sk\": \"long\", \"dea_cd_sk\": \"long\", \"dsg_frm_sk\": \"long\", \"orig_carrier_sk\": \"long\", \"orig_mbr_sk\": \"long\", \"orig_cag_sk\": \"long\", \"orig_carrier_id\": \"string\", \"orig_account_id\": \"string\", \"orig_employer_group_id\": \"string\", \"orig_member_id\": \"string\", \"claim_seq_nbr_src\": \"int\", \"sbm_dt_sk\": \"long\", \"sbm_dt\": \"date\", \"sbm_yr\": \"int\", \"sbm_mnth\": \"int\", \"filled_dt_sk\": \"long\", \"filled_dt\": \"date\", \"rx_written_dt\": \"date\", \"rx_nbr\": \"string\", \"refill_nbr\": \"string\", \"drg_qty\": \"decimal(11, 3)\", \"awp_unit_cost\": \"decimal(24, 8)\", \"extd_awp_cost\": \"decimal(13, 5)\", \"refill_max\": \"short\", \"days_of_supply\": \"short\", \"days_of_supply_sk\": \"long\", \"dmr_ind_sk\": \"long\", \"injectable_ind_sk\": \"long\", \"injectable_ind\": \"string\", \"app_patient_pay_amt\": \"decimal(9, 2)\", \"app_due_amt\": \"decimal(9, 2)\", \"clt_ingred_cost_paid\": \"decimal(9, 2)\", \"clt_dispensing_fee\": \"decimal(9, 2)\", \"sbm_ingred_cost_paid\": \"decimal(9, 2)\", \"sbm_dispensing_fee\": \"decimal(9, 2)\", \"sbm_patient_pay_amt\": \"decimal(9, 2)\", \"sbm_due_amt\": \"decimal(9, 2)\", \"sbm_cmp_prod_id\": \"string\", \"sbm_cmp_prod_id_qlfr_cd\": \"string\", \"cmp_prod_key\": \"long\", \"prod_short_desc\": \"string\", \"prod_nm\": \"string\", \"drg_mfr_id\": \"string\", \"drg_mfr_nm\": \"string\", \"drg_gnrc_nm\": \"string\", \"drg_desc_id\": \"int\", \"gcn_no\": \"int\", \"gcn_seq_no\": \"int\", \"prod_kdc\": \"long\", \"prod_reim_ind\": \"string\", \"brand_generic_cd\": \"string\", \"drg_fda_thrpc_eqvlc_cd\": \"string\", \"drg_strngth_qty\": \"decimal(11, 3)\", \"drg_strngth_uom_cd\": \"string\", \"drg_3rd_prty_excpn_ind\": \"string\", \"drg_unit_dose_use_ind\": \"string\", \"sbm_cmp_ingred_qty\": \"decimal(11, 3)\", \"sbm_cmp_ingred_cost_amt\": \"decimal(9, 2)\", \"sbm_cmp_basis_of_cost_cd\": \"string\", \"ingred_stat_cd\": \"string\", \"cmd_cal_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_app_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_clt_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_app_cost_src_cd\": \"string\", \"cmd_app_cost_type_cd\": \"string\", \"cmd_app_cost_type_unit_cost\": \"decimal(13, 5)\", \"cmd_clt_cost_src_cd\": \"string\", \"cmd_clt_cost_type_cd\": \"string\", \"cmd_clt_cost_type_unit_cost\": \"decimal(13, 5)\", \"cmd_awp_unit_cost\": \"decimal(13, 5)\", \"cmd_cal_prof_svc_fee\": \"decimal(9, 2)\", \"cmd_app_prof_svc_fee\": \"decimal(9, 2)\", \"cmd_clt_prof_svc_fee\": \"decimal(9, 2)\", \"eci_rm_ind\": \"string\", \"eci_px_ind\": \"string\", \"eci_ms_ind\": \"string\", \"phr_drg_cost_pct\": \"decimal(5, 2)\", \"rbl_drg_cost_pct\": \"decimal(5, 2)\", \"cmd_ingred_mod_cd_cnt\": \"int\", \"cmd_ingred_mod_cd1\": \"string\", \"cmd_ingred_mod_cd2\": \"string\", \"cmd_ingred_mod_cd3\": \"string\", \"cmd_ing_dru_cov_sts\": \"string\", \"tc4_drg_cov_stat_cd\": \"string\", \"cmd_ingred_nda_flg\": \"string\", \"cmd_ingred_nda_ovrd_flg\": \"string\", \"cmd_ingred_bla_flg\": \"string\", \"cmd_ingred_bla_ovrd_flg\": \"string\", \"cmd_ingred_anda_flg\": \"string\", \"cmd_ingred_anda_ovrd_flg\": \"string\", \"cmd_exp_ingred_flg\": \"string\", \"src_env_sk\": \"long\", \"claim_nbr_encrp\": \"long\", \"rx_nbr_encrp\": \"string\", \"sec_flg\": \"double\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "optional_filter_rules": "F_claim_reduced_lkp_match0",
  "optional_filter_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"rxclaims.reduced\",\n    \"join-cond\": \"in1.claim_nbr = CAST(in0.agp2nb AS DECIMAL(17,0)) AND in1.claim_seq_nbr = CAST(CASE WHEN (CAST(in0.ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(in0.ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(in0.ags6nb AS DECIMAL(5,0))) END AS BOOLEAN) AND in1.claim_stat_id = in0.agzsst AND in1.src_env_sk = in0.rxt_src_envrt_id\",\n    \"val-cols\": [\n      \"CASE WHEN ((in1.claim_nbr IS NULL) AND ((in1.claim_seq_nbr IS NULL) AND ((in1.claim_stat_id IS NULL) AND (in1.src_env_sk IS NULL)))) THEN false ELSE true END AS F_claim_reduced_lkp_match0\"\n    ]\n  }\n]",
  "pipeline_name": "ctrx_f_claim_mic_detail",
  "primary_key": "claim_nbr,claim_seq_nbr,claim_stat_id,claim_mic_seq_no,src_env_sk",
  "reformat_rules": "{\n  \"drug_rx_otc_ind_sk\": \"in1_drug_rx_otc_ind_sk\",\n  \"orig_carrier_sk\": \"CAST(orig_carrier_sk0 AS DECIMAL(38,0))\",\n  \"extd_awp_cost\": \"CAST((CAST(agikhx AS DECIMAL(15,5)) * CAST(agsan2 AS DECIMAL(13,3))) AS DECIMAL(38,5))\",\n  \"sbm_mnth\": \"CAST(date_format(to_date(sbm_dt0, 'yyyyMMdd'), 'MM') AS DECIMAL(38,0))\",\n  \"cag_sk\": \"CAST(cag_sk0 AS DECIMAL(38,0))\",\n  \"injectable_ind_sk\": \"CAST(injectable_ind_sk0 AS DECIMAL(38,0))\",\n  \"orig_carrier_id\": \"orig_carrier_id0\",\n  \"claim_stat_id\": \"claim_stat_id0\",\n  \"dea_cd_sk\": \"in1_dea_cd_sk\",\n  \"sbm_dispensing_fee\": \"sbm_dispensing_fee0\",\n  \"sbm_cmp_ingred_cost_amt\": \"aguip1\",\n  \"cmd_ingred_mod_cd_cnt\": \"CAST(agdzpp AS DECIMAL(38,0))\",\n  \"carrier_acct_sk\": \"CAST(carrier_acct_sk0 AS DECIMAL(38,0))\",\n  \"tc4_drg_cov_stat_cd\": \"ago6h9\",\n  \"claim_nbr_encrp\": \"CAST(CASE WHEN (claim_nbr0 > 0) THEN CAST(concat(substring(CAST(claim_nbr0 AS STRING), 1, 2), ff3_encrypt_idwdata(CAST(CAST(claim_nbr0 AS STRING) AS STRING))) AS STRING) ELSE CAST(concat(substring(CAST(claim_nbr0 AS STRING), 1, 3), ff3_encrypt_idwdata(CAST(CASE WHEN (abs(CAST(claim_nbr0 AS STRING)) IS NULL) THEN '0' ELSE CASE WHEN (regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1) = '') THEN '0' ELSE CASE WHEN (instr(substring(abs(CAST(claim_nbr0 AS STRING)), 0, instr_udf(CAST(abs(CAST(claim_nbr0 AS STRING)) AS STRING), regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1))), '-') > 0) THEN concat('-', regexp_replace(regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1), '\\\\\\\\s+', '', 1)) ELSE regexp_replace(regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1), '\\\\\\\\s+', '', 1) END END END AS STRING))) AS STRING) END AS DECIMAL(38,0))\",\n  \"drg_3rd_prty_excpn_ind\": \"agd3px\",\n  \"sbm_yr\": \"CAST(date_format(to_date(sbm_dt0, 'yyyyMMdd'), 'yyyy') AS DECIMAL(38,0))\",\n  \"prod_short_desc\": \"agcnt3\",\n  \"orig_mbr_sk\": \"CAST(orig_mbr_sk0 AS DECIMAL(38,0))\",\n  \"cmd_app_cost_type_unit_cost\": \"agiohx\",\n  \"prod_kdc\": \"CAST(agciv1 AS DECIMAL(38,0))\",\n  \"prod_nm\": \"agcot3\",\n  \"claim_nbr\": \"CAST(claim_nbr0 AS DECIMAL(38,0))\",\n  \"claim_stat_sk\": \"CAST(claim_stat_sk0 AS DECIMAL(38,0))\",\n  \"rbl_drg_cost_pct\": \"age7hv\",\n  \"cmd_app_cost_src_cd\": \"agi8h7\",\n  \"cmd_cal_prof_svc_fee\": \"agj7hy\",\n  \"cmd_ingred_anda_ovrd_flg\": \"aghyai\",\n  \"sec_flg\": \"0\",\n  \"admin_rte_sk\": \"in1_admin_rte_sk\",\n  \"brand_generic_cd\": \"agpfc3\",\n  \"drg_qty\": \"drg_qty0\",\n  \"awp_unit_cost\": \"awp_unit_cost0\",\n  \"cmp_prod_key\": \"CAST(agr9n2 AS DECIMAL(38,0))\",\n  \"sbm_cmp_basis_of_cost_cd\": \"agi6cj\",\n  \"claim_seq_nbr\": \"CAST(claim_seq_nbr0 AS DECIMAL(38,0))\",\n  \"orig_cag_sk\": \"CAST(orig_cag_sk0 AS DECIMAL(38,0))\",\n  \"cmd_ingred_mod_cd1\": \"agsthk\",\n  \"prod_sk\": \"in1_prod_sk\",\n  \"final_pln_sk\": \"CAST(final_pln_sk0 AS DECIMAL(38,0))\",\n  \"mbr_sk\": \"CAST(mbr_sk0 AS DECIMAL(38,0))\",\n  \"cmd_clt_cost_type_cd\": \"agqkhb\",\n  \"sbm_cmp_prod_id_qlfr_cd\": \"agi5cj\",\n  \"gnrc_mdspn_ind_sk\": \"in1_gnrc_mdspn_ind_sk\",\n  \"prod_reim_ind\": \"agpdc3\",\n  \"app_patient_pay_amt\": \"app_patient_pay_amt0\",\n  \"sbm_dt\": \"sbm_dt0\",\n  \"sbm_ingred_cost_paid\": \"sbm_ingred_cost_paid0\",\n  \"sbm_cmp_prod_id\": \"agr9c4\",\n  \"cmd_ingred_mod_cd2\": \"agsuhk\",\n  \"cmd_app_ingred_cost_amt\": \"agimhx\",\n  \"rx_written_dt\": \"rx_written_dt0\",\n  \"app_due_amt\": \"app_due_amt0\",\n  \"drg_mfr_id\": \"agdlcd\",\n  \"cmd_ingred_anda_flg\": \"aghxai\",\n  \"carrier_sk\": \"CAST(carrier_sk0 AS DECIMAL(38,0))\",\n  \"gnrc_ind_sk\": \"in1_gnrc_ind_sk\",\n  \"rx_nbr_encrp\": \"ff3_encrypt_idwdata(CAST(rx_nbr0 AS STRING))\",\n  \"injectable_ind\": \"injectable_ind0\",\n  \"filled_dt\": \"filled_dt0\",\n  \"drg_strngth_uom_cd\": \"agtat3\",\n  \"gcn_seq_no\": \"CAST(agxsn1 AS DECIMAL(38,0))\",\n  \"cmd_ingred_bla_flg\": \"aghvai\",\n  \"eci_ms_ind\": \"agqlia\",\n  \"dmr_ind_sk\": \"CAST(dmr_ind_sk0 AS DECIMAL(38,0))\",\n  \"drg_mfr_nm\": \"agdgcd\",\n  \"cmd_clt_cost_src_cd\": \"agi9h7\",\n  \"filled_dt_sk\": \"CAST(filled_dt_sk0 AS DECIMAL(38,0))\",\n  \"drg_desc_id\": \"CAST(agh6t2 AS DECIMAL(38,0))\",\n  \"dsg_frm_sk\": \"in1_dsg_frm_sk\",\n  \"pbr_sk\": \"CAST(pbr_sk0 AS DECIMAL(38,0))\",\n  \"claim_mic_seq_no\": \"CAST(agr7n2 AS DECIMAL(38,0))\",\n  \"ahfs_cd_sk\": \"in1_ahfs_cd_sk\",\n  \"gcn_no\": \"CAST(agxrn1 AS DECIMAL(38,0))\",\n  \"drg_fda_thrpc_eqvlc_cd\": \"agdkcd\",\n  \"cmd_clt_prof_svc_fee\": \"agj9hy\",\n  \"sbm_due_amt\": \"sbm_due_amt0\",\n  \"cmd_ing_dru_cov_sts\": \"aghsai\",\n  \"gpi_sk\": \"in1_gpi_sk\",\n  \"claim_seq_nbr_src\": \"CAST(claim_seq_nbr_src0 AS DECIMAL(38,0))\",\n  \"compound_sk\": \"CAST(compound_sk0 AS DECIMAL(38,0))\",\n  \"cmd_ingred_mod_cd3\": \"agsvhk\",\n  \"sbm_cmp_ingred_qty\": \"agsan2\",\n  \"sbm_patient_pay_amt\": \"sbm_patient_pay_amt0\",\n  \"drg_strngth_qty\": \"agagqt\",\n  \"cmd_app_prof_svc_fee\": \"agj8hy\",\n  \"cmd_ingred_bla_ovrd_flg\": \"aghwai\",\n  \"clt_dispensing_fee\": \"clt_dispensing_fee0\",\n  \"phr_sk\": \"CAST(phr_sk0 AS DECIMAL(38,0))\",\n  \"sbm_dt_sk\": \"CAST(sbm_dt_sk0 AS DECIMAL(38,0))\",\n  \"drug_sk\": \"in1_drug_sk\",\n  \"drg_gnrc_nm\": \"agxktx\",\n  \"refill_nbr\": \"refill_nbr0\",\n  \"orig_employer_group_id\": \"orig_employer_group_id0\",\n  \"drug_maint_cd_sk\": \"in1_drug_maint_cd_sk\",\n  \"cmd_exp_ingred_flg\": \"aghzai\",\n  \"cmd_ingred_nda_flg\": \"aghtai\",\n  \"eci_px_ind\": \"agqkia\",\n  \"drg_unit_dose_use_ind\": \"agdudu\",\n  \"cmd_clt_ingred_cost_amt\": \"aginhx\",\n  \"cmd_awp_unit_cost\": \"agikhx\",\n  \"ingred_stat_cd\": \"agjah7\",\n  \"phr_drg_cost_pct\": \"age6hv\",\n  \"days_of_supply\": \"CAST(days_sply0 AS DECIMAL(38,0))\",\n  \"orig_account_id\": \"orig_account_id0\",\n  \"refill_max\": \"CAST(refill_max0 AS DECIMAL(38,0))\",\n  \"src_env_sk\": \"CAST(rxt_src_envrt_id AS DECIMAL(38,0))\",\n  \"orig_member_id\": \"orig_member_id0\",\n  \"cmd_app_cost_type_cd\": \"agqjhb\",\n  \"cmd_cal_ingred_cost_amt\": \"agilhx\",\n  \"eci_rm_ind\": \"agqjia\",\n  \"cmd_ingred_nda_ovrd_flg\": \"aghuai\",\n  \"clt_ingred_cost_paid\": \"clt_ingred_cost_paid0\",\n  \"rx_nbr\": \"rx_nbr0\",\n  \"cmd_clt_cost_type_unit_cost\": \"agiphx\",\n  \"days_of_supply_sk\": \"CAST(days_of_supply_sk0 AS DECIMAL(38,0))\",\n  \"agmdcd\": \"agmdcd\",\n  \"agozs3\": \"agozs3\",\n  \"agqihb\": \"agqihb\",\n  \"agi5cj\": \"agi5cj\",\n  \"agddea\": \"agddea\",\n  \"agzxst\": \"agzxst\",\n  \"agebc4\": \"agebc4\",\n  \"agdicd\": \"agdicd\",\n  \"agdrxo\": \"agdrxo\",\n  \"ags6nb\": \"ags6nb\",\n  \"agp2nb\": \"agp2nb\",\n  \"agr9c4\": \"agr9c4\",\n  \"agdhcd\": \"agdhcd\",\n  \"agzsst\": \"agzsst\",\n  \"rxt_src_envrt_id\": \"rxt_src_envrt_id\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_admin_route\",\n    \"join-cond\": \"in1.admin_rte_id = in0.agdicd\",\n    \"val-cols\": [\n      \"in1.admin_rte_sk as in1_admin_rte_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_ahfs\",\n    \"join-cond\": \"in1.ahfs_cd = in0.agebc4\",\n    \"val-cols\": [\n      \"in1.ahfs_cd_sk as in1_ahfs_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_dea\",\n    \"join-cond\": \"in1.dea_cd = in0.agddea\",\n    \"val-cols\": [\n      \"in1.dea_cd_sk as in1_dea_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_drug\",\n    \"join-cond\": \"in1.drg_nm_extn_id = substring(in0.agqihb, 0, 10)\",\n    \"val-cols\": [\n      \"in1.drug_sk as in1_drug_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_drug_maintenance\",\n    \"join-cond\": \"in1.drug_maint_cd = in0.agmdcd\",\n    \"val-cols\": [\n      \"in1.drug_maint_cd_sk as in1_drug_maint_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_drug_otc_indicator\",\n    \"join-cond\": \"in1.drug_rx_otc_ind = in0.agdrxo\",\n    \"val-cols\": [\n      \"in1.drug_rx_otc_ind_sk as in1_drug_rx_otc_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_dosage_form\",\n    \"join-cond\": \"in1.dsg_frm_id = in0.agdhcd\",\n    \"val-cols\": [\n      \"in1.dsg_frm_sk as in1_dsg_frm_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_generic_medispan_indicator\",\n    \"join-cond\": \"in1.gnrc_mdspn_ind = in0.agzxst\",\n    \"val-cols\": [\n      \"in1.gnrc_ind_sk as in1_gnrc_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_generic_medispan_indicator\",\n    \"join-cond\": \"in1.gnrc_mdspn_ind = in0.agozs3\",\n    \"val-cols\": [\n      \"in1.gnrc_mdspn_ind_sk as in1_gnrc_mdspn_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_gpi\",\n    \"join-cond\": \"in1.gpi_id = in0.agqihb\",\n    \"val-cols\": [\n      \"in1.gpi_sk as in1_gpi_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_product\",\n    \"join-cond\": \"in1.prod_id = in0.agr9c4 AND in1.prod_id_qlfr_cd = in0.agi5cj\",\n    \"val-cols\": [\n      \"in1.prod_sk as in1_prod_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"csv\",\n    \"src\": \"rxclaim_ctrx.rcecip\",\n    \"join-cond\": \"in1.claim_nbr = CAST(in0.agp2nb AS DECIMAL(17,0)) AND in1.claim_seq_nbr = CASE WHEN (CAST(in0.ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(in0.ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(in0.ags6nb AS DECIMAL(5,0))) END AND in1.claim_stat_id = in0.agzsst AND in1.src_env_sk = in0.rxt_src_envrt_id\",\n    \"val-cols\": [\n      \"in1.claim_nbr AS claim_nbr0\",\n      \"in1.claim_seq_nbr AS claim_seq_nbr0\",\n      \"in1.claim_stat_id AS claim_stat_id0\",\n      \"in1.claim_stat_sk AS claim_stat_sk0\",\n      \"in1.carrier_sk AS carrier_sk0\",\n      \"in1.carrier_acct_sk AS carrier_acct_sk0\",\n      \"in1.cag_sk AS cag_sk0\",\n      \"in1.mbr_sk AS mbr_sk0\",\n      \"in1.final_pln_sk AS final_pln_sk0\",\n      \"in1.phr_sk AS phr_sk0\",\n      \"in1.pbr_sk AS pbr_sk0\",\n      \"in1.compound_sk AS compound_sk0\",\n      \"in1.orig_carrier_sk AS orig_carrier_sk0\",\n      \"in1.orig_mbr_sk AS orig_mbr_sk0\",\n      \"in1.orig_cag_sk AS orig_cag_sk0\",\n      \"in1.orig_carrier_id AS orig_carrier_id0\",\n      \"in1.orig_account_id AS orig_account_id0\",\n      \"in1.orig_employer_group_id AS orig_employer_group_id0\",\n      \"in1.orig_member_id AS orig_member_id0\",\n      \"in1.claim_seq_nbr_src AS claim_seq_nbr_src0\",\n      \"in1.sbm_dt_sk AS sbm_dt_sk0\",\n      \"in1.sbm_dt AS sbm_dt0\",\n      \"in1.filled_dt_sk AS filled_dt_sk0\",\n      \"in1.filled_dt AS filled_dt0\",\n      \"in1.rx_written_dt AS rx_written_dt0\",\n      \"in1.rx_nbr AS rx_nbr0\",\n      \"in1.refill_nbr AS refill_nbr0\",\n      \"in1.drg_qty AS drg_qty0\",\n      \"in1.awp_unit_cost AS awp_unit_cost0\",\n      \"in1.refill_max AS refill_max0\",\n      \"in1.days_sply AS days_sply0\",\n      \"in1.days_of_supply_sk AS days_of_supply_sk0\",\n      \"in1.dmr_ind_sk AS dmr_ind_sk0\",\n      \"in1.injectable_ind_sk AS injectable_ind_sk0\",\n      \"in1.injectable_ind AS injectable_ind0\",\n      \"in1.app_patient_pay_amt AS app_patient_pay_amt0\",\n      \"in1.app_due_amt AS app_due_amt0\",\n      \"in1.clt_ingred_cost_paid AS clt_ingred_cost_paid0\",\n      \"in1.clt_dispensing_fee AS clt_dispensing_fee0\",\n      \"in1.sbm_ingred_cost_paid AS sbm_ingred_cost_paid0\",\n      \"in1.sbm_dispensing_fee AS sbm_dispensing_fee0\",\n      \"in1.sbm_patient_pay_amt AS sbm_patient_pay_amt0\",\n      \"in1.sbm_due_amt AS sbm_due_amt0\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "f_claim_mic_detail",
  "read_incremental_files_flag": "false",
  "sk_service_self_join": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"l_admin_route\",\n    \"sk-col\": \"admin_rte_sk\",\n    \"nk-col\": [\n      \"agdicd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_ahfs\",\n    \"sk-col\": \"ahfs_cd_sk\",\n    \"nk-col\": [\n      \"agebc4\"\n    ]\n  },\n  {\n    \"table-name\": \"l_dea\",\n    \"sk-col\": \"dea_cd_sk\",\n    \"nk-col\": [\n      \"agddea\"\n    ]\n  },\n  {\n    \"table-name\": \"d_drug\",\n    \"sk-col\": \"drug_sk\",\n    \"nk-col\": [\n      \"substring(agqihb, 0, 10)\"\n    ]\n  },\n  {\n    \"table-name\": \"l_drug_maintenance\",\n    \"sk-col\": \"drug_maint_cd_sk\",\n    \"nk-col\": [\n      \"agmdcd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_drug_otc_indicator\",\n    \"sk-col\": \"drug_rx_otc_ind_sk\",\n    \"nk-col\": [\n      \"agdrxo\"\n    ]\n  },\n  {\n    \"table-name\": \"l_dosage_form\",\n    \"sk-col\": \"dsg_frm_sk\",\n    \"nk-col\": [\n      \"agdhcd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_generic_medispan_indicator\",\n    \"sk-col\": \"gnrc_ind_sk\",\n    \"nk-col\": [\n      \"agzxst\"\n    ]\n  },\n  {\n    \"table-name\": \"l_generic_medispan_indicator\",\n    \"sk-col\": \"gnrc_mdspn_ind_sk\",\n    \"nk-col\": [\n      \"agozs3\"\n    ]\n  },\n  {\n    \"table-name\": \"d_gpi\",\n    \"sk-col\": \"gpi_sk\",\n    \"nk-col\": [\n      \"agqihb\"\n    ]\n  },\n  {\n    \"table-name\": \"d_product\",\n    \"sk-col\": \"prod_sk\",\n    \"nk-col\": [\n      \"agr9c4\",\n      \"agi5cj\"\n    ]\n  },\n  {\n    \"table-name\": \"rcecip\",\n    \"sk-col\": \"claim_nbr\",\n    \"nk-col\": [\n      \"CAST(agp2nb AS DECIMAL(17,0))\",\n      \"CASE WHEN (CAST(ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(ags6nb AS DECIMAL(5,0))) END\",\n      \"agzsst\",\n      \"rxt_src_envrt_id\"\n    ]\n  }\n]"
}
-----------------orx_f_claim_mic_detail-------------------
{
  "final_table_schema": "{\"claim_nbr\": \"long\", \"claim_seq_nbr\": \"int\", \"claim_stat_id\": \"string\", \"claim_mic_seq_no\": \"int\", \"claim_stat_sk\": \"long\", \"carrier_sk\": \"long\", \"carrier_acct_sk\": \"long\", \"cag_sk\": \"long\", \"mbr_sk\": \"long\", \"final_pln_sk\": \"long\", \"phr_sk\": \"long\", \"pbr_sk\": \"long\", \"compound_sk\": \"long\", \"prod_sk\": \"long\", \"gpi_sk\": \"long\", \"drug_sk\": \"long\", \"ahfs_cd_sk\": \"long\", \"drug_rx_otc_ind_sk\": \"long\", \"drug_maint_cd_sk\": \"long\", \"admin_rte_sk\": \"long\", \"gnrc_mdspn_ind_sk\": \"long\", \"gnrc_ind_sk\": \"long\", \"dea_cd_sk\": \"long\", \"dsg_frm_sk\": \"long\", \"orig_carrier_sk\": \"long\", \"orig_mbr_sk\": \"long\", \"orig_cag_sk\": \"long\", \"orig_carrier_id\": \"string\", \"orig_account_id\": \"string\", \"orig_employer_group_id\": \"string\", \"orig_member_id\": \"string\", \"claim_seq_nbr_src\": \"int\", \"sbm_dt_sk\": \"long\", \"sbm_dt\": \"date\", \"sbm_yr\": \"int\", \"sbm_mnth\": \"int\", \"filled_dt_sk\": \"long\", \"filled_dt\": \"date\", \"rx_written_dt\": \"date\", \"rx_nbr\": \"string\", \"refill_nbr\": \"string\", \"drg_qty\": \"decimal(11, 3)\", \"awp_unit_cost\": \"decimal(24, 8)\", \"extd_awp_cost\": \"decimal(13, 5)\", \"refill_max\": \"short\", \"days_of_supply\": \"short\", \"days_of_supply_sk\": \"long\", \"dmr_ind_sk\": \"long\", \"injectable_ind_sk\": \"long\", \"injectable_ind\": \"string\", \"app_patient_pay_amt\": \"decimal(9, 2)\", \"app_due_amt\": \"decimal(9, 2)\", \"clt_ingred_cost_paid\": \"decimal(9, 2)\", \"clt_dispensing_fee\": \"decimal(9, 2)\", \"sbm_ingred_cost_paid\": \"decimal(9, 2)\", \"sbm_dispensing_fee\": \"decimal(9, 2)\", \"sbm_patient_pay_amt\": \"decimal(9, 2)\", \"sbm_due_amt\": \"decimal(9, 2)\", \"sbm_cmp_prod_id\": \"string\", \"sbm_cmp_prod_id_qlfr_cd\": \"string\", \"cmp_prod_key\": \"long\", \"prod_short_desc\": \"string\", \"prod_nm\": \"string\", \"drg_mfr_id\": \"string\", \"drg_mfr_nm\": \"string\", \"drg_gnrc_nm\": \"string\", \"drg_desc_id\": \"int\", \"gcn_no\": \"int\", \"gcn_seq_no\": \"int\", \"prod_kdc\": \"long\", \"prod_reim_ind\": \"string\", \"brand_generic_cd\": \"string\", \"drg_fda_thrpc_eqvlc_cd\": \"string\", \"drg_strngth_qty\": \"decimal(11, 3)\", \"drg_strngth_uom_cd\": \"string\", \"drg_3rd_prty_excpn_ind\": \"string\", \"drg_unit_dose_use_ind\": \"string\", \"sbm_cmp_ingred_qty\": \"decimal(11, 3)\", \"sbm_cmp_ingred_cost_amt\": \"decimal(9, 2)\", \"sbm_cmp_basis_of_cost_cd\": \"string\", \"ingred_stat_cd\": \"string\", \"cmd_cal_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_app_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_clt_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_app_cost_src_cd\": \"string\", \"cmd_app_cost_type_cd\": \"string\", \"cmd_app_cost_type_unit_cost\": \"decimal(13, 5)\", \"cmd_clt_cost_src_cd\": \"string\", \"cmd_clt_cost_type_cd\": \"string\", \"cmd_clt_cost_type_unit_cost\": \"decimal(13, 5)\", \"cmd_awp_unit_cost\": \"decimal(13, 5)\", \"cmd_cal_prof_svc_fee\": \"decimal(9, 2)\", \"cmd_app_prof_svc_fee\": \"decimal(9, 2)\", \"cmd_clt_prof_svc_fee\": \"decimal(9, 2)\", \"eci_rm_ind\": \"string\", \"eci_px_ind\": \"string\", \"eci_ms_ind\": \"string\", \"phr_drg_cost_pct\": \"decimal(5, 2)\", \"rbl_drg_cost_pct\": \"decimal(5, 2)\", \"cmd_ingred_mod_cd_cnt\": \"int\", \"cmd_ingred_mod_cd1\": \"string\", \"cmd_ingred_mod_cd2\": \"string\", \"cmd_ingred_mod_cd3\": \"string\", \"cmd_ing_dru_cov_sts\": \"string\", \"tc4_drg_cov_stat_cd\": \"string\", \"cmd_ingred_nda_flg\": \"string\", \"cmd_ingred_nda_ovrd_flg\": \"string\", \"cmd_ingred_bla_flg\": \"string\", \"cmd_ingred_bla_ovrd_flg\": \"string\", \"cmd_ingred_anda_flg\": \"string\", \"cmd_ingred_anda_ovrd_flg\": \"string\", \"cmd_exp_ingred_flg\": \"string\", \"src_env_sk\": \"long\", \"claim_nbr_encrp\": \"long\", \"rx_nbr_encrp\": \"string\", \"sec_flg\": \"double\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "optional_filter_rules": "F_claim_reduced_lkp_match0",
  "optional_filter_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"rxclaims.reduced\",\n    \"join-cond\": \"in1.claim_nbr = CAST(in0.agp2nb AS DECIMAL(17,0)) AND in1.claim_seq_nbr = CAST(CASE WHEN (CAST(in0.ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(in0.ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(in0.ags6nb AS DECIMAL(5,0))) END AS BOOLEAN) AND in1.claim_stat_id = in0.agzsst AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT)\",\n    \"val-cols\": [\n      \"CASE WHEN ((in1.claim_nbr IS NULL) AND ((in1.claim_seq_nbr IS NULL) AND ((in1.claim_stat_id IS NULL) AND (in1.src_env_sk IS NULL)))) THEN false ELSE true END AS F_claim_reduced_lkp_match0\"\n    ]\n  }\n]",
  "pipeline_name": "orx_f_claim_mic_detail",
  "primary_key": "claim_nbr,claim_seq_nbr,claim_stat_id,claim_mic_seq_no,src_env_sk",
  "reformat_rules": "{\n  \"drug_rx_otc_ind_sk\": \"in1_drug_rx_otc_ind_sk\",\n  \"orig_carrier_sk\": \"CAST(orig_carrier_sk0 AS DECIMAL(38,0))\",\n  \"extd_awp_cost\": \"CAST((CAST(agikhx AS DECIMAL(15,5)) * CAST(agsan2 AS DECIMAL(13,3))) AS DECIMAL(38,5))\",\n  \"sbm_mnth\": \"CAST(date_format(to_date(sbm_dt0, 'yyyyMMdd'), 'MM') AS DECIMAL(38,0))\",\n  \"cag_sk\": \"CAST(cag_sk0 AS DECIMAL(38,0))\",\n  \"injectable_ind_sk\": \"CAST(injectable_ind_sk0 AS DECIMAL(38,0))\",\n  \"orig_carrier_id\": \"orig_carrier_id0\",\n  \"claim_stat_id\": \"claim_stat_id0\",\n  \"dea_cd_sk\": \"in1_dea_cd_sk\",\n  \"sbm_dispensing_fee\": \"sbm_dispensing_fee0\",\n  \"sbm_cmp_ingred_cost_amt\": \"aguip1\",\n  \"cmd_ingred_mod_cd_cnt\": \"CAST(agdzpp AS DECIMAL(38,0))\",\n  \"carrier_acct_sk\": \"CAST(carrier_acct_sk0 AS DECIMAL(38,0))\",\n  \"tc4_drg_cov_stat_cd\": \"ago6h9\",\n  \"claim_nbr_encrp\": \"CAST(CASE WHEN (claim_nbr0 > 0) THEN CAST(concat(substring(CAST(claim_nbr0 AS STRING), 1, 2), ff3_encrypt_idwdata(CAST(CAST(claim_nbr0 AS STRING) AS STRING))) AS STRING) ELSE CAST(concat(substring(CAST(claim_nbr0 AS STRING), 1, 3), ff3_encrypt_idwdata(CAST(CASE WHEN (abs(CAST(claim_nbr0 AS STRING)) IS NULL) THEN '0' ELSE CASE WHEN (regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1) = '') THEN '0' ELSE CASE WHEN (instr(substring(abs(CAST(claim_nbr0 AS STRING)), 0, instr_udf(CAST(abs(CAST(claim_nbr0 AS STRING)) AS STRING), regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1))), '-') > 0) THEN concat('-', regexp_replace(regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1), '\\\\\\\\s+', '', 1)) ELSE regexp_replace(regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1), '\\\\\\\\s+', '', 1) END END END AS STRING))) AS STRING) END AS DECIMAL(38,0))\",\n  \"drg_3rd_prty_excpn_ind\": \"agd3px\",\n  \"sbm_yr\": \"CAST(date_format(to_date(sbm_dt0, 'yyyyMMdd'), 'yyyy') AS DECIMAL(38,0))\",\n  \"prod_short_desc\": \"agcnt3\",\n  \"orig_mbr_sk\": \"CAST(orig_mbr_sk0 AS DECIMAL(38,0))\",\n  \"cmd_app_cost_type_unit_cost\": \"agiohx\",\n  \"prod_kdc\": \"CAST(agciv1 AS DECIMAL(38,0))\",\n  \"prod_nm\": \"agcot3\",\n  \"claim_nbr\": \"CAST(claim_nbr0 AS DECIMAL(38,0))\",\n  \"claim_stat_sk\": \"CAST(claim_stat_sk0 AS DECIMAL(38,0))\",\n  \"rbl_drg_cost_pct\": \"age7hv\",\n  \"cmd_app_cost_src_cd\": \"agi8h7\",\n  \"cmd_cal_prof_svc_fee\": \"agj7hy\",\n  \"cmd_ingred_anda_ovrd_flg\": \"aghyai\",\n  \"sec_flg\": \"0\",\n  \"admin_rte_sk\": \"in1_admin_rte_sk\",\n  \"brand_generic_cd\": \"agpfc3\",\n  \"drg_qty\": \"drg_qty0\",\n  \"awp_unit_cost\": \"awp_unit_cost0\",\n  \"cmp_prod_key\": \"CAST(agr9n2 AS DECIMAL(38,0))\",\n  \"sbm_cmp_basis_of_cost_cd\": \"agi6cj\",\n  \"claim_seq_nbr\": \"CAST(claim_seq_nbr0 AS DECIMAL(38,0))\",\n  \"orig_cag_sk\": \"CAST(orig_cag_sk0 AS DECIMAL(38,0))\",\n  \"cmd_ingred_mod_cd1\": \"agsthk\",\n  \"prod_sk\": \"in1_prod_sk\",\n  \"final_pln_sk\": \"CAST(final_pln_sk0 AS DECIMAL(38,0))\",\n  \"mbr_sk\": \"CAST(mbr_sk0 AS DECIMAL(38,0))\",\n  \"cmd_clt_cost_type_cd\": \"agqkhb\",\n  \"sbm_cmp_prod_id_qlfr_cd\": \"agi5cj\",\n  \"gnrc_mdspn_ind_sk\": \"in1_gnrc_mdspn_ind_sk\",\n  \"prod_reim_ind\": \"agpdc3\",\n  \"app_patient_pay_amt\": \"app_patient_pay_amt0\",\n  \"sbm_dt\": \"sbm_dt0\",\n  \"sbm_ingred_cost_paid\": \"sbm_ingred_cost_paid0\",\n  \"sbm_cmp_prod_id\": \"agr9c4\",\n  \"cmd_ingred_mod_cd2\": \"agsuhk\",\n  \"cmd_app_ingred_cost_amt\": \"agimhx\",\n  \"rx_written_dt\": \"rx_written_dt0\",\n  \"app_due_amt\": \"app_due_amt0\",\n  \"drg_mfr_id\": \"agdlcd\",\n  \"cmd_ingred_anda_flg\": \"aghxai\",\n  \"carrier_sk\": \"CAST(carrier_sk0 AS DECIMAL(38,0))\",\n  \"gnrc_ind_sk\": \"in1_gnrc_ind_sk\",\n  \"rx_nbr_encrp\": \"ff3_encrypt_idwdata(CAST(rx_nbr0 AS STRING))\",\n  \"injectable_ind\": \"injectable_ind0\",\n  \"filled_dt\": \"filled_dt0\",\n  \"drg_strngth_uom_cd\": \"agtat3\",\n  \"gcn_seq_no\": \"CAST(agxsn1 AS DECIMAL(38,0))\",\n  \"cmd_ingred_bla_flg\": \"aghvai\",\n  \"eci_ms_ind\": \"agqlia\",\n  \"dmr_ind_sk\": \"CAST(dmr_ind_sk0 AS DECIMAL(38,0))\",\n  \"drg_mfr_nm\": \"agdgcd\",\n  \"cmd_clt_cost_src_cd\": \"agi9h7\",\n  \"filled_dt_sk\": \"CAST(filled_dt_sk0 AS DECIMAL(38,0))\",\n  \"drg_desc_id\": \"CAST(agh6t2 AS DECIMAL(38,0))\",\n  \"dsg_frm_sk\": \"in1_dsg_frm_sk\",\n  \"pbr_sk\": \"CAST(pbr_sk0 AS DECIMAL(38,0))\",\n  \"claim_mic_seq_no\": \"CAST(agr7n2 AS DECIMAL(38,0))\",\n  \"ahfs_cd_sk\": \"in1_ahfs_cd_sk\",\n  \"gcn_no\": \"CAST(agxrn1 AS DECIMAL(38,0))\",\n  \"drg_fda_thrpc_eqvlc_cd\": \"agdkcd\",\n  \"cmd_clt_prof_svc_fee\": \"agj9hy\",\n  \"sbm_due_amt\": \"sbm_due_amt0\",\n  \"cmd_ing_dru_cov_sts\": \"aghsai\",\n  \"gpi_sk\": \"in1_gpi_sk\",\n  \"claim_seq_nbr_src\": \"CAST(claim_seq_nbr_src0 AS DECIMAL(38,0))\",\n  \"compound_sk\": \"CAST(compound_sk0 AS DECIMAL(38,0))\",\n  \"cmd_ingred_mod_cd3\": \"agsvhk\",\n  \"sbm_cmp_ingred_qty\": \"agsan2\",\n  \"sbm_patient_pay_amt\": \"sbm_patient_pay_amt0\",\n  \"drg_strngth_qty\": \"agagqt\",\n  \"cmd_app_prof_svc_fee\": \"agj8hy\",\n  \"cmd_ingred_bla_ovrd_flg\": \"aghwai\",\n  \"clt_dispensing_fee\": \"clt_dispensing_fee0\",\n  \"phr_sk\": \"CAST(phr_sk0 AS DECIMAL(38,0))\",\n  \"sbm_dt_sk\": \"CAST(sbm_dt_sk0 AS DECIMAL(38,0))\",\n  \"drug_sk\": \"in1_drug_sk\",\n  \"drg_gnrc_nm\": \"agxktx\",\n  \"refill_nbr\": \"refill_nbr0\",\n  \"orig_employer_group_id\": \"orig_employer_group_id0\",\n  \"drug_maint_cd_sk\": \"in1_drug_maint_cd_sk\",\n  \"cmd_exp_ingred_flg\": \"aghzai\",\n  \"cmd_ingred_nda_flg\": \"aghtai\",\n  \"eci_px_ind\": \"agqkia\",\n  \"drg_unit_dose_use_ind\": \"agdudu\",\n  \"cmd_clt_ingred_cost_amt\": \"aginhx\",\n  \"cmd_awp_unit_cost\": \"agikhx\",\n  \"ingred_stat_cd\": \"agjah7\",\n  \"phr_drg_cost_pct\": \"age6hv\",\n  \"days_of_supply\": \"CAST(days_sply0 AS DECIMAL(38,0))\",\n  \"orig_account_id\": \"orig_account_id0\",\n  \"refill_max\": \"CAST(refill_max0 AS DECIMAL(38,0))\",\n  \"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"orig_member_id\": \"orig_member_id0\",\n  \"cmd_app_cost_type_cd\": \"agqjhb\",\n  \"cmd_cal_ingred_cost_amt\": \"agilhx\",\n  \"eci_rm_ind\": \"agqjia\",\n  \"cmd_ingred_nda_ovrd_flg\": \"aghuai\",\n  \"clt_ingred_cost_paid\": \"clt_ingred_cost_paid0\",\n  \"rx_nbr\": \"rx_nbr0\",\n  \"cmd_clt_cost_type_unit_cost\": \"agiphx\",\n  \"days_of_supply_sk\": \"CAST(days_of_supply_sk0 AS DECIMAL(38,0))\",\n  \"agmdcd\": \"agmdcd\",\n  \"agozs3\": \"agozs3\",\n  \"agqihb\": \"agqihb\",\n  \"agi5cj\": \"agi5cj\",\n  \"agddea\": \"agddea\",\n  \"agzxst\": \"agzxst\",\n  \"agebc4\": \"agebc4\",\n  \"agdicd\": \"agdicd\",\n  \"agdrxo\": \"agdrxo\",\n  \"ags6nb\": \"ags6nb\",\n  \"agp2nb\": \"agp2nb\",\n  \"agr9c4\": \"agr9c4\",\n  \"agdhcd\": \"agdhcd\",\n  \"agzsst\": \"agzsst\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_admin_route\",\n    \"join-cond\": \"in1.admin_rte_id = in0.agdicd\",\n    \"val-cols\": [\n      \"in1.admin_rte_sk as in1_admin_rte_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_ahfs\",\n    \"join-cond\": \"in1.ahfs_cd = in0.agebc4\",\n    \"val-cols\": [\n      \"in1.ahfs_cd_sk as in1_ahfs_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_dea\",\n    \"join-cond\": \"in1.dea_cd = in0.agddea\",\n    \"val-cols\": [\n      \"in1.dea_cd_sk as in1_dea_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_drug\",\n    \"join-cond\": \"in1.drg_nm_extn_id = substring(in0.agqihb, 0, 10)\",\n    \"val-cols\": [\n      \"in1.drug_sk as in1_drug_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_drug_maintenance\",\n    \"join-cond\": \"in1.drug_maint_cd = in0.agmdcd\",\n    \"val-cols\": [\n      \"in1.drug_maint_cd_sk as in1_drug_maint_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_drug_otc_indicator\",\n    \"join-cond\": \"in1.drug_rx_otc_ind = in0.agdrxo\",\n    \"val-cols\": [\n      \"in1.drug_rx_otc_ind_sk as in1_drug_rx_otc_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_dosage_form\",\n    \"join-cond\": \"in1.dsg_frm_id = in0.agdhcd\",\n    \"val-cols\": [\n      \"in1.dsg_frm_sk as in1_dsg_frm_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_generic_medispan_indicator\",\n    \"join-cond\": \"in1.gnrc_mdspn_ind = in0.agzxst\",\n    \"val-cols\": [\n      \"in1.gnrc_ind_sk as in1_gnrc_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_generic_medispan_indicator\",\n    \"join-cond\": \"in1.gnrc_mdspn_ind = in0.agozs3\",\n    \"val-cols\": [\n      \"in1.gnrc_mdspn_ind_sk as in1_gnrc_mdspn_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_gpi\",\n    \"join-cond\": \"in1.gpi_id = in0.agqihb\",\n    \"val-cols\": [\n      \"in1.gpi_sk as in1_gpi_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_product\",\n    \"join-cond\": \"in1.prod_id = in0.agr9c4 AND in1.prod_id_qlfr_cd = in0.agi5cj\",\n    \"val-cols\": [\n      \"in1.prod_sk as in1_prod_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"csv\",\n    \"src\": \"rxclaim_orx.rcecip\",\n    \"join-cond\": \"in1.claim_nbr = CAST(in0.agp2nb AS DECIMAL(17,0)) AND in1.claim_seq_nbr = CASE WHEN (CAST(in0.ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(in0.ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(in0.ags6nb AS DECIMAL(5,0))) END AND in1.claim_stat_id = in0.agzsst AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT)\",\n    \"val-cols\": [\n      \"in1.claim_nbr AS claim_nbr0\",\n      \"in1.claim_seq_nbr AS claim_seq_nbr0\",\n      \"in1.claim_stat_id AS claim_stat_id0\",\n      \"in1.claim_stat_sk AS claim_stat_sk0\",\n      \"in1.carrier_sk AS carrier_sk0\",\n      \"in1.carrier_acct_sk AS carrier_acct_sk0\",\n      \"in1.cag_sk AS cag_sk0\",\n      \"in1.mbr_sk AS mbr_sk0\",\n      \"in1.final_pln_sk AS final_pln_sk0\",\n      \"in1.phr_sk AS phr_sk0\",\n      \"in1.pbr_sk AS pbr_sk0\",\n      \"in1.compound_sk AS compound_sk0\",\n      \"in1.orig_carrier_sk AS orig_carrier_sk0\",\n      \"in1.orig_mbr_sk AS orig_mbr_sk0\",\n      \"in1.orig_cag_sk AS orig_cag_sk0\",\n      \"in1.orig_carrier_id AS orig_carrier_id0\",\n      \"in1.orig_account_id AS orig_account_id0\",\n      \"in1.orig_employer_group_id AS orig_employer_group_id0\",\n      \"in1.orig_member_id AS orig_member_id0\",\n      \"in1.claim_seq_nbr_src AS claim_seq_nbr_src0\",\n      \"in1.sbm_dt_sk AS sbm_dt_sk0\",\n      \"in1.sbm_dt AS sbm_dt0\",\n      \"in1.filled_dt_sk AS filled_dt_sk0\",\n      \"in1.filled_dt AS filled_dt0\",\n      \"in1.rx_written_dt AS rx_written_dt0\",\n      \"in1.rx_nbr AS rx_nbr0\",\n      \"in1.refill_nbr AS refill_nbr0\",\n      \"in1.drg_qty AS drg_qty0\",\n      \"in1.awp_unit_cost AS awp_unit_cost0\",\n      \"in1.refill_max AS refill_max0\",\n      \"in1.days_sply AS days_sply0\",\n      \"in1.days_of_supply_sk AS days_of_supply_sk0\",\n      \"in1.dmr_ind_sk AS dmr_ind_sk0\",\n      \"in1.injectable_ind_sk AS injectable_ind_sk0\",\n      \"in1.injectable_ind AS injectable_ind0\",\n      \"in1.app_patient_pay_amt AS app_patient_pay_amt0\",\n      \"in1.app_due_amt AS app_due_amt0\",\n      \"in1.clt_ingred_cost_paid AS clt_ingred_cost_paid0\",\n      \"in1.clt_dispensing_fee AS clt_dispensing_fee0\",\n      \"in1.sbm_ingred_cost_paid AS sbm_ingred_cost_paid0\",\n      \"in1.sbm_dispensing_fee AS sbm_dispensing_fee0\",\n      \"in1.sbm_patient_pay_amt AS sbm_patient_pay_amt0\",\n      \"in1.sbm_due_amt AS sbm_due_amt0\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "f_claim_mic_detail",
  "read_incremental_files_flag": "false",
  "sk_service_self_join": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"l_admin_route\",\n    \"sk-col\": \"admin_rte_sk\",\n    \"nk-col\": [\n      \"agdicd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_ahfs\",\n    \"sk-col\": \"ahfs_cd_sk\",\n    \"nk-col\": [\n      \"agebc4\"\n    ]\n  },\n  {\n    \"table-name\": \"l_dea\",\n    \"sk-col\": \"dea_cd_sk\",\n    \"nk-col\": [\n      \"agddea\"\n    ]\n  },\n  {\n    \"table-name\": \"d_drug\",\n    \"sk-col\": \"drug_sk\",\n    \"nk-col\": [\n      \"substring(agqihb, 0, 10)\"\n    ]\n  },\n  {\n    \"table-name\": \"l_drug_maintenance\",\n    \"sk-col\": \"drug_maint_cd_sk\",\n    \"nk-col\": [\n      \"agmdcd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_drug_otc_indicator\",\n    \"sk-col\": \"drug_rx_otc_ind_sk\",\n    \"nk-col\": [\n      \"agdrxo\"\n    ]\n  },\n  {\n    \"table-name\": \"l_dosage_form\",\n    \"sk-col\": \"dsg_frm_sk\",\n    \"nk-col\": [\n      \"agdhcd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_generic_medispan_indicator\",\n    \"sk-col\": \"gnrc_ind_sk\",\n    \"nk-col\": [\n      \"agzxst\"\n    ]\n  },\n  {\n    \"table-name\": \"l_generic_medispan_indicator\",\n    \"sk-col\": \"gnrc_mdspn_ind_sk\",\n    \"nk-col\": [\n      \"agozs3\"\n    ]\n  },\n  {\n    \"table-name\": \"d_gpi\",\n    \"sk-col\": \"gpi_sk\",\n    \"nk-col\": [\n      \"agqihb\"\n    ]\n  },\n  {\n    \"table-name\": \"d_product\",\n    \"sk-col\": \"prod_sk\",\n    \"nk-col\": [\n      \"agr9c4\",\n      \"agi5cj\"\n    ]\n  },\n  {\n    \"table-name\": \"rcecip\",\n    \"sk-col\": \"claim_nbr\",\n    \"nk-col\": [\n      \"CAST(agp2nb AS DECIMAL(17,0))\",\n      \"CASE WHEN (CAST(ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(ags6nb AS DECIMAL(5,0))) END\",\n      \"agzsst\",\n      \"CAST(dxf_src_sys_id AS INT)\",\n      \"src_env_sk\"\n    ]\n  }\n]"
}


-----------------orx_l_formulary_client_xref-------------------
{
  "final_table_schema": "{\"client_xref_sk\": \"long\", \"client_id\": \"string\", \"client_desc\": \"string\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "pipeline_name": "orx_l_formulary_client_xref",
  "primary_key": "client_id",
  "reformat_rules": "{\n  \"client_id\" : \"client_id\",\n  \"src_env_sk\" : \"CAST(CASE WHEN (table_schem = 'USRCLMXRF') THEN 480 ELSE 490 END AS DECIMAL(38,0))\",\n  \"client_desc\" : \"'-'\",\n  \"client_xref_sk\" : \"-1\"\n}",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "l_formulary_client_xref",
  "sk_service_col": "client_xref_sk",
  "read_incremental_files_flag": "false"
}
-----------------ctrx_l_formulary_client_xref-------------------
{
  "final_table_schema": "{\"client_xref_sk\": \"long\", \"client_id\": \"string\", \"client_desc\": \"string\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "pipeline_name": "ctrx_l_formulary_client_xref",
  "primary_key": "client_id",
  "reformat_rules": "{\n  \"client_id\" : \"client_id\",\n  \"src_env_sk\" : \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"client_desc\" : \"'-'\",\n  \"client_xref_sk\" : \"-1\"\n}",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "l_formulary_client_xref",
  "sk_service_col": "client_xref_sk",
  "read_incremental_files_flag": "false"
}
-----------------d_reporting_client_map-------------------
{
  "final_table_schema": "{\"rptg_clt_id\": \"int\", \"rptg_clt_nm\": \"string\", \"cag_sk\": \"long\", \"carrier_id\": \"string\", \"account_id\": \"string\", \"employer_group_id\": \"string\", \"eff_dt\": \"date\", \"bk_of_bsns\": \"string\", \"mbr_dtl_flg\": \"string\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "optional_filter_rules": "CAST(CASE WHEN (account_id = '*') THEN 1 WHEN ((account_id = cag_account_id) AND (employer_group_id = '*')) THEN 1 WHEN ((account_id = cag_account_id) AND (employer_group_id = cag_employer_group_id)) THEN 1 ELSE 0 END AS BOOLEAN)",
  "pipeline_name": "d_reporting_client_map",
  "primary_key": "rptg_clt_id,carrier_id,account_id,employer_group_id",
  "reformat_rules": "{\n  \"eff_dt\": \"date_format(to_date(effective_date, 'MM/dd/yyyy'), 'yyyyMMdd')\",\n  \"cag_sk\": \"CAST(cag_sk AS DECIMAL(38,0))\",\n  \"bk_of_bsns\": \"bk_of_busines\",\n  \"account_id\": \"cag_account_id\",\n  \"rptg_clt_nm\": \"client_name\",\n  \"mbr_dtl_flg\": \"mbr_dtl_flg\",\n  \"carrier_id\": \"cag_carrier_id\",\n  \"employer_group_id\": \"cag_employer_group_id\",\n  \"rptg_clt_id\": \"CAST(dxf_sk0 AS DECIMAL(38,0))\",\n  \"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"client_name\": \"client_name\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"csv\",\n    \"src\": \"rxclaim.d_reporting_client_map_enrich\",\n    \"join-cond\": \"in1.rptg_clt_nm = in0.client_name\",\n    \"val-cols\": [\n      \"in1.dxf_sk AS dxf_sk0\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "d_reporting_client_map",
  "sk_service_col": "rptg_clt_id",
  "read_incremental_files_flag": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"d_reporting_client_map_enrich\",\n    \"sk-col\": \"dxf_sk\",\n    \"nk-col\": [\n      \"client_name\"\n    ]\n  }\n]"
}
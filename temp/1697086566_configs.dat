ghp_CqFc6aIm0m4dlmUdmw1xh2gqw9tSNr12OvF
https://github.com/SimpleDataLabsInc/transpiler-optum.git
-----------------orx_d_member_adjustment-------------------
{
  "final_table_schema": "{\"mad_sk\": \"long\", \"mbr_sk\": \"long\", \"cag_sk\": \"long\", \"carrier_sk\": \"long\", \"mbr_id\": \"string\", \"carrier_id\": \"string\", \"account_id\": \"string\", \"employer_group_id\": \"string\", \"mad_adjtmnt_dt\": \"date\", \"mad_seq_nbr\": \"short\", \"mad_stat_cd\": \"string\", \"acm_accumultn_cd\": \"string\", \"adj_adjtmnt_cd\": \"string\", \"mad_adjtmnt_amt\": \"decimal(9, 2)\", \"mad_ben_ded_typ_cd\": \"string\", \"mad_clt_bnft_cd\": \"string\", \"mad_rec_ts\": \"timestamp\", \"mad_rec_order\": \"long\", \"mad_rec_id\": \"string\", \"mad_amt_typ_cd\": \"string\", \"mad_sender_typ_cd\": \"string\", \"mad_sender_id\": \"string\", \"mad_sender_desc\": \"string\", \"mad_sender_claim_nbr\": \"string\", \"mad_sender_claim_seq_nbr\": \"string\", \"mad_sender_claim_stat_cd\": \"string\", \"mad_sender_ts\": \"timestamp\", \"mad_adj_time\": \"timestamp\", \"mad_adj_ms\": \"short\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "pipeline_name": "orx_d_member_adjustment",
  "primary_key": "mbr_id,carrier_id,account_id,employer_group_id,mad_adjtmnt_dt,mad_seq_nbr,src_env_sk",
  "reformat_rules": "{\n  \"mad_sk\": \"-1\",\n  \"mad_sender_typ_cd\": \"i5b4h9\",\n  \"mad_clt_bnft_cd\": \"i5dgih\",\n  \"mad_seq_nbr\": \"CAST(i5emn1 AS DECIMAL(38,0))\",\n  \"cag_sk\": \"in1_cag_sk\",\n  \"mad_sender_claim_nbr\": \"i5dmih\",\n  \"mad_adjtmnt_dt\": \"CASE WHEN coalesce(((length(CAST(i5h1dt AS STRING)) = 8) AND ((NOT (CASE WHEN (length(trim(CAST(i5h1dt AS STRING))) = 8) THEN date_format(to_date(trim(CAST(i5h1dt AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(CAST(i5h1dt AS STRING))) = 8) THEN date_format(to_date(trim(CAST(i5h1dt AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce((array_contains(array(6, 7), length(CAST(i5h1dt AS STRING))) AND ((NOT (CASE WHEN (length(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING))) = 8) THEN date_format(to_date(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING))) = 8) THEN date_format(to_date(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE NULL END\",\n  \"mbr_id\": \"i5abcd\",\n  \"mad_stat_cd\": \"i5yns2\",\n  \"mad_rec_ts\": \"CASE WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 20), 'yyyy-MM-dd HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(substring(i5dhih, 1, 25), 'yyyy-MM-ddHH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(substring(i5dhih, 1, 25), 1, 19), 'yyyy-MM-ddHH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd-HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 20), 'yyyy-MM-dd-HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 22), 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.'), 'yyyyMMdd HH:mm:ss') ELSE '19000101 00:00:00' END\",\n  \"mad_ben_ded_typ_cd\": \"i5d6s2\",\n  \"mad_sender_id\": \"i5dkih\",\n  \"mbr_sk\": \"in1_mbr_sk\",\n  \"acm_accumultn_cd\": \"i5rjc2\",\n  \"mad_adj_ms\": \"CAST(i5hibr AS DECIMAL(38,0))\",\n  \"carrier_sk\": \"in1_carrier_sk\",\n  \"mad_sender_claim_seq_nbr\": \"i5dnih\",\n  \"mad_rec_id\": \"i5djih\",\n  \"account_id\": \"i5accd\",\n  \"mad_rec_order\": \"CAST(i5yshr AS DECIMAL(38,0))\",\n  \"carrier_id\": \"i5aacd\",\n  \"mad_amt_typ_cd\": \"i5b3h9\",\n  \"mad_adj_time\": \"date_format(to_timestamp(lpad(CAST(i5bltx AS STRING), 6, '0'), 'HHmmss'), 'HH:mm:ss.SSSSSS')\",\n  \"mad_adjtmnt_amt\": \"i5nbpr\",\n  \"employer_group_id\": \"i5adcd\",\n  \"adj_adjtmnt_cd\": \"i5rkc2\",\n  \"mad_sender_claim_stat_cd\": \"i5doih\",\n  \"mad_sender_desc\": \"i5dlih\",\n  \"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"mad_sender_ts\": \"CASE WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd-HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 20), 'yyyy-MM-dd-HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(substring(i5dpih, 1, 25), 'yyyy-MM-ddHH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(substring(i5dpih, 1, 25), 1, 19), 'yyyy-MM-ddHH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 20), 'yyyy-MM-dd HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 22), 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.'), 'yyyyMMdd HH:mm:ss') ELSE '19000101 00:00:00' END\",\n  \"i5accd\": \"i5accd\",\n  \"i5aacd\": \"i5aacd\",\n  \"i5adcd\": \"i5adcd\",\n  \"i5abcd\": \"i5abcd\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_cag\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd AND in1.account_id = in0.i5accd AND in1.employer_group_id = in0.i5adcd\",\n    \"val-cols\": [\n      \"in1.cag_sk as in1_cag_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_carrier\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd\",\n    \"val-cols\": [\n      \"in1.carrier_sk as in1_carrier_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_member\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd AND in1.account_id = in0.i5accd AND in1.employer_group_id = in0.i5adcd AND in1.mbr_id = in0.i5abcd\",\n    \"val-cols\": [\n      \"in1.mbr_sk as in1_mbr_sk\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "d_member_adjustment",
  "sk_service_col": "mad_sk",
  "read_incremental`_files_flag": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"d_cag\",\n    \"sk-col\": \"cag_sk\",\n    \"nk-col\": [\n      \"i5aacd\",\n      \"i5accd\",\n      \"i5adcd\"\n    ]\n  },\n  {\n    \"table-name\": \"d_carrier\",\n    \"sk-col\": \"carrier_sk\",\n    \"nk-col\": [\n      \"i5aacd\"\n    ]\n  },\n  {\n    \"table-name\": \"d_member\",\n    \"sk-col\": \"mbr_sk\",\n    \"nk-col\": [\n      \"i5aacd\",\n      \"i5accd\",\n      \"i5adcd\",\n      \"i5abcd\"\n    ]\n  }\n]"
}
-----------------ctrx_d_member_adjustment-------------------
{
  "final_table_schema": "{\"mad_sk\": \"long\", \"mbr_sk\": \"long\", \"cag_sk\": \"long\", \"carrier_sk\": \"long\", \"mbr_id\": \"string\", \"carrier_id\": \"string\", \"account_id\": \"string\", \"employer_group_id\": \"string\", \"mad_adjtmnt_dt\": \"date\", \"mad_seq_nbr\": \"short\", \"mad_stat_cd\": \"string\", \"acm_accumultn_cd\": \"string\", \"adj_adjtmnt_cd\": \"string\", \"mad_adjtmnt_amt\": \"decimal(9, 2)\", \"mad_ben_ded_typ_cd\": \"string\", \"mad_clt_bnft_cd\": \"string\", \"mad_rec_ts\": \"timestamp\", \"mad_rec_order\": \"long\", \"mad_rec_id\": \"string\", \"mad_amt_typ_cd\": \"string\", \"mad_sender_typ_cd\": \"string\", \"mad_sender_id\": \"string\", \"mad_sender_desc\": \"string\", \"mad_sender_claim_nbr\": \"string\", \"mad_sender_claim_seq_nbr\": \"string\", \"mad_sender_claim_stat_cd\": \"string\", \"mad_sender_ts\": \"timestamp\", \"mad_adj_time\": \"timestamp\", \"mad_adj_ms\": \"short\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "pipeline_name": "ctrx_d_member_adjustment",
  "primary_key": "mbr_id,carrier_id,account_id,employer_group_id,mad_adjtmnt_dt,mad_seq_nbr,src_env_sk",
  "reformat_rules": "{\n  \"mad_sk\": \"-1\",\n  \"mad_sender_typ_cd\": \"i5b4h9\",\n  \"mad_clt_bnft_cd\": \"i5dgih\",\n  \"mad_seq_nbr\": \"CAST(i5emn1 AS DECIMAL(38,0))\",\n  \"cag_sk\": \"in1_cag_sk\",\n  \"mad_sender_claim_nbr\": \"i5dmih\",\n  \"mad_adjtmnt_dt\": \"CASE WHEN coalesce(((length(CAST(i5h1dt AS STRING)) = 8) AND ((NOT (CASE WHEN (length(trim(CAST(i5h1dt AS STRING))) = 8) THEN date_format(to_date(trim(CAST(i5h1dt AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(CAST(i5h1dt AS STRING))) = 8) THEN date_format(to_date(trim(CAST(i5h1dt AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce((array_contains(array(6, 7), length(CAST(i5h1dt AS STRING))) AND ((NOT (CASE WHEN (length(trim(CAST((19000000 + CAST(i5h1dt AS STRING)) AS STRING))) = 8) THEN date_format(to_date(trim(CAST((19000000 + CAST(i5h1dt AS STRING)) AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING))) = 8) THEN date_format(to_date(trim(CAST((CAST(i5h1dt AS STRING) + 19000000) AS STRING)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\",\n  \"mbr_id\": \"i5abcd\",\n  \"mad_stat_cd\": \"i5yns2\",\n  \"mad_rec_ts\": \"CASE WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd-HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 20), 'yyyy-MM-dd-HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(substring(i5dhih, 1, 25), 'yyyy-MM-ddHH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(substring(i5dhih, 1, 25), 1, 19), 'yyyy-MM-ddHH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 20), 'yyyy-MM-dd HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dhih, 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dhih, 1, 22), 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.'), 'yyyyMMdd HH:mm:ss') ELSE '19000101 00:00:00' END\",\n  \"mad_ben_ded_typ_cd\": \"i5d6s2\",\n  \"mad_sender_id\": \"i5dkih\",\n  \"mbr_sk\": \"in1_mbr_sk\",\n  \"acm_accumultn_cd\": \"i5rjc2\",\n  \"mad_adj_ms\": \"CAST(i5hibr AS DECIMAL(38,0))\",\n  \"carrier_sk\": \"in1_carrier_sk\",\n  \"mad_sender_claim_seq_nbr\": \"i5dnih\",\n  \"mad_rec_id\": \"i5djih\",\n  \"account_id\": \"i5accd\",\n  \"mad_rec_order\": \"CAST(i5yshr AS DECIMAL(38,0))\",\n  \"carrier_id\": \"i5aacd\",\n  \"mad_amt_typ_cd\": \"i5b3h9\",\n  \"mad_adj_time\": \"date_format(to_timestamp(lpad(CAST(i5bltx AS STRING), 6, '0'), 'HHmmss'), 'HH:mm:ss.SSSSSS')\",\n  \"mad_adjtmnt_amt\": \"i5nbpr\",\n  \"employer_group_id\": \"i5adcd\",\n  \"adj_adjtmnt_cd\": \"i5rkc2\",\n  \"mad_sender_claim_stat_cd\": \"i5doih\",\n  \"mad_sender_desc\": \"i5dlih\",\n  \"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"mad_sender_ts\": \"CASE WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 22), 'yyyy-MM-dd\\\\'T\\\\'HH:mm:ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd-HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 20), 'yyyy-MM-dd-HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(substring(i5dpih, 1, 25), 'yyyy-MM-ddHH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(substring(i5dpih, 1, 25), 1, 19), 'yyyy-MM-ddHH.mm.ss.'), 'yyyyMMdd HH:mm:ss') WHEN coalesce((CASE WHEN (date_format(to_timestamp(i5dpih, 'yyyy-MM-dd HH.mm.ss.SSSSSS'), 'yyyyMMdd HH:mm:ss') IS NULL) THEN false ELSE true END = 1), CAST(0 AS BOOLEAN)) THEN date_format(to_timestamp(substring(i5dpih, 1, 20), 'yyyy-MM-dd HH.mm.ss.'), 'yyyyMMdd HH:mm:ss') ELSE '19000101 00:00:00' END\",\n  \"i5accd\": \"i5accd\",\n  \"i5aacd\": \"i5aacd\",\n  \"i5adcd\": \"i5adcd\",\n  \"i5abcd\": \"i5abcd\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_cag\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd AND in1.account_id = in0.i5accd AND in1.employer_group_id = in0.i5adcd\",\n    \"val-cols\": [\n      \"in1.cag_sk as in1_cag_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_carrier\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd\",\n    \"val-cols\": [\n      \"in1.carrier_sk as in1_carrier_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_member\",\n    \"join-cond\": \"in1.carrier_id = in0.i5aacd AND in1.account_id = in0.i5accd AND in1.employer_group_id = in0.i5adcd AND in1.mbr_id = in0.i5abcd\",\n    \"val-cols\": [\n      \"in1.mbr_sk as in1_mbr_sk\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "d_member_adjustment",
  "sk_service_col": "mad_sk",
  "read_incremental_files_flag": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"d_cag\",\n    \"sk-col\": \"cag_sk\",\n    \"nk-col\": [\n      \"i5aacd\",\n      \"i5accd\",\n      \"i5adcd\"\n    ]\n  },\n  {\n    \"table-name\": \"d_carrier\",\n    \"sk-col\": \"carrier_sk\",\n    \"nk-col\": [\n      \"i5aacd\"\n    ]\n  },\n  {\n    \"table-name\": \"d_member\",\n    \"sk-col\": \"mbr_sk\",\n    \"nk-col\": [\n      \"i5aacd\",\n      \"i5accd\",\n      \"i5adcd\",\n      \"i5abcd\"\n    ]\n  }\n]"
}
-----------------ctrx_f_claim_mic_detail-------------------
{
  "final_table_schema": "{\"claim_nbr\": \"long\", \"claim_seq_nbr\": \"int\", \"claim_stat_id\": \"string\", \"claim_mic_seq_no\": \"int\", \"claim_stat_sk\": \"long\", \"carrier_sk\": \"long\", \"carrier_acct_sk\": \"long\", \"cag_sk\": \"long\", \"mbr_sk\": \"long\", \"final_pln_sk\": \"long\", \"phr_sk\": \"long\", \"pbr_sk\": \"long\", \"compound_sk\": \"long\", \"prod_sk\": \"long\", \"gpi_sk\": \"long\", \"drug_sk\": \"long\", \"ahfs_cd_sk\": \"long\", \"drug_rx_otc_ind_sk\": \"long\", \"drug_maint_cd_sk\": \"long\", \"admin_rte_sk\": \"long\", \"gnrc_mdspn_ind_sk\": \"long\", \"gnrc_ind_sk\": \"long\", \"dea_cd_sk\": \"long\", \"dsg_frm_sk\": \"long\", \"orig_carrier_sk\": \"long\", \"orig_mbr_sk\": \"long\", \"orig_cag_sk\": \"long\", \"orig_carrier_id\": \"string\", \"orig_account_id\": \"string\", \"orig_employer_group_id\": \"string\", \"orig_member_id\": \"string\", \"claim_seq_nbr_src\": \"int\", \"sbm_dt_sk\": \"long\", \"sbm_dt\": \"date\", \"sbm_yr\": \"int\", \"sbm_mnth\": \"int\", \"filled_dt_sk\": \"long\", \"filled_dt\": \"date\", \"rx_written_dt\": \"date\", \"rx_nbr\": \"string\", \"refill_nbr\": \"string\", \"drg_qty\": \"decimal(11, 3)\", \"awp_unit_cost\": \"decimal(24, 8)\", \"extd_awp_cost\": \"decimal(13, 5)\", \"refill_max\": \"short\", \"days_of_supply\": \"short\", \"days_of_supply_sk\": \"long\", \"dmr_ind_sk\": \"long\", \"injectable_ind_sk\": \"long\", \"injectable_ind\": \"string\", \"app_patient_pay_amt\": \"decimal(9, 2)\", \"app_due_amt\": \"decimal(9, 2)\", \"clt_ingred_cost_paid\": \"decimal(9, 2)\", \"clt_dispensing_fee\": \"decimal(9, 2)\", \"sbm_ingred_cost_paid\": \"decimal(9, 2)\", \"sbm_dispensing_fee\": \"decimal(9, 2)\", \"sbm_patient_pay_amt\": \"decimal(9, 2)\", \"sbm_due_amt\": \"decimal(9, 2)\", \"sbm_cmp_prod_id\": \"string\", \"sbm_cmp_prod_id_qlfr_cd\": \"string\", \"cmp_prod_key\": \"long\", \"prod_short_desc\": \"string\", \"prod_nm\": \"string\", \"drg_mfr_id\": \"string\", \"drg_mfr_nm\": \"string\", \"drg_gnrc_nm\": \"string\", \"drg_desc_id\": \"int\", \"gcn_no\": \"int\", \"gcn_seq_no\": \"int\", \"prod_kdc\": \"long\", \"prod_reim_ind\": \"string\", \"brand_generic_cd\": \"string\", \"drg_fda_thrpc_eqvlc_cd\": \"string\", \"drg_strngth_qty\": \"decimal(11, 3)\", \"drg_strngth_uom_cd\": \"string\", \"drg_3rd_prty_excpn_ind\": \"string\", \"drg_unit_dose_use_ind\": \"string\", \"sbm_cmp_ingred_qty\": \"decimal(11, 3)\", \"sbm_cmp_ingred_cost_amt\": \"decimal(9, 2)\", \"sbm_cmp_basis_of_cost_cd\": \"string\", \"ingred_stat_cd\": \"string\", \"cmd_cal_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_app_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_clt_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_app_cost_src_cd\": \"string\", \"cmd_app_cost_type_cd\": \"string\", \"cmd_app_cost_type_unit_cost\": \"decimal(13, 5)\", \"cmd_clt_cost_src_cd\": \"string\", \"cmd_clt_cost_type_cd\": \"string\", \"cmd_clt_cost_type_unit_cost\": \"decimal(13, 5)\", \"cmd_awp_unit_cost\": \"decimal(13, 5)\", \"cmd_cal_prof_svc_fee\": \"decimal(9, 2)\", \"cmd_app_prof_svc_fee\": \"decimal(9, 2)\", \"cmd_clt_prof_svc_fee\": \"decimal(9, 2)\", \"eci_rm_ind\": \"string\", \"eci_px_ind\": \"string\", \"eci_ms_ind\": \"string\", \"phr_drg_cost_pct\": \"decimal(5, 2)\", \"rbl_drg_cost_pct\": \"decimal(5, 2)\", \"cmd_ingred_mod_cd_cnt\": \"int\", \"cmd_ingred_mod_cd1\": \"string\", \"cmd_ingred_mod_cd2\": \"string\", \"cmd_ingred_mod_cd3\": \"string\", \"cmd_ing_dru_cov_sts\": \"string\", \"tc4_drg_cov_stat_cd\": \"string\", \"cmd_ingred_nda_flg\": \"string\", \"cmd_ingred_nda_ovrd_flg\": \"string\", \"cmd_ingred_bla_flg\": \"string\", \"cmd_ingred_bla_ovrd_flg\": \"string\", \"cmd_ingred_anda_flg\": \"string\", \"cmd_ingred_anda_ovrd_flg\": \"string\", \"cmd_exp_ingred_flg\": \"string\", \"src_env_sk\": \"long\", \"claim_nbr_encrp\": \"long\", \"rx_nbr_encrp\": \"string\", \"sec_flg\": \"double\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "optional_filter_rules": "F_claim_reduced_lkp_match0",
  "optional_filter_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"rxclaims.reduced\",\n    \"join-cond\": \"in1.claim_nbr = CAST(in0.agp2nb AS DECIMAL(17,0)) AND in1.claim_seq_nbr = CAST(CASE WHEN (CAST(in0.ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(in0.ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(in0.ags6nb AS DECIMAL(5,0))) END AS BOOLEAN) AND in1.claim_stat_id = in0.agzsst AND in1.src_env_sk = in0.rxt_src_envrt_id\",\n    \"val-cols\": [\n      \"CASE WHEN ((in1.claim_nbr IS NULL) AND ((in1.claim_seq_nbr IS NULL) AND ((in1.claim_stat_id IS NULL) AND (in1.src_env_sk IS NULL)))) THEN false ELSE true END AS F_claim_reduced_lkp_match0\"\n    ]\n  }\n]",
  "pipeline_name": "ctrx_f_claim_mic_detail",
  "primary_key": "claim_nbr,claim_seq_nbr,claim_stat_id,claim_mic_seq_no,src_env_sk",
  "reformat_rules": "{\n  \"drug_rx_otc_ind_sk\": \"in1_drug_rx_otc_ind_sk\",\n  \"orig_carrier_sk\": \"CAST(orig_carrier_sk0 AS DECIMAL(38,0))\",\n  \"extd_awp_cost\": \"CAST((CAST(agikhx AS DECIMAL(15,5)) * CAST(agsan2 AS DECIMAL(13,3))) AS DECIMAL(38,5))\",\n  \"sbm_mnth\": \"CAST(date_format(to_date(sbm_dt0, 'yyyyMMdd'), 'MM') AS DECIMAL(38,0))\",\n  \"cag_sk\": \"CAST(cag_sk0 AS DECIMAL(38,0))\",\n  \"injectable_ind_sk\": \"CAST(injectable_ind_sk0 AS DECIMAL(38,0))\",\n  \"orig_carrier_id\": \"orig_carrier_id0\",\n  \"claim_stat_id\": \"claim_stat_id0\",\n  \"dea_cd_sk\": \"in1_dea_cd_sk\",\n  \"sbm_dispensing_fee\": \"sbm_dispensing_fee0\",\n  \"sbm_cmp_ingred_cost_amt\": \"aguip1\",\n  \"cmd_ingred_mod_cd_cnt\": \"CAST(agdzpp AS DECIMAL(38,0))\",\n  \"carrier_acct_sk\": \"CAST(carrier_acct_sk0 AS DECIMAL(38,0))\",\n  \"tc4_drg_cov_stat_cd\": \"ago6h9\",\n  \"claim_nbr_encrp\": \"CAST(CASE WHEN (claim_nbr0 > 0) THEN CAST(concat(substring(CAST(claim_nbr0 AS STRING), 1, 2), ff3_encrypt_idwdata(CAST(CAST(claim_nbr0 AS STRING) AS STRING))) AS STRING) ELSE CAST(concat(substring(CAST(claim_nbr0 AS STRING), 1, 3), ff3_encrypt_idwdata(CAST(CASE WHEN (abs(CAST(claim_nbr0 AS STRING)) IS NULL) THEN '0' ELSE CASE WHEN (regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1) = '') THEN '0' ELSE CASE WHEN (instr(substring(abs(CAST(claim_nbr0 AS STRING)), 0, instr_udf(CAST(abs(CAST(claim_nbr0 AS STRING)) AS STRING), regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1))), '-') > 0) THEN concat('-', regexp_replace(regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1), '\\\\\\\\s+', '', 1)) ELSE regexp_replace(regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1), '\\\\\\\\s+', '', 1) END END END AS STRING))) AS STRING) END AS DECIMAL(38,0))\",\n  \"drg_3rd_prty_excpn_ind\": \"agd3px\",\n  \"sbm_yr\": \"CAST(date_format(to_date(sbm_dt0, 'yyyyMMdd'), 'yyyy') AS DECIMAL(38,0))\",\n  \"prod_short_desc\": \"agcnt3\",\n  \"orig_mbr_sk\": \"CAST(orig_mbr_sk0 AS DECIMAL(38,0))\",\n  \"cmd_app_cost_type_unit_cost\": \"agiohx\",\n  \"prod_kdc\": \"CAST(agciv1 AS DECIMAL(38,0))\",\n  \"prod_nm\": \"agcot3\",\n  \"claim_nbr\": \"CAST(claim_nbr0 AS DECIMAL(38,0))\",\n  \"claim_stat_sk\": \"CAST(claim_stat_sk0 AS DECIMAL(38,0))\",\n  \"rbl_drg_cost_pct\": \"age7hv\",\n  \"cmd_app_cost_src_cd\": \"agi8h7\",\n  \"cmd_cal_prof_svc_fee\": \"agj7hy\",\n  \"cmd_ingred_anda_ovrd_flg\": \"aghyai\",\n  \"sec_flg\": \"0\",\n  \"admin_rte_sk\": \"in1_admin_rte_sk\",\n  \"brand_generic_cd\": \"agpfc3\",\n  \"drg_qty\": \"drg_qty0\",\n  \"awp_unit_cost\": \"awp_unit_cost0\",\n  \"cmp_prod_key\": \"CAST(agr9n2 AS DECIMAL(38,0))\",\n  \"sbm_cmp_basis_of_cost_cd\": \"agi6cj\",\n  \"claim_seq_nbr\": \"CAST(claim_seq_nbr0 AS DECIMAL(38,0))\",\n  \"orig_cag_sk\": \"CAST(orig_cag_sk0 AS DECIMAL(38,0))\",\n  \"cmd_ingred_mod_cd1\": \"agsthk\",\n  \"prod_sk\": \"in1_prod_sk\",\n  \"final_pln_sk\": \"CAST(final_pln_sk0 AS DECIMAL(38,0))\",\n  \"mbr_sk\": \"CAST(mbr_sk0 AS DECIMAL(38,0))\",\n  \"cmd_clt_cost_type_cd\": \"agqkhb\",\n  \"sbm_cmp_prod_id_qlfr_cd\": \"agi5cj\",\n  \"gnrc_mdspn_ind_sk\": \"in1_gnrc_mdspn_ind_sk\",\n  \"prod_reim_ind\": \"agpdc3\",\n  \"app_patient_pay_amt\": \"app_patient_pay_amt0\",\n  \"sbm_dt\": \"sbm_dt0\",\n  \"sbm_ingred_cost_paid\": \"sbm_ingred_cost_paid0\",\n  \"sbm_cmp_prod_id\": \"agr9c4\",\n  \"cmd_ingred_mod_cd2\": \"agsuhk\",\n  \"cmd_app_ingred_cost_amt\": \"agimhx\",\n  \"rx_written_dt\": \"rx_written_dt0\",\n  \"app_due_amt\": \"app_due_amt0\",\n  \"drg_mfr_id\": \"agdlcd\",\n  \"cmd_ingred_anda_flg\": \"aghxai\",\n  \"carrier_sk\": \"CAST(carrier_sk0 AS DECIMAL(38,0))\",\n  \"gnrc_ind_sk\": \"in1_gnrc_ind_sk\",\n  \"rx_nbr_encrp\": \"ff3_encrypt_idwdata(CAST(rx_nbr0 AS STRING))\",\n  \"injectable_ind\": \"injectable_ind0\",\n  \"filled_dt\": \"filled_dt0\",\n  \"drg_strngth_uom_cd\": \"agtat3\",\n  \"gcn_seq_no\": \"CAST(agxsn1 AS DECIMAL(38,0))\",\n  \"cmd_ingred_bla_flg\": \"aghvai\",\n  \"eci_ms_ind\": \"agqlia\",\n  \"dmr_ind_sk\": \"CAST(dmr_ind_sk0 AS DECIMAL(38,0))\",\n  \"drg_mfr_nm\": \"agdgcd\",\n  \"cmd_clt_cost_src_cd\": \"agi9h7\",\n  \"filled_dt_sk\": \"CAST(filled_dt_sk0 AS DECIMAL(38,0))\",\n  \"drg_desc_id\": \"CAST(agh6t2 AS DECIMAL(38,0))\",\n  \"dsg_frm_sk\": \"in1_dsg_frm_sk\",\n  \"pbr_sk\": \"CAST(pbr_sk0 AS DECIMAL(38,0))\",\n  \"claim_mic_seq_no\": \"CAST(agr7n2 AS DECIMAL(38,0))\",\n  \"ahfs_cd_sk\": \"in1_ahfs_cd_sk\",\n  \"gcn_no\": \"CAST(agxrn1 AS DECIMAL(38,0))\",\n  \"drg_fda_thrpc_eqvlc_cd\": \"agdkcd\",\n  \"cmd_clt_prof_svc_fee\": \"agj9hy\",\n  \"sbm_due_amt\": \"sbm_due_amt0\",\n  \"cmd_ing_dru_cov_sts\": \"aghsai\",\n  \"gpi_sk\": \"in1_gpi_sk\",\n  \"claim_seq_nbr_src\": \"CAST(claim_seq_nbr_src0 AS DECIMAL(38,0))\",\n  \"compound_sk\": \"CAST(compound_sk0 AS DECIMAL(38,0))\",\n  \"cmd_ingred_mod_cd3\": \"agsvhk\",\n  \"sbm_cmp_ingred_qty\": \"agsan2\",\n  \"sbm_patient_pay_amt\": \"sbm_patient_pay_amt0\",\n  \"drg_strngth_qty\": \"agagqt\",\n  \"cmd_app_prof_svc_fee\": \"agj8hy\",\n  \"cmd_ingred_bla_ovrd_flg\": \"aghwai\",\n  \"clt_dispensing_fee\": \"clt_dispensing_fee0\",\n  \"phr_sk\": \"CAST(phr_sk0 AS DECIMAL(38,0))\",\n  \"sbm_dt_sk\": \"CAST(sbm_dt_sk0 AS DECIMAL(38,0))\",\n  \"drug_sk\": \"in1_drug_sk\",\n  \"drg_gnrc_nm\": \"agxktx\",\n  \"refill_nbr\": \"refill_nbr0\",\n  \"orig_employer_group_id\": \"orig_employer_group_id0\",\n  \"drug_maint_cd_sk\": \"in1_drug_maint_cd_sk\",\n  \"cmd_exp_ingred_flg\": \"aghzai\",\n  \"cmd_ingred_nda_flg\": \"aghtai\",\n  \"eci_px_ind\": \"agqkia\",\n  \"drg_unit_dose_use_ind\": \"agdudu\",\n  \"cmd_clt_ingred_cost_amt\": \"aginhx\",\n  \"cmd_awp_unit_cost\": \"agikhx\",\n  \"ingred_stat_cd\": \"agjah7\",\n  \"phr_drg_cost_pct\": \"age6hv\",\n  \"days_of_supply\": \"CAST(days_sply0 AS DECIMAL(38,0))\",\n  \"orig_account_id\": \"orig_account_id0\",\n  \"refill_max\": \"CAST(refill_max0 AS DECIMAL(38,0))\",\n  \"src_env_sk\": \"CAST(rxt_src_envrt_id AS DECIMAL(38,0))\",\n  \"orig_member_id\": \"orig_member_id0\",\n  \"cmd_app_cost_type_cd\": \"agqjhb\",\n  \"cmd_cal_ingred_cost_amt\": \"agilhx\",\n  \"eci_rm_ind\": \"agqjia\",\n  \"cmd_ingred_nda_ovrd_flg\": \"aghuai\",\n  \"clt_ingred_cost_paid\": \"clt_ingred_cost_paid0\",\n  \"rx_nbr\": \"rx_nbr0\",\n  \"cmd_clt_cost_type_unit_cost\": \"agiphx\",\n  \"days_of_supply_sk\": \"CAST(days_of_supply_sk0 AS DECIMAL(38,0))\",\n  \"agmdcd\": \"agmdcd\",\n  \"agozs3\": \"agozs3\",\n  \"agqihb\": \"agqihb\",\n  \"agi5cj\": \"agi5cj\",\n  \"agddea\": \"agddea\",\n  \"agzxst\": \"agzxst\",\n  \"agebc4\": \"agebc4\",\n  \"agdicd\": \"agdicd\",\n  \"agdrxo\": \"agdrxo\",\n  \"ags6nb\": \"ags6nb\",\n  \"agp2nb\": \"agp2nb\",\n  \"agr9c4\": \"agr9c4\",\n  \"agdhcd\": \"agdhcd\",\n  \"agzsst\": \"agzsst\",\n  \"rxt_src_envrt_id\": \"rxt_src_envrt_id\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_admin_route\",\n    \"join-cond\": \"in1.admin_rte_id = in0.agdicd\",\n    \"val-cols\": [\n      \"in1.admin_rte_sk as in1_admin_rte_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_ahfs\",\n    \"join-cond\": \"in1.ahfs_cd = in0.agebc4\",\n    \"val-cols\": [\n      \"in1.ahfs_cd_sk as in1_ahfs_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_dea\",\n    \"join-cond\": \"in1.dea_cd = in0.agddea\",\n    \"val-cols\": [\n      \"in1.dea_cd_sk as in1_dea_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_drug\",\n    \"join-cond\": \"in1.drg_nm_extn_id = substring(in0.agqihb, 0, 10)\",\n    \"val-cols\": [\n      \"in1.drug_sk as in1_drug_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_drug_maintenance\",\n    \"join-cond\": \"in1.drug_maint_cd = in0.agmdcd\",\n    \"val-cols\": [\n      \"in1.drug_maint_cd_sk as in1_drug_maint_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_drug_otc_indicator\",\n    \"join-cond\": \"in1.drug_rx_otc_ind = in0.agdrxo\",\n    \"val-cols\": [\n      \"in1.drug_rx_otc_ind_sk as in1_drug_rx_otc_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_dosage_form\",\n    \"join-cond\": \"in1.dsg_frm_id = in0.agdhcd\",\n    \"val-cols\": [\n      \"in1.dsg_frm_sk as in1_dsg_frm_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_generic_medispan_indicator\",\n    \"join-cond\": \"in1.gnrc_mdspn_ind = in0.agzxst\",\n    \"val-cols\": [\n      \"in1.gnrc_ind_sk as in1_gnrc_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_generic_medispan_indicator\",\n    \"join-cond\": \"in1.gnrc_mdspn_ind = in0.agozs3\",\n    \"val-cols\": [\n      \"in1.gnrc_mdspn_ind_sk as in1_gnrc_mdspn_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_gpi\",\n    \"join-cond\": \"in1.gpi_id = in0.agqihb\",\n    \"val-cols\": [\n      \"in1.gpi_sk as in1_gpi_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_product\",\n    \"join-cond\": \"in1.prod_id = in0.agr9c4 AND in1.prod_id_qlfr_cd = in0.agi5cj\",\n    \"val-cols\": [\n      \"in1.prod_sk as in1_prod_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"csv\",\n    \"src\": \"rxclaim_ctrx.rcecip\",\n    \"join-cond\": \"in1.claim_nbr = CAST(in0.agp2nb AS DECIMAL(17,0)) AND in1.claim_seq_nbr = CASE WHEN (CAST(in0.ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(in0.ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(in0.ags6nb AS DECIMAL(5,0))) END AND in1.claim_stat_id = in0.agzsst AND in1.src_env_sk = in0.rxt_src_envrt_id\",\n    \"val-cols\": [\n      \"in1.claim_nbr AS claim_nbr0\",\n      \"in1.claim_seq_nbr AS claim_seq_nbr0\",\n      \"in1.claim_stat_id AS claim_stat_id0\",\n      \"in1.claim_stat_sk AS claim_stat_sk0\",\n      \"in1.carrier_sk AS carrier_sk0\",\n      \"in1.carrier_acct_sk AS carrier_acct_sk0\",\n      \"in1.cag_sk AS cag_sk0\",\n      \"in1.mbr_sk AS mbr_sk0\",\n      \"in1.final_pln_sk AS final_pln_sk0\",\n      \"in1.phr_sk AS phr_sk0\",\n      \"in1.pbr_sk AS pbr_sk0\",\n      \"in1.compound_sk AS compound_sk0\",\n      \"in1.orig_carrier_sk AS orig_carrier_sk0\",\n      \"in1.orig_mbr_sk AS orig_mbr_sk0\",\n      \"in1.orig_cag_sk AS orig_cag_sk0\",\n      \"in1.orig_carrier_id AS orig_carrier_id0\",\n      \"in1.orig_account_id AS orig_account_id0\",\n      \"in1.orig_employer_group_id AS orig_employer_group_id0\",\n      \"in1.orig_member_id AS orig_member_id0\",\n      \"in1.claim_seq_nbr_src AS claim_seq_nbr_src0\",\n      \"in1.sbm_dt_sk AS sbm_dt_sk0\",\n      \"in1.sbm_dt AS sbm_dt0\",\n      \"in1.filled_dt_sk AS filled_dt_sk0\",\n      \"in1.filled_dt AS filled_dt0\",\n      \"in1.rx_written_dt AS rx_written_dt0\",\n      \"in1.rx_nbr AS rx_nbr0\",\n      \"in1.refill_nbr AS refill_nbr0\",\n      \"in1.drg_qty AS drg_qty0\",\n      \"in1.awp_unit_cost AS awp_unit_cost0\",\n      \"in1.refill_max AS refill_max0\",\n      \"in1.days_sply AS days_sply0\",\n      \"in1.days_of_supply_sk AS days_of_supply_sk0\",\n      \"in1.dmr_ind_sk AS dmr_ind_sk0\",\n      \"in1.injectable_ind_sk AS injectable_ind_sk0\",\n      \"in1.injectable_ind AS injectable_ind0\",\n      \"in1.app_patient_pay_amt AS app_patient_pay_amt0\",\n      \"in1.app_due_amt AS app_due_amt0\",\n      \"in1.clt_ingred_cost_paid AS clt_ingred_cost_paid0\",\n      \"in1.clt_dispensing_fee AS clt_dispensing_fee0\",\n      \"in1.sbm_ingred_cost_paid AS sbm_ingred_cost_paid0\",\n      \"in1.sbm_dispensing_fee AS sbm_dispensing_fee0\",\n      \"in1.sbm_patient_pay_amt AS sbm_patient_pay_amt0\",\n      \"in1.sbm_due_amt AS sbm_due_amt0\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "f_claim_mic_detail",
  "read_incremental_files_flag": "false",
  "sk_service_self_join": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"l_admin_route\",\n    \"sk-col\": \"admin_rte_sk\",\n    \"nk-col\": [\n      \"agdicd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_ahfs\",\n    \"sk-col\": \"ahfs_cd_sk\",\n    \"nk-col\": [\n      \"agebc4\"\n    ]\n  },\n  {\n    \"table-name\": \"l_dea\",\n    \"sk-col\": \"dea_cd_sk\",\n    \"nk-col\": [\n      \"agddea\"\n    ]\n  },\n  {\n    \"table-name\": \"d_drug\",\n    \"sk-col\": \"drug_sk\",\n    \"nk-col\": [\n      \"substring(agqihb, 0, 10)\"\n    ]\n  },\n  {\n    \"table-name\": \"l_drug_maintenance\",\n    \"sk-col\": \"drug_maint_cd_sk\",\n    \"nk-col\": [\n      \"agmdcd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_drug_otc_indicator\",\n    \"sk-col\": \"drug_rx_otc_ind_sk\",\n    \"nk-col\": [\n      \"agdrxo\"\n    ]\n  },\n  {\n    \"table-name\": \"l_dosage_form\",\n    \"sk-col\": \"dsg_frm_sk\",\n    \"nk-col\": [\n      \"agdhcd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_generic_medispan_indicator\",\n    \"sk-col\": \"gnrc_ind_sk\",\n    \"nk-col\": [\n      \"agzxst\"\n    ]\n  },\n  {\n    \"table-name\": \"l_generic_medispan_indicator\",\n    \"sk-col\": \"gnrc_mdspn_ind_sk\",\n    \"nk-col\": [\n      \"agozs3\"\n    ]\n  },\n  {\n    \"table-name\": \"d_gpi\",\n    \"sk-col\": \"gpi_sk\",\n    \"nk-col\": [\n      \"agqihb\"\n    ]\n  },\n  {\n    \"table-name\": \"d_product\",\n    \"sk-col\": \"prod_sk\",\n    \"nk-col\": [\n      \"agr9c4\",\n      \"agi5cj\"\n    ]\n  },\n  {\n    \"table-name\": \"rcecip\",\n    \"sk-col\": \"claim_nbr\",\n    \"nk-col\": [\n      \"CAST(agp2nb AS DECIMAL(17,0))\",\n      \"CASE WHEN (CAST(ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(ags6nb AS DECIMAL(5,0))) END\",\n      \"agzsst\",\n      \"rxt_src_envrt_id\"\n    ]\n  }\n]"
}
-----------------orx_f_claim_mic_detail-------------------
{
  "final_table_schema": "{\"claim_nbr\": \"long\", \"claim_seq_nbr\": \"int\", \"claim_stat_id\": \"string\", \"claim_mic_seq_no\": \"int\", \"claim_stat_sk\": \"long\", \"carrier_sk\": \"long\", \"carrier_acct_sk\": \"long\", \"cag_sk\": \"long\", \"mbr_sk\": \"long\", \"final_pln_sk\": \"long\", \"phr_sk\": \"long\", \"pbr_sk\": \"long\", \"compound_sk\": \"long\", \"prod_sk\": \"long\", \"gpi_sk\": \"long\", \"drug_sk\": \"long\", \"ahfs_cd_sk\": \"long\", \"drug_rx_otc_ind_sk\": \"long\", \"drug_maint_cd_sk\": \"long\", \"admin_rte_sk\": \"long\", \"gnrc_mdspn_ind_sk\": \"long\", \"gnrc_ind_sk\": \"long\", \"dea_cd_sk\": \"long\", \"dsg_frm_sk\": \"long\", \"orig_carrier_sk\": \"long\", \"orig_mbr_sk\": \"long\", \"orig_cag_sk\": \"long\", \"orig_carrier_id\": \"string\", \"orig_account_id\": \"string\", \"orig_employer_group_id\": \"string\", \"orig_member_id\": \"string\", \"claim_seq_nbr_src\": \"int\", \"sbm_dt_sk\": \"long\", \"sbm_dt\": \"date\", \"sbm_yr\": \"int\", \"sbm_mnth\": \"int\", \"filled_dt_sk\": \"long\", \"filled_dt\": \"date\", \"rx_written_dt\": \"date\", \"rx_nbr\": \"string\", \"refill_nbr\": \"string\", \"drg_qty\": \"decimal(11, 3)\", \"awp_unit_cost\": \"decimal(24, 8)\", \"extd_awp_cost\": \"decimal(13, 5)\", \"refill_max\": \"short\", \"days_of_supply\": \"short\", \"days_of_supply_sk\": \"long\", \"dmr_ind_sk\": \"long\", \"injectable_ind_sk\": \"long\", \"injectable_ind\": \"string\", \"app_patient_pay_amt\": \"decimal(9, 2)\", \"app_due_amt\": \"decimal(9, 2)\", \"clt_ingred_cost_paid\": \"decimal(9, 2)\", \"clt_dispensing_fee\": \"decimal(9, 2)\", \"sbm_ingred_cost_paid\": \"decimal(9, 2)\", \"sbm_dispensing_fee\": \"decimal(9, 2)\", \"sbm_patient_pay_amt\": \"decimal(9, 2)\", \"sbm_due_amt\": \"decimal(9, 2)\", \"sbm_cmp_prod_id\": \"string\", \"sbm_cmp_prod_id_qlfr_cd\": \"string\", \"cmp_prod_key\": \"long\", \"prod_short_desc\": \"string\", \"prod_nm\": \"string\", \"drg_mfr_id\": \"string\", \"drg_mfr_nm\": \"string\", \"drg_gnrc_nm\": \"string\", \"drg_desc_id\": \"int\", \"gcn_no\": \"int\", \"gcn_seq_no\": \"int\", \"prod_kdc\": \"long\", \"prod_reim_ind\": \"string\", \"brand_generic_cd\": \"string\", \"drg_fda_thrpc_eqvlc_cd\": \"string\", \"drg_strngth_qty\": \"decimal(11, 3)\", \"drg_strngth_uom_cd\": \"string\", \"drg_3rd_prty_excpn_ind\": \"string\", \"drg_unit_dose_use_ind\": \"string\", \"sbm_cmp_ingred_qty\": \"decimal(11, 3)\", \"sbm_cmp_ingred_cost_amt\": \"decimal(9, 2)\", \"sbm_cmp_basis_of_cost_cd\": \"string\", \"ingred_stat_cd\": \"string\", \"cmd_cal_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_app_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_clt_ingred_cost_amt\": \"decimal(9, 2)\", \"cmd_app_cost_src_cd\": \"string\", \"cmd_app_cost_type_cd\": \"string\", \"cmd_app_cost_type_unit_cost\": \"decimal(13, 5)\", \"cmd_clt_cost_src_cd\": \"string\", \"cmd_clt_cost_type_cd\": \"string\", \"cmd_clt_cost_type_unit_cost\": \"decimal(13, 5)\", \"cmd_awp_unit_cost\": \"decimal(13, 5)\", \"cmd_cal_prof_svc_fee\": \"decimal(9, 2)\", \"cmd_app_prof_svc_fee\": \"decimal(9, 2)\", \"cmd_clt_prof_svc_fee\": \"decimal(9, 2)\", \"eci_rm_ind\": \"string\", \"eci_px_ind\": \"string\", \"eci_ms_ind\": \"string\", \"phr_drg_cost_pct\": \"decimal(5, 2)\", \"rbl_drg_cost_pct\": \"decimal(5, 2)\", \"cmd_ingred_mod_cd_cnt\": \"int\", \"cmd_ingred_mod_cd1\": \"string\", \"cmd_ingred_mod_cd2\": \"string\", \"cmd_ingred_mod_cd3\": \"string\", \"cmd_ing_dru_cov_sts\": \"string\", \"tc4_drg_cov_stat_cd\": \"string\", \"cmd_ingred_nda_flg\": \"string\", \"cmd_ingred_nda_ovrd_flg\": \"string\", \"cmd_ingred_bla_flg\": \"string\", \"cmd_ingred_bla_ovrd_flg\": \"string\", \"cmd_ingred_anda_flg\": \"string\", \"cmd_ingred_anda_ovrd_flg\": \"string\", \"cmd_exp_ingred_flg\": \"string\", \"src_env_sk\": \"long\", \"claim_nbr_encrp\": \"long\", \"rx_nbr_encrp\": \"string\", \"sec_flg\": \"double\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "optional_filter_rules": "F_claim_reduced_lkp_match0",
  "optional_filter_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"rxclaims.reduced\",\n    \"join-cond\": \"in1.claim_nbr = CAST(in0.agp2nb AS DECIMAL(17,0)) AND in1.claim_seq_nbr = CAST(CASE WHEN (CAST(in0.ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(in0.ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(in0.ags6nb AS DECIMAL(5,0))) END AS BOOLEAN) AND in1.claim_stat_id = in0.agzsst AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT)\",\n    \"val-cols\": [\n      \"CASE WHEN ((in1.claim_nbr IS NULL) AND ((in1.claim_seq_nbr IS NULL) AND ((in1.claim_stat_id IS NULL) AND (in1.src_env_sk IS NULL)))) THEN false ELSE true END AS F_claim_reduced_lkp_match0\"\n    ]\n  }\n]",
  "pipeline_name": "orx_f_claim_mic_detail",
  "primary_key": "claim_nbr,claim_seq_nbr,claim_stat_id,claim_mic_seq_no,src_env_sk",
  "reformat_rules": "{\n  \"drug_rx_otc_ind_sk\": \"in1_drug_rx_otc_ind_sk\",\n  \"orig_carrier_sk\": \"CAST(orig_carrier_sk0 AS DECIMAL(38,0))\",\n  \"extd_awp_cost\": \"CAST((CAST(agikhx AS DECIMAL(15,5)) * CAST(agsan2 AS DECIMAL(13,3))) AS DECIMAL(38,5))\",\n  \"sbm_mnth\": \"CAST(date_format(to_date(sbm_dt0, 'yyyyMMdd'), 'MM') AS DECIMAL(38,0))\",\n  \"cag_sk\": \"CAST(cag_sk0 AS DECIMAL(38,0))\",\n  \"injectable_ind_sk\": \"CAST(injectable_ind_sk0 AS DECIMAL(38,0))\",\n  \"orig_carrier_id\": \"orig_carrier_id0\",\n  \"claim_stat_id\": \"claim_stat_id0\",\n  \"dea_cd_sk\": \"in1_dea_cd_sk\",\n  \"sbm_dispensing_fee\": \"sbm_dispensing_fee0\",\n  \"sbm_cmp_ingred_cost_amt\": \"aguip1\",\n  \"cmd_ingred_mod_cd_cnt\": \"CAST(agdzpp AS DECIMAL(38,0))\",\n  \"carrier_acct_sk\": \"CAST(carrier_acct_sk0 AS DECIMAL(38,0))\",\n  \"tc4_drg_cov_stat_cd\": \"ago6h9\",\n  \"claim_nbr_encrp\": \"CAST(CASE WHEN (claim_nbr0 > 0) THEN CAST(concat(substring(CAST(claim_nbr0 AS STRING), 1, 2), ff3_encrypt_idwdata(CAST(CAST(claim_nbr0 AS STRING) AS STRING))) AS STRING) ELSE CAST(concat(substring(CAST(claim_nbr0 AS STRING), 1, 3), ff3_encrypt_idwdata(CAST(CASE WHEN (abs(CAST(claim_nbr0 AS STRING)) IS NULL) THEN '0' ELSE CASE WHEN (regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1) = '') THEN '0' ELSE CASE WHEN (instr(substring(abs(CAST(claim_nbr0 AS STRING)), 0, instr_udf(CAST(abs(CAST(claim_nbr0 AS STRING)) AS STRING), regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1))), '-') > 0) THEN concat('-', regexp_replace(regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1), '\\\\\\\\s+', '', 1)) ELSE regexp_replace(regexp_extract(abs(CAST(claim_nbr0 AS STRING)), '([1-9][0-9]*(\\\\\\\\.)[0-9 ]+|[1-9][0-9 ]+|[1-9]+|(0\\\\\\\\.)[0-9 ]*[0-9])', 1), '\\\\\\\\s+', '', 1) END END END AS STRING))) AS STRING) END AS DECIMAL(38,0))\",\n  \"drg_3rd_prty_excpn_ind\": \"agd3px\",\n  \"sbm_yr\": \"CAST(date_format(to_date(sbm_dt0, 'yyyyMMdd'), 'yyyy') AS DECIMAL(38,0))\",\n  \"prod_short_desc\": \"agcnt3\",\n  \"orig_mbr_sk\": \"CAST(orig_mbr_sk0 AS DECIMAL(38,0))\",\n  \"cmd_app_cost_type_unit_cost\": \"agiohx\",\n  \"prod_kdc\": \"CAST(agciv1 AS DECIMAL(38,0))\",\n  \"prod_nm\": \"agcot3\",\n  \"claim_nbr\": \"CAST(claim_nbr0 AS DECIMAL(38,0))\",\n  \"claim_stat_sk\": \"CAST(claim_stat_sk0 AS DECIMAL(38,0))\",\n  \"rbl_drg_cost_pct\": \"age7hv\",\n  \"cmd_app_cost_src_cd\": \"agi8h7\",\n  \"cmd_cal_prof_svc_fee\": \"agj7hy\",\n  \"cmd_ingred_anda_ovrd_flg\": \"aghyai\",\n  \"sec_flg\": \"0\",\n  \"admin_rte_sk\": \"in1_admin_rte_sk\",\n  \"brand_generic_cd\": \"agpfc3\",\n  \"drg_qty\": \"drg_qty0\",\n  \"awp_unit_cost\": \"awp_unit_cost0\",\n  \"cmp_prod_key\": \"CAST(agr9n2 AS DECIMAL(38,0))\",\n  \"sbm_cmp_basis_of_cost_cd\": \"agi6cj\",\n  \"claim_seq_nbr\": \"CAST(claim_seq_nbr0 AS DECIMAL(38,0))\",\n  \"orig_cag_sk\": \"CAST(orig_cag_sk0 AS DECIMAL(38,0))\",\n  \"cmd_ingred_mod_cd1\": \"agsthk\",\n  \"prod_sk\": \"in1_prod_sk\",\n  \"final_pln_sk\": \"CAST(final_pln_sk0 AS DECIMAL(38,0))\",\n  \"mbr_sk\": \"CAST(mbr_sk0 AS DECIMAL(38,0))\",\n  \"cmd_clt_cost_type_cd\": \"agqkhb\",\n  \"sbm_cmp_prod_id_qlfr_cd\": \"agi5cj\",\n  \"gnrc_mdspn_ind_sk\": \"in1_gnrc_mdspn_ind_sk\",\n  \"prod_reim_ind\": \"agpdc3\",\n  \"app_patient_pay_amt\": \"app_patient_pay_amt0\",\n  \"sbm_dt\": \"sbm_dt0\",\n  \"sbm_ingred_cost_paid\": \"sbm_ingred_cost_paid0\",\n  \"sbm_cmp_prod_id\": \"agr9c4\",\n  \"cmd_ingred_mod_cd2\": \"agsuhk\",\n  \"cmd_app_ingred_cost_amt\": \"agimhx\",\n  \"rx_written_dt\": \"rx_written_dt0\",\n  \"app_due_amt\": \"app_due_amt0\",\n  \"drg_mfr_id\": \"agdlcd\",\n  \"cmd_ingred_anda_flg\": \"aghxai\",\n  \"carrier_sk\": \"CAST(carrier_sk0 AS DECIMAL(38,0))\",\n  \"gnrc_ind_sk\": \"in1_gnrc_ind_sk\",\n  \"rx_nbr_encrp\": \"ff3_encrypt_idwdata(CAST(rx_nbr0 AS STRING))\",\n  \"injectable_ind\": \"injectable_ind0\",\n  \"filled_dt\": \"filled_dt0\",\n  \"drg_strngth_uom_cd\": \"agtat3\",\n  \"gcn_seq_no\": \"CAST(agxsn1 AS DECIMAL(38,0))\",\n  \"cmd_ingred_bla_flg\": \"aghvai\",\n  \"eci_ms_ind\": \"agqlia\",\n  \"dmr_ind_sk\": \"CAST(dmr_ind_sk0 AS DECIMAL(38,0))\",\n  \"drg_mfr_nm\": \"agdgcd\",\n  \"cmd_clt_cost_src_cd\": \"agi9h7\",\n  \"filled_dt_sk\": \"CAST(filled_dt_sk0 AS DECIMAL(38,0))\",\n  \"drg_desc_id\": \"CAST(agh6t2 AS DECIMAL(38,0))\",\n  \"dsg_frm_sk\": \"in1_dsg_frm_sk\",\n  \"pbr_sk\": \"CAST(pbr_sk0 AS DECIMAL(38,0))\",\n  \"claim_mic_seq_no\": \"CAST(agr7n2 AS DECIMAL(38,0))\",\n  \"ahfs_cd_sk\": \"in1_ahfs_cd_sk\",\n  \"gcn_no\": \"CAST(agxrn1 AS DECIMAL(38,0))\",\n  \"drg_fda_thrpc_eqvlc_cd\": \"agdkcd\",\n  \"cmd_clt_prof_svc_fee\": \"agj9hy\",\n  \"sbm_due_amt\": \"sbm_due_amt0\",\n  \"cmd_ing_dru_cov_sts\": \"aghsai\",\n  \"gpi_sk\": \"in1_gpi_sk\",\n  \"claim_seq_nbr_src\": \"CAST(claim_seq_nbr_src0 AS DECIMAL(38,0))\",\n  \"compound_sk\": \"CAST(compound_sk0 AS DECIMAL(38,0))\",\n  \"cmd_ingred_mod_cd3\": \"agsvhk\",\n  \"sbm_cmp_ingred_qty\": \"agsan2\",\n  \"sbm_patient_pay_amt\": \"sbm_patient_pay_amt0\",\n  \"drg_strngth_qty\": \"agagqt\",\n  \"cmd_app_prof_svc_fee\": \"agj8hy\",\n  \"cmd_ingred_bla_ovrd_flg\": \"aghwai\",\n  \"clt_dispensing_fee\": \"clt_dispensing_fee0\",\n  \"phr_sk\": \"CAST(phr_sk0 AS DECIMAL(38,0))\",\n  \"sbm_dt_sk\": \"CAST(sbm_dt_sk0 AS DECIMAL(38,0))\",\n  \"drug_sk\": \"in1_drug_sk\",\n  \"drg_gnrc_nm\": \"agxktx\",\n  \"refill_nbr\": \"refill_nbr0\",\n  \"orig_employer_group_id\": \"orig_employer_group_id0\",\n  \"drug_maint_cd_sk\": \"in1_drug_maint_cd_sk\",\n  \"cmd_exp_ingred_flg\": \"aghzai\",\n  \"cmd_ingred_nda_flg\": \"aghtai\",\n  \"eci_px_ind\": \"agqkia\",\n  \"drg_unit_dose_use_ind\": \"agdudu\",\n  \"cmd_clt_ingred_cost_amt\": \"aginhx\",\n  \"cmd_awp_unit_cost\": \"agikhx\",\n  \"ingred_stat_cd\": \"agjah7\",\n  \"phr_drg_cost_pct\": \"age6hv\",\n  \"days_of_supply\": \"CAST(days_sply0 AS DECIMAL(38,0))\",\n  \"orig_account_id\": \"orig_account_id0\",\n  \"refill_max\": \"CAST(refill_max0 AS DECIMAL(38,0))\",\n  \"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"orig_member_id\": \"orig_member_id0\",\n  \"cmd_app_cost_type_cd\": \"agqjhb\",\n  \"cmd_cal_ingred_cost_amt\": \"agilhx\",\n  \"eci_rm_ind\": \"agqjia\",\n  \"cmd_ingred_nda_ovrd_flg\": \"aghuai\",\n  \"clt_ingred_cost_paid\": \"clt_ingred_cost_paid0\",\n  \"rx_nbr\": \"rx_nbr0\",\n  \"cmd_clt_cost_type_unit_cost\": \"agiphx\",\n  \"days_of_supply_sk\": \"CAST(days_of_supply_sk0 AS DECIMAL(38,0))\",\n  \"agmdcd\": \"agmdcd\",\n  \"agozs3\": \"agozs3\",\n  \"agqihb\": \"agqihb\",\n  \"agi5cj\": \"agi5cj\",\n  \"agddea\": \"agddea\",\n  \"agzxst\": \"agzxst\",\n  \"agebc4\": \"agebc4\",\n  \"agdicd\": \"agdicd\",\n  \"agdrxo\": \"agdrxo\",\n  \"ags6nb\": \"ags6nb\",\n  \"agp2nb\": \"agp2nb\",\n  \"agr9c4\": \"agr9c4\",\n  \"agdhcd\": \"agdhcd\",\n  \"agzsst\": \"agzsst\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_admin_route\",\n    \"join-cond\": \"in1.admin_rte_id = in0.agdicd\",\n    \"val-cols\": [\n      \"in1.admin_rte_sk as in1_admin_rte_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_ahfs\",\n    \"join-cond\": \"in1.ahfs_cd = in0.agebc4\",\n    \"val-cols\": [\n      \"in1.ahfs_cd_sk as in1_ahfs_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_dea\",\n    \"join-cond\": \"in1.dea_cd = in0.agddea\",\n    \"val-cols\": [\n      \"in1.dea_cd_sk as in1_dea_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_drug\",\n    \"join-cond\": \"in1.drg_nm_extn_id = substring(in0.agqihb, 0, 10)\",\n    \"val-cols\": [\n      \"in1.drug_sk as in1_drug_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_drug_maintenance\",\n    \"join-cond\": \"in1.drug_maint_cd = in0.agmdcd\",\n    \"val-cols\": [\n      \"in1.drug_maint_cd_sk as in1_drug_maint_cd_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_drug_otc_indicator\",\n    \"join-cond\": \"in1.drug_rx_otc_ind = in0.agdrxo\",\n    \"val-cols\": [\n      \"in1.drug_rx_otc_ind_sk as in1_drug_rx_otc_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_dosage_form\",\n    \"join-cond\": \"in1.dsg_frm_id = in0.agdhcd\",\n    \"val-cols\": [\n      \"in1.dsg_frm_sk as in1_dsg_frm_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_generic_medispan_indicator\",\n    \"join-cond\": \"in1.gnrc_mdspn_ind = in0.agzxst\",\n    \"val-cols\": [\n      \"in1.gnrc_ind_sk as in1_gnrc_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.l_generic_medispan_indicator\",\n    \"join-cond\": \"in1.gnrc_mdspn_ind = in0.agozs3\",\n    \"val-cols\": [\n      \"in1.gnrc_mdspn_ind_sk as in1_gnrc_mdspn_ind_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_gpi\",\n    \"join-cond\": \"in1.gpi_id = in0.agqihb\",\n    \"val-cols\": [\n      \"in1.gpi_sk as in1_gpi_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_product\",\n    \"join-cond\": \"in1.prod_id = in0.agr9c4 AND in1.prod_id_qlfr_cd = in0.agi5cj\",\n    \"val-cols\": [\n      \"in1.prod_sk as in1_prod_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"csv\",\n    \"src\": \"rxclaim_orx.rcecip\",\n    \"join-cond\": \"in1.claim_nbr = CAST(in0.agp2nb AS DECIMAL(17,0)) AND in1.claim_seq_nbr = CASE WHEN (CAST(in0.ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(in0.ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(in0.ags6nb AS DECIMAL(5,0))) END AND in1.claim_stat_id = in0.agzsst AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT)\",\n    \"val-cols\": [\n      \"in1.claim_nbr AS claim_nbr0\",\n      \"in1.claim_seq_nbr AS claim_seq_nbr0\",\n      \"in1.claim_stat_id AS claim_stat_id0\",\n      \"in1.claim_stat_sk AS claim_stat_sk0\",\n      \"in1.carrier_sk AS carrier_sk0\",\n      \"in1.carrier_acct_sk AS carrier_acct_sk0\",\n      \"in1.cag_sk AS cag_sk0\",\n      \"in1.mbr_sk AS mbr_sk0\",\n      \"in1.final_pln_sk AS final_pln_sk0\",\n      \"in1.phr_sk AS phr_sk0\",\n      \"in1.pbr_sk AS pbr_sk0\",\n      \"in1.compound_sk AS compound_sk0\",\n      \"in1.orig_carrier_sk AS orig_carrier_sk0\",\n      \"in1.orig_mbr_sk AS orig_mbr_sk0\",\n      \"in1.orig_cag_sk AS orig_cag_sk0\",\n      \"in1.orig_carrier_id AS orig_carrier_id0\",\n      \"in1.orig_account_id AS orig_account_id0\",\n      \"in1.orig_employer_group_id AS orig_employer_group_id0\",\n      \"in1.orig_member_id AS orig_member_id0\",\n      \"in1.claim_seq_nbr_src AS claim_seq_nbr_src0\",\n      \"in1.sbm_dt_sk AS sbm_dt_sk0\",\n      \"in1.sbm_dt AS sbm_dt0\",\n      \"in1.filled_dt_sk AS filled_dt_sk0\",\n      \"in1.filled_dt AS filled_dt0\",\n      \"in1.rx_written_dt AS rx_written_dt0\",\n      \"in1.rx_nbr AS rx_nbr0\",\n      \"in1.refill_nbr AS refill_nbr0\",\n      \"in1.drg_qty AS drg_qty0\",\n      \"in1.awp_unit_cost AS awp_unit_cost0\",\n      \"in1.refill_max AS refill_max0\",\n      \"in1.days_sply AS days_sply0\",\n      \"in1.days_of_supply_sk AS days_of_supply_sk0\",\n      \"in1.dmr_ind_sk AS dmr_ind_sk0\",\n      \"in1.injectable_ind_sk AS injectable_ind_sk0\",\n      \"in1.injectable_ind AS injectable_ind0\",\n      \"in1.app_patient_pay_amt AS app_patient_pay_amt0\",\n      \"in1.app_due_amt AS app_due_amt0\",\n      \"in1.clt_ingred_cost_paid AS clt_ingred_cost_paid0\",\n      \"in1.clt_dispensing_fee AS clt_dispensing_fee0\",\n      \"in1.sbm_ingred_cost_paid AS sbm_ingred_cost_paid0\",\n      \"in1.sbm_dispensing_fee AS sbm_dispensing_fee0\",\n      \"in1.sbm_patient_pay_amt AS sbm_patient_pay_amt0\",\n      \"in1.sbm_due_amt AS sbm_due_amt0\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "f_claim_mic_detail",
  "read_incremental_files_flag": "false",
  "sk_service_self_join": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"l_admin_route\",\n    \"sk-col\": \"admin_rte_sk\",\n    \"nk-col\": [\n      \"agdicd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_ahfs\",\n    \"sk-col\": \"ahfs_cd_sk\",\n    \"nk-col\": [\n      \"agebc4\"\n    ]\n  },\n  {\n    \"table-name\": \"l_dea\",\n    \"sk-col\": \"dea_cd_sk\",\n    \"nk-col\": [\n      \"agddea\"\n    ]\n  },\n  {\n    \"table-name\": \"d_drug\",\n    \"sk-col\": \"drug_sk\",\n    \"nk-col\": [\n      \"substring(agqihb, 0, 10)\"\n    ]\n  },\n  {\n    \"table-name\": \"l_drug_maintenance\",\n    \"sk-col\": \"drug_maint_cd_sk\",\n    \"nk-col\": [\n      \"agmdcd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_drug_otc_indicator\",\n    \"sk-col\": \"drug_rx_otc_ind_sk\",\n    \"nk-col\": [\n      \"agdrxo\"\n    ]\n  },\n  {\n    \"table-name\": \"l_dosage_form\",\n    \"sk-col\": \"dsg_frm_sk\",\n    \"nk-col\": [\n      \"agdhcd\"\n    ]\n  },\n  {\n    \"table-name\": \"l_generic_medispan_indicator\",\n    \"sk-col\": \"gnrc_ind_sk\",\n    \"nk-col\": [\n      \"agzxst\"\n    ]\n  },\n  {\n    \"table-name\": \"l_generic_medispan_indicator\",\n    \"sk-col\": \"gnrc_mdspn_ind_sk\",\n    \"nk-col\": [\n      \"agozs3\"\n    ]\n  },\n  {\n    \"table-name\": \"d_gpi\",\n    \"sk-col\": \"gpi_sk\",\n    \"nk-col\": [\n      \"agqihb\"\n    ]\n  },\n  {\n    \"table-name\": \"d_product\",\n    \"sk-col\": \"prod_sk\",\n    \"nk-col\": [\n      \"agr9c4\",\n      \"agi5cj\"\n    ]\n  },\n  {\n    \"table-name\": \"rcecip\",\n    \"sk-col\": \"claim_nbr\",\n    \"nk-col\": [\n      \"CAST(agp2nb AS DECIMAL(17,0))\",\n      \"CASE WHEN (CAST(ags6nb AS DECIMAL(5,0)) < 0) THEN CAST(ags6nb AS DECIMAL(5,0)) ELSE (1000 - CAST(ags6nb AS DECIMAL(5,0))) END\",\n      \"agzsst\",\n      \"CAST(dxf_src_sys_id AS INT)\",\n      \"src_env_sk\"\n    ]\n  }\n]"
}


-----------------orx_l_formulary_client_xref-------------------
{
  "final_table_schema": "{\"client_xref_sk\": \"long\", \"client_id\": \"string\", \"client_desc\": \"string\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "pipeline_name": "orx_l_formulary_client_xref",
  "primary_key": "client_id",
  "reformat_rules": "{\n  \"client_id\" : \"client_id\",\n  \"src_env_sk\" : \"CAST(CASE WHEN (table_schem = 'USRCLMXRF') THEN 480 ELSE 490 END AS DECIMAL(38,0))\",\n  \"client_desc\" : \"'-'\",\n  \"client_xref_sk\" : \"-1\"\n}",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "l_formulary_client_xref",
  "sk_service_col": "client_xref_sk",
  "read_incremental_files_flag": "false"
}
-----------------ctrx_l_formulary_client_xref-------------------
{
  "final_table_schema": "{\"client_xref_sk\": \"long\", \"client_id\": \"string\", \"client_desc\": \"string\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "pipeline_name": "l_formulary_client_xref",
  "primary_key": "client_id",
  "reformat_rules": "{\n  \"client_id\" : \"client_id\",\n  \"src_env_sk\" : \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"client_desc\" : \"'-'\",\n  \"client_xref_sk\" : \"-1\"\n}",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "l_formulary_client_xref",
  "sk_service_col": "client_xref_sk"
}
-----------------d_reporting_client_map-------------------
{
  "final_table_schema": "{\"rptg_clt_id\": \"int\", \"rptg_clt_nm\": \"string\", \"cag_sk\": \"long\", \"carrier_id\": \"string\", \"account_id\": \"string\", \"employer_group_id\": \"string\", \"eff_dt\": \"date\", \"bk_of_bsns\": \"string\", \"mbr_dtl_flg\": \"string\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "optional_filter_rules": "CAST(CASE WHEN (account_id = '*') THEN 1 WHEN ((account_id = cag_account_id) AND (employer_group_id = '*')) THEN 1 WHEN ((account_id = cag_account_id) AND (employer_group_id = cag_employer_group_id)) THEN 1 ELSE 0 END AS BOOLEAN)",
  "pipeline_name": "d_reporting_client_map",
  "primary_key": "rptg_clt_id,carrier_id,account_id,employer_group_id",
  "reformat_rules": "{\n  \"eff_dt\": \"date_format(to_date(effective_date, 'MM/dd/yyyy'), 'yyyyMMdd')\",\n  \"cag_sk\": \"CAST(cag_sk AS DECIMAL(38,0))\",\n  \"bk_of_bsns\": \"bk_of_busines\",\n  \"account_id\": \"cag_account_id\",\n  \"rptg_clt_nm\": \"client_name\",\n  \"mbr_dtl_flg\": \"mbr_dtl_flg\",\n  \"carrier_id\": \"cag_carrier_id\",\n  \"employer_group_id\": \"cag_employer_group_id\",\n  \"rptg_clt_id\": \"CAST(dxf_sk0 AS DECIMAL(38,0))\",\n  \"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"client_name\": \"client_name\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"csv\",\n    \"src\": \"rxclaim.d_reporting_client_map_enrich\",\n    \"join-cond\": \"in1.rptg_clt_nm = in0.client_name\",\n    \"val-cols\": [\n      \"in1.dxf_sk AS dxf_sk0\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "d_reporting_client_map",
  "sk_service_col": "rptg_clt_id",
  "read_incremental_files_flag": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"d_reporting_client_map_enrich\",\n    \"sk-col\": \"dxf_sk\",\n    \"nk-col\": [\n      \"client_name\"\n    ]\n  }\n]"
}
----------------f_mpd_monthly_mbrship_detail-------------------
{
  "default_source_blank_nulls": "carrier, account, group",
  "final_table_schema": "{\"carrier_id\": \"string\", \"account_id\": \"string\", \"employer_group_id\": \"string\", \"mbr_id\": \"string\", \"cag_sk\": \"long\", \"mbr_sk\": \"long\", \"client_nm\": \"string\", \"mbr_fname\": \"string\", \"mbr_lname\": \"string\", \"birth_dt\": \"date\", \"hicn\": \"string\", \"mbi\": \"string\", \"adj_start_dt\": \"date\", \"adj_end_dt\": \"date\", \"mmr_mnth\": \"int\", \"direct_subsidy_amt\": \"decimal(9, 2)\", \"lips_amt\": \"decimal(9, 2)\", \"lics_amt\": \"decimal(9, 2)\", \"reinsurance_amt\": \"decimal(9, 2)\", \"total_amt\": \"decimal(9, 2)\", \"payment_mnth_flg\": \"string\", \"repeat_cnt\": \"string\", \"pk\": \"long\", \"risk_factor\": \"decimal(13, 5)\", \"cms_reason_cd\": \"string\", \"claim_cntr\": \"int\", \"rsp_due_amt\": \"decimal(15, 2)\", \"src_env_sk\": \"long\", \"rec_stat_cd\": \"short\", \"run_id\": \"long\", \"update_uid\": \"string\", \"update_ts\": \"timestamp\", \"insert_uid\": \"string\", \"insert_ts\": \"timestamp\"}",
  "pipeline_name": "f_mpd_monthly_mbrship_detail",
  "primary_key": "client_nm,carrier_id,account_id,employer_group_id,mbr_id,mbr_fname,mbr_lname,birth_dt,hicn,mbi,adj_start_dt,adj_end_dt,mmr_mnth,direct_subsidy_amt,lips_amt,lics_amt,reinsurance_amt,total_amt,payment_mnth_flg,repeat_cnt,pk,risk_factor,cms_reason_cd",
  "reformat_rules": "{\n  \"repeat_cnt\": \"repeat_count\",\n  \"risk_factor\": \"risk_factor\",\n  \"cag_sk\": \"in1_cag_sk\",\n  \"adj_start_dt\": \"adj_start_dt\",\n  \"adj_end_dt\": \"adj_end_dt\",\n  \"mbr_id\": \"member_id\",\n  \"lics_amt\": \"lics_am\",\n  \"rsp_due_amt\": \"0\",\n  \"payment_mnth_flg\": \"payment_month_flag\",\n  \"mmr_mnth\": \"CAST(date_format(to_date(regexp_replace(regexp_replace(regexp_replace(dxf_src_file_name, '.*[/]', '', 1), '.xlsx', '', 1), '.*[_]', '', 1), 'yyyyMMdd'), 'yyyyMM') AS DECIMAL(38,0))\",\n  \"reinsurance_amt\": \"reinsurance_am\",\n  \"direct_subsidy_amt\": \"direct_subsidy_am\",\n  \"mbi\": \"'-'\",\n  \"mbr_sk\": \"in1_mbr_sk\",\n  \"total_amt\": \"total_am\",\n  \"lips_amt\": \"lips_am\",\n  \"birth_dt\": \"birth_dt\",\n  \"pk\": \"CAST(pk AS DECIMAL(38,0))\",\n  \"account_id\": \"account\",\n  \"hicn\": \"hicn\",\n  \"mbr_lname\": \"last_name\",\n  \"client_nm\": \"client_name\",\n  \"carrier_id\": \"carrier\",\n  \"cms_reason_cd\": \"adj_reason_cd\",\n  \"employer_group_id\": \"group\",\n  \"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"claim_cntr\": \"0\",\n  \"mbr_fname\": \"first_name\",\n  \"carrier\": \"carrier\",\n  \"account\": \"account\",\n  \"member_id\": \"member_id\",\n  \"group\": \"group\"\n}",
  "reformat_rules_join": "joins = [\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_cag\",\n    \"join-cond\": \"in1.carrier_id = in0.carrier AND in1.account_id = in0.account AND in1.employer_group_id = in0.group\",\n    \"val-cols\": [\n      \"in1.cag_sk as in1_cag_sk\"\n    ]\n  },\n  {\n    \"fmt\": \"table\",\n    \"src\": \"orx_idw_dm_prd.d_member\",\n    \"join-cond\": \"in1.carrier_id = in0.carrier AND in1.account_id = in0.account AND in1.employer_group_id = in0.group AND in1.mbr_id = in0.member_id\",\n    \"val-cols\": [\n      \"in1.mbr_sk as in1_mbr_sk\"\n    ]\n  }\n]",
  "source_path": "srcs = [{\n    \"fmt\" : \"query\",\n    \"src\" : \"\"\n}]",
  "source_table": "",
  "target_table": "f_mpd_monthly_mbrship_detail",
  "encrypt_cols": "mbr_fname,mbr_lname,hicn,mbi",
  "encrypt_scope": "idwshared-dbscope",
  "read_incremental_files_flag": "false",
  "sk_service_self_join": "false",
  "optional_sk_config": "sks=[\n  {\n    \"table-name\": \"d_cag\",\n    \"sk-col\": \"cag_sk\",\n    \"nk-col\": [\n      \"carrier\",\n      \"account\",\n      \"group\"\n    ]\n  },\n  {\n    \"table-name\": \"d_member\",\n    \"sk-col\": \"mbr_sk\",\n    \"nk-col\": [\n      \"carrier\",\n      \"account\",\n      \"group\",\n      \"member_id\"\n    ]\n  }\n]"
}
---------
{
    "final_table_schema" : "{\"mmr_sum_sk\": \"long\",\n\"carrier_id\": \"string\",\n\"adj_start_dt\": \"date\",\n\"adj_end_dt\": \"date\",\n\"mmr_mnth\": \"int\",\n\"education_fee_amt\": \"decimal(14, 2)\",\n\"cob\": \"decimal(14, 2)\",\n\"sequest_adj_amt\": \"decimal(14, 2)\",\n\"late_penalty_amt\": \"decimal(14, 2)\",\n\"total_amt\": \"decimal(14, 2)\",\n\"src_env_sk\": \"long\",\n\"rec_stat_cd\": \"short\",\n\"run_id\": \"long\",\n\"update_uid\": \"string\",\n\"update_ts\": \"timestamp\",\n\"insert_uid\": \"string\",\n\"insert_ts\": \"timestamp\"}",
    "length_rules" : "CASE WHEN (length(carrier_id) > 10) THEN 'carrier_id' WHEN (length(adj_start_dt) > 8) THEN 'adj_start_dt' WHEN (length(adj_end_dt) > 8) THEN 'adj_end_dt' WHEN (length(education_fee_amt) > 15) THEN 'education_fee_amt' WHEN (length(cob) > 15) THEN 'cob' WHEN (length(sequest_adj_amt) > 15) THEN 'sequest_adj_amt' WHEN (length(late_penalty_amt) > 15) THEN 'late_penalty_amt' WHEN (length(total_amt) > 15) THEN 'total_amt'  ELSE 'pass' END",
    "pipeline_name" : "a_mpd_monthly_mbrship_summary",
    "primary_key" : "",
    "reformat_rules" : "{\n  \"adj_start_dt\" : \"adj_start_dt\",\n  \"adj_end_dt\" : \"adj_end_dt\",\n  \"education_fee_amt\" : \"education\",\n  \"mmr_sum_sk\" : \"-1\",\n  \"mmr_mnth\" : \"CAST(substring(adj_start_dt, 0, 6) AS DECIMAL(38,0))\",\n  \"cob\" : \"cob\",\n  \"total_amt\" : \"total\",\n  \"carrier_id\" : \"carrier\",\n  \"src_env_sk\" : \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"sequest_adj_amt\" : \"sequestration_adj\",\n  \"late_penalty_amt\" : \"net_late_enrollment_penalty_amount\"\n}",
    "source_path" : "srcs = [{\n    \"fmt\" : \"parquet\",\n    \"src\" : \"dbfs:/PATH/*\"\n}]",
    "source_table" : "",
    "target_table" : ""
}
-------
{
    "default_source_blank_nulls" : "asaacd, asaccd, asadcd",
    "final_table_schema" : "{\"drop_record\": \"double\",\n\"cms_pharmacy_cost_sk\": \"double\",\n\"cms_drug_pricing_file_sk\": \"double\",\n\"cms_stars_calendar_submission_sk\": \"double\",\n\"cms_proxy_ndc_rxcui_sk\": \"double\",\n\"prod_sk\": \"double\",\n\"cag_sk\": \"double\",\n\"mbr_sk\": \"double\",\n\"pde_claim_nbr\": \"double\",\n\"pde_claim_seq_nbr_src\": \"double\",\n\"pde_claim_stat_id\": \"string\",\n\"pde_contract_id\": \"string\",\n\"pde_pbp_id\": \"string\",\n\"pde_carrier_id\": \"string\",\n\"pde_final_pln_cd\": \"string\",\n\"pde_proxy_prod_id\": \"string\",\n\"pde_proxy_ndc_label_nm\": \"string\",\n\"pde_prod_id\": \"string\",\n\"pde_ndc_label_nm\": \"string\",\n\"pde_brand_generic_cd\": \"string\",\n\"pde_phr_id\": \"string\",\n\"pde_phr_npi_id\": \"string\",\n\"pde_phr_svc_typ\": \"string\",\n\"pde_residence_cd\": \"string\",\n\"pde_residence_cd_desc\": \"string\",\n\"pde_filled_dt\": \"string\",\n\"pde_file_sbm_ts\": \"string\",\n\"pde_file_proc_ts\": \"string\",\n\"pde_drg_qty\": \"double\",\n\"pde_days_of_supply\": \"double\",\n\"mpf_days_of_supply\": \"double\",\n\"pde_ndc_cost\": \"double\",\n\"pde_ndc_unit_cost\": \"double\",\n\"mpf_ndc_unit_cost\": \"double\",\n\"pde_dispensing_fee\": \"double\",\n\"phr_cost_type\": \"string\",\n\"cur_claim_stat_id\": \"string\",\n\"pl_of_svc_submd\": \"string\",\n\"cms_stat_id\": \"string\",\n\"pde_ndc_uom\": \"string\",\n\"proxy_ndc_uom\": \"string\",\n\"pde_ndc_inactive_dt\": \"string\",\n\"pde_ndc_obsolete_dt\": \"string\",\n\"pde_adj_del_cd\": \"string\",\n\"price_id\": \"string\",\n\"mpf_dispensing_fee\": \"double\",\n\"tot_pde_drug_cost\": \"double\",\n\"tot_mpf_drug_cost\": \"double\",\n\"tot_est_pde_cost\": \"double\",\n\"tot_est_mpf_cost\": \"double\",\n\"tot_est_discrepancy\": \"double\",\n\"cms_segment_id\": \"string\",\n\"cal_start_dt\": \"string\",\n\"cal_end_dt\": \"string\",\n\"pricing_file_mail_flg\": \"string\",\n\"preferred_status_mail_flg\": \"string\",\n\"phr_retail_flg\": \"string\",\n\"phr_mail_flg\": \"string\",\n\"phr_la_drugs_flg\": \"string\",\n\"phr_hi_flg\": \"string\",\n\"phr_ltc_flg\": \"string\",\n\"preferred_status_retail_flg\": \"string\",\n\"prod_directory_dt\": \"string\",\n\"claim_phr_sk\": \"double\",\n\"pde_record_id\": \"string\",\n\"pde_gpi_id\": \"string\",\n\"floor_price\": \"double\",\n\"pde_file_id\": \"string\",\n\"pde_medicare_id\": \"string\",\n\"pde_paid_dt\": \"string\",\n\"pde_refill_nbr\": \"string\",\n\"pde_dispns_stat\": \"string\",\n\"pde_compound_cd\": \"string\",\n\"pde_pbr_id\": \"string\",\n\"pde_drg_cvg_cd\": \"string\",\n\"pde_non_stnd_cd\": \"string\",\n\"price_exceptn_cd\": \"string\",\n\"catast_cvg_cd\": \"string\",\n\"pde_gdcb_amt\": \"double\",\n\"pde_gdca_amt\": \"double\",\n\"pde_pat_pay_amt\": \"double\",\n\"pde_othr_troop_amt\": \"double\",\n\"pde_lics_amt\": \"double\",\n\"pde_plro_amt\": \"double\",\n\"pde_cpp_amt\": \"double\",\n\"pde_npp_amt\": \"double\",\n\"pde_est_rbt_amt\": \"double\",\n\"pde_vaccn_fee\": \"double\",\n\"pde_rx_org_cd\": \"string\",\n\"pde_tot_drg_grs_cost\": \"double\",\n\"pde_true_troop_accom\": \"double\",\n\"pde_ben_phs_begn\": \"string\",\n\"pde_ben_phs_end\": \"string\",\n\"pde_gap_discnt_amt\": \"double\",\n\"pde_drug_tier\": \"string\",\n\"pde_adj_rsn_cd\": \"string\",\n\"cms_cal_gap_dscnt_amt\": \"double\",\n\"pde_edit_cnt\": \"double\",\n\"pde_edit_cd_1\": \"string\",\n\"pde_edit_cd_2\": \"string\",\n\"pde_edit_cd_3\": \"string\",\n\"pde_edit_cd_4\": \"string\",\n\"pde_edit_cd_5\": \"string\",\n\"pde_edit_cd_6\": \"string\",\n\"pde_edit_cd_7\": \"string\",\n\"pde_edit_cd_8\": \"string\",\n\"pde_edit_cd_9\": \"string\",\n\"pde_edit_cd_10\": \"string\",\n\"pde_mbr_id\": \"string\",\n\"pde_account_id\": \"string\",\n\"pde_group_id\": \"string\",\n\"pde_resbm_cms_type\": \"string\",\n\"pde_clm_rcvd_dt\": \"string\",\n\"final_pln_eff_dt\": \"string\",\n\"pbp_of_record\": \"string\",\n\"alt_srv_provider_qual\": \"string\",\n\"alt_srv_provider_id\": \"string\",\n\"orig_sbm_contract_id\": \"string\",\n\"contract_of_record\": \"string\",\n\"sales_tax\": \"double\",\n\"adj_begin_ts\": \"string\",\n\"pde_formulary_cd\": \"string\",\n\"gap_discnt_pln_ovcd\": \"string\",\n\"trans_rpt_sts_uid\": \"string\",\n\"pde_resbm_uid\": \"string\",\n\"pde_reproces_uid\": \"string\",\n\"mdd_seq_nbr\": \"double\",\n\"pde_exclution_rsn_cd\": \"string\",\n\"sbm_prescriber_qual\": \"string\",\n\"sbm_prod_select_cd\": \"string\",\n\"sbm_clarification_cd\": \"string\",\n\"pde_resubmission_stat\": \"string\",\n\"pde_reproc_file_id\": \"string\",\n\"pde_reproc_sbmtr_id\": \"string\",\n\"sbm_srv_provider_qual\": \"string\",\n\"corrected_medicare_id\": \"string\",\n\"sbm_rx_nbr\": \"string\",\n\"pde_trans_rpt_sts_ts\": \"string\",\n\"pde_resbm_sts_ts\": \"string\",\n\"pde_reproc_ts\": \"string\",\n\"pde_adj_rsn_cd_qual\": \"string\",\n\"pde_sbmtr_id\": \"string\",\n\"pde_file_from_dt\": \"string\",\n\"pde_file_thru_dt\": \"string\",\n\"pde_file_type\": \"string\",\n\"pde_clnt_lst_nm\": \"string\",\n\"pde_version\": \"string\",\n\"mdd_fill_type\": \"string\",\n\"mdd_add_user_id\": \"string\",\n\"mdd_add_ts\": \"string\",\n\"mdd_add_pgm\": \"string\",\n\"mdd_chg_user_id\": \"string\",\n\"mdd_chg_ts\": \"string\",\n\"mdd_chg_pgm\": \"string\",\n\"mdh_det_rcd_count\": \"double\",\n\"mdh_det_rcd_accpt\": \"double\",\n\"mdh_det_rcd_infml\": \"double\",\n\"mdh_det_rcd_rejct\": \"double\",\n\"mdh_file_trns_dt\": \"string\",\n\"mdh_add_user_id\": \"string\",\n\"mdh_add_ts\": \"string\",\n\"mdh_add_pgm\": \"string\",\n\"mdh_chg_user_id\": \"string\",\n\"mdh_chg_ts\": \"string\",\n\"mdh_chg_pgm\": \"string\",\n\"src_env_sk\": \"double\",\n\"rec_stat_cd\": \"short\",\n\"run_id\": \"long\",\n\"update_uid\": \"string\",\n\"update_ts\": \"timestamp\",\n\"insert_uid\": \"string\",\n\"insert_ts\": \"timestamp\"}",
    "pipeline_name" : "f_mpd_pde_hist_recent",
    "primary_key" : "",
    "reformat_rules" : "{\n  \"pde_clm_rcvd_dt\" : \"coalesce(date_format(to_date(CAST(asaqce AS STRING), 'yyyyMMdd'), 'yyyyMMdd'), date_format(to_date('19000101', 'yyyyMMdd'), 'yyyyMMdd'))\",\n  \"mdh_add_pgm\" : \"str_non_nk(aqalvn12)\",\n  \"pde_paid_dt\" : \"date_check(CAST(asaoce AS DECIMAL(10,0)))\",\n  \"mdh_add_ts\" : \"date_format(to_timestamp(concat(date_check(aqc2dt12), time_check(aqadtm12)), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')\",\n  \"pde_resubmission_stat\" : \"str_non_nk(askmia)\",\n  \"pde_pat_pay_amt\" : \"numeric_non_nk(CAST(asfuik AS DECIMAL(11,2)))\",\n  \"sbm_prod_select_cd\" : \"str_non_nk(ask3st)\",\n  \"alt_srv_provider_qual\" : \"str_non_nk(asb2hn)\",\n  \"pde_brand_generic_cd\" : \"str_non_nk(asc4ai)\",\n  \"pde_edit_cd_9\" : \"str_non_nk(asc7hd)\",\n  \"pde_residence_cd_desc\" : \"str_non_nk(residence_cd_desc11)\",\n  \"pde_vaccn_fee\" : \"numeric_non_nk(CAST(asfwik AS DECIMAL(11,2)))\",\n  \"cag_sk\" : \"in1_cag_sk\",\n  \"cal_start_dt\" : \"date_check(cal_start_dt0)\",\n  \"pde_proxy_prod_id\" : \"str_non_nk(prod_id9)\",\n  \"pde_file_sbm_ts\" : \"date_format(to_timestamp(concat(date_check(aqc2dt12), time_check(aqadtm12)), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')\",\n  \"pde_gdca_amt\" : \"numeric_non_nk(CAST(asclik AS DECIMAL(11,2)))\",\n  \"pde_trans_rpt_sts_ts\" : \"date_format(to_timestamp(concat(date_check(CAST(aswwhg AS DECIMAL(9,0))), time_check(CAST(asvghe AS DECIMAL(8,0)))), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')\",\n  \"phr_hi_flg\" : \"str_non_nk(phr_hi_flg4)\",\n  \"pde_clnt_lst_nm\" : \"str_non_nk(aqf1hf12)\",\n  \"pde_edit_cd_5\" : \"str_non_nk(asc3hd)\",\n  \"pde_prod_id\" : \"str_non_nk(asric4)\",\n  \"mdh_det_rcd_infml\" : \"CAST(numeric_non_nk(aqadht12) AS DECIMAL(38,0))\",\n  \"mdd_add_user_id\" : \"str_non_nk(asakvn)\",\n  \"sales_tax\" : \"numeric_non_nk(CAST(asbhqu AS DECIMAL(11,2)))\",\n  \"tot_est_pde_cost\" : \"CAST((CAST(numeric_non_nk(CAST(asbfqu AS DECIMAL(11,2))) AS DECIMAL(14,2)) + CAST(numeric_non_nk(CAST(asbgqu AS DECIMAL(11,2))) AS DECIMAL(10,2))) AS STRING)\",\n  \"pde_proxy_ndc_label_nm\" : \"str_non_nk(prod_lbl10)\",\n  \"mdd_seq_nbr\" : \"CAST(numeric_non_nk(CAST(asf0hs AS DECIMAL(9,0))) AS DECIMAL(38,0))\",\n  \"pde_carrier_id\" : \"str_non_nk(asaacd)\",\n  \"phr_cost_type\" : \"str_non_nk(e0uicd14)\",\n  \"catast_cvg_cd\" : \"str_non_nk(asvjh9)\",\n  \"cal_end_dt\" : \"date_check(cal_end_dt0)\",\n  \"cms_drug_pricing_file_sk\" : \"in1_cms_drug_pricing_file_sk\",\n  \"pde_record_id\" : \"str_non_nk(ascfhn)\",\n  \"corrected_medicare_id\" : \"str_non_nk(aspxih)\",\n  \"pde_gap_discnt_amt\" : \"numeric_non_nk(CAST(asbkqu AS DECIMAL(11,2)))\",\n  \"pde_phr_npi_id\" : \"str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END)\",\n  \"pde_sbmtr_id\" : \"str_non_nk(aqp3ih22)\",\n  \"price_id\" : \"str_non_nk(price_id3)\",\n  \"pde_phr_id\" : \"str_non_nk(asythe)\",\n  \"pde_edit_cd_6\" : \"str_non_nk(asc4hd)\",\n  \"pde_medicare_id\" : \"str_non_nk(asb0hn)\",\n  \"sbm_prescriber_qual\" : \"str_non_nk(asilcj)\",\n  \"mpf_days_of_supply\" : \"CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0))\",\n  \"final_pln_eff_dt\" : \"date_check(CAST(asasda AS DECIMAL(9,0)))\",\n  \"pde_reproces_uid\" : \"str_non_nk(asd2io)\",\n  \"pde_ndc_uom\" : \"str_non_nk(package_size_uom_cd17)\",\n  \"pde_reproc_ts\" : \"date_format(to_timestamp(concat(date_check(CAST(aswyhg AS DECIMAL(9,0))), time_check(CAST(asvihe AS DECIMAL(8,0)))), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')\",\n  \"contract_of_record\" : \"str_non_nk(asb5hn)\",\n  \"pde_final_pln_cd\" : \"str_non_nk(astjcd)\",\n  \"pde_group_id\" : \"str_non_nk(asadcd)\",\n  \"pde_edit_cd_3\" : \"str_non_nk(asc1hd)\",\n  \"pde_ndc_label_nm\" : \"str_non_nk(prod_lbl8)\",\n  \"cms_stat_id\" : \"str_non_nk(asklia)\",\n  \"pde_othr_troop_amt\" : \"numeric_non_nk(CAST(ase6ik AS DECIMAL(11,2)))\",\n  \"pde_plro_amt\" : \"numeric_non_nk(CAST(ascnik AS DECIMAL(11,2)))\",\n  \"pde_edit_cd_8\" : \"str_non_nk(asc6hd)\",\n  \"pde_edit_cnt\" : \"CAST(numeric_non_nk(CAST(trim(CAST(asf1hs AS DECIMAL(5,0))) AS STRING)) AS DECIMAL(38,0))\",\n  \"pde_exclution_rsn_cd\" : \"str_non_nk(asfdie)\",\n  \"pde_reproc_sbmtr_id\" : \"str_non_nk(aslcij)\",\n  \"prod_sk\" : \"in1_prod_sk\",\n  \"proxy_ndc_uom\" : \"str_non_nk(package_size_uom_cd18)\",\n  \"mbr_sk\" : \"in1_mbr_sk\",\n  \"pde_edit_cd_7\" : \"str_non_nk(asc5hd)\",\n  \"pde_edit_cd_1\" : \"str_non_nk(asczhd)\",\n  \"pde_npp_amt\" : \"numeric_non_nk(CAST(ascpik AS DECIMAL(11,2)))\",\n  \"sbm_rx_nbr\" : \"str_non_nk(asukcd)\",\n  \"pde_dispensing_fee\" : \"numeric_non_nk(CAST(asbgqu AS DECIMAL(11,2)))\",\n  \"mdd_fill_type\" : \"str_non_nk(aswgat)\",\n  \"pde_adj_rsn_cd\" : \"str_non_nk(asbbve)\",\n  \"mdh_chg_user_id\" : \"str_non_nk(aqadvn12)\",\n  \"pde_version\" : \"str_non_nk(aqeyai12)\",\n  \"pde_reproc_file_id\" : \"str_non_nk(aslbij)\",\n  \"mdh_add_user_id\" : \"str_non_nk(aqakvn12)\",\n  \"pde_rx_org_cd\" : \"str_non_nk(ask6st)\",\n  \"mdd_chg_pgm\" : \"str_non_nk(asaevn)\",\n  \"pde_gpi_id\" : \"str_non_nk(gpi_id5)\",\n  \"pde_formulary_cd\" : \"str_non_nk(asc8ai)\",\n  \"mdh_det_rcd_accpt\" : \"CAST(numeric_non_nk(aqfvhs12) AS DECIMAL(38,0))\",\n  \"pbp_of_record\" : \"str_non_nk(asb1hn)\",\n  \"pde_drg_qty\" : \"numeric_non_nk(CAST(asionb AS DECIMAL(13,3)))\",\n  \"pricing_file_mail_flg\" : \"str_non_nk(coalesce(pricing_file_mail_flg20, phr_mail_flg4))\",\n  \"pde_file_type\" : \"str_non_nk(aqveh912)\",\n  \"pde_file_id\" : \"str_nk(aspwih)\",\n  \"drop_record\" : \"lpad(CASE WHEN (flg = 'H') THEN 0 ELSE 2 END, 1, ' ')\",\n  \"pde_resbm_cms_type\" : \"str_non_nk(asaoib)\",\n  \"cms_segment_id\" : \"str_non_nk(cms_segment_id3)\",\n  \"pl_of_svc_submd\" : \"str_non_nk(riawod16)\",\n  \"sbm_srv_provider_qual\" : \"str_non_nk(asn5ia)\",\n  \"pde_lics_amt\" : \"numeric_non_nk(CAST(ascmik AS DECIMAL(11,2)))\",\n  \"pde_file_from_dt\" : \"date_check(aqo1hg12)\",\n  \"phr_retail_flg\" : \"str_non_nk(phr_retail_flg4)\",\n  \"cms_cal_gap_dscnt_amt\" : \"numeric_non_nk(CAST(asblqu AS DECIMAL(11,2)))\",\n  \"pde_edit_cd_2\" : \"str_non_nk(asc0hd)\",\n  \"pde_filled_dt\" : \"date_check(CAST(asbbda AS DECIMAL(10,0)))\",\n  \"pde_claim_seq_nbr_src\" : \"CAST((1000 - numeric_non_nk(CAST(asoinb AS DECIMAL(5,0)))) AS DECIMAL(38,0))\",\n  \"mdd_add_pgm\" : \"str_non_nk(asalvn)\",\n  \"pde_edit_cd_4\" : \"str_non_nk(asc2hd)\",\n  \"pde_gdcb_amt\" : \"numeric_non_nk(CAST(asckik AS DECIMAL(11,2)))\",\n  \"mdh_det_rcd_rejct\" : \"CAST(numeric_non_nk(aqfwhs12) AS DECIMAL(38,0))\",\n  \"pde_resbm_sts_ts\" : \"date_format(to_timestamp(concat(date_check(CAST(aswxhg AS DECIMAL(9,0))), time_check(CAST(asvhhe AS DECIMAL(8,0)))), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')\",\n  \"mpf_ndc_unit_cost\" : \"numeric_non_nk(unit_cost13)\",\n  \"pde_ndc_inactive_dt\" : \"CASE WHEN (date_check(drg_ndc_term_dt18) = '19000101') THEN '19000101' ELSE date_check(date_format(to_date(add_months(drg_ndc_term_dt18, -18), 'yyyy-MM-dd HH:mm:ss.SSSS'), 'yyyyMMdd')) END\",\n  \"preferred_status_mail_flg\" : \"str_non_nk(preferred_status_mail_flg4)\",\n  \"pde_file_thru_dt\" : \"date_check(aqo2hg12)\",\n  \"pde_residence_cd\" : \"str_non_nk(asaxod)\",\n  \"phr_la_drugs_flg\" : \"str_non_nk(phr_la_drugs_flg4)\",\n  \"sbm_clarification_cd\" : \"str_non_nk(ask7st)\",\n  \"phr_mail_flg\" : \"str_non_nk(phr_mail_flg4)\",\n  \"pde_account_id\" : \"str_non_nk(asaccd)\",\n  \"tot_mpf_drug_cost\" : \"CAST((CAST(numeric_non_nk(unit_cost13) AS DECIMAL(14,4)) * CAST(numeric_non_nk(CAST(asionb AS DECIMAL(13,3))) AS DECIMAL(12,3))) AS STRING)\",\n  \"pde_days_of_supply\" : \"CAST(numeric_non_nk(CAST(asimnb AS DECIMAL(5,0))) AS DECIMAL(38,0))\",\n  \"prod_directory_dt\" : \"date_check(prod_directory_dt1)\",\n  \"cms_stars_calendar_submission_sk\" : \"in1_cms_stars_calendar_submission_sk\",\n  \"pde_contract_id\" : \"str_non_nk(asvwhc)\",\n  \"pde_est_rbt_amt\" : \"numeric_non_nk(CAST(asfvik AS DECIMAL(11,2)))\",\n  \"pde_true_troop_accom\" : \"numeric_non_nk(CAST(asbjqu AS DECIMAL(11,2)))\",\n  \"pde_adj_rsn_cd_qual\" : \"str_non_nk(asy0ar)\",\n  \"mdd_chg_ts\" : \"date_format(to_timestamp(concat(CAST(asbmdt AS DECIMAL(9,0)), time_check(CAST(asabtm AS DECIMAL(8,0)))), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')\",\n  \"cur_claim_stat_id\" : \"str_non_nk(dnkust15)\",\n  \"pde_pbp_id\" : \"str_non_nk(asvyhc)\",\n  \"pde_drug_tier\" : \"str_non_nk(asc7ai)\",\n  \"pde_resbm_uid\" : \"str_non_nk(asd1io)\",\n  \"gap_discnt_pln_ovcd\" : \"str_non_nk(asc9ai)\",\n  \"tot_est_discrepancy\" : \"CAST(((CAST(numeric_non_nk(CAST(asbfqu AS DECIMAL(11,2))) AS DECIMAL(14,2)) + CAST(numeric_non_nk(CAST(asbgqu AS DECIMAL(11,2))) AS DECIMAL(10,2))) - ((CAST(numeric_non_nk(unit_cost13) AS DECIMAL(14,4)) * CAST(numeric_non_nk(CAST(asionb AS DECIMAL(13,3))) AS DECIMAL(12,3))) + CAST(numeric_non_nk(CASE WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN brand_dispensing_fee_3019 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN generic_dispensing_fee_3019 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN brand_dispensing_fee_6019 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN generic_dispensing_fee_6019 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN brand_dispensing_fee_9019 ELSE CASE WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN generic_dispensing_fee_9019 END END) AS DECIMAL(14,4)))) AS STRING)\",\n  \"tot_pde_drug_cost\" : \"numeric_non_nk(CAST(asbfqu AS DECIMAL(11,2)))\",\n  \"mdh_chg_pgm\" : \"str_non_nk(aqaevn12)\",\n  \"pde_ben_phs_begn\" : \"str_non_nk(asc5ai)\",\n  \"pde_non_stnd_cd\" : \"str_non_nk(asvhh9)\",\n  \"pde_cpp_amt\" : \"numeric_non_nk(CAST(ascoik AS DECIMAL(11,2)))\",\n  \"price_exceptn_cd\" : \"str_non_nk(asvih9)\",\n  \"preferred_status_retail_flg\" : \"str_non_nk(preferred_status_retail_flg4)\",\n  \"cms_pharmacy_cost_sk\" : \"in1_cms_pharmacy_cost_sk\",\n  \"pde_dispns_stat\" : \"str_non_nk(asj3cj)\",\n  \"pde_pbr_id\" : \"str_non_nk(astccd)\",\n  \"pde_mbr_id\" : \"str_non_nk(asabcd)\",\n  \"mdd_add_ts\" : \"date_format(to_timestamp(concat(CAST(asc2dt AS DECIMAL(9,0)), time_check(CAST(asadtm AS DECIMAL(8,0)))), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')\",\n  \"pde_claim_stat_id\" : \"str_non_nk(ass6st)\",\n  \"pde_ndc_cost\" : \"numeric_non_nk(CAST(asbfqu AS DECIMAL(11,2)))\",\n  \"pde_compound_cd\" : \"str_non_nk(ask2st)\",\n  \"src_env_sk\" : \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"mdh_file_trns_dt\" : \"date_check(aqc2dt12)\",\n  \"mdd_chg_user_id\" : \"str_non_nk(asadvn)\",\n  \"pde_tot_drg_grs_cost\" : \"numeric_non_nk(CAST(asbiqu AS DECIMAL(11,2)))\",\n  \"phr_ltc_flg\" : \"str_non_nk(phr_ltc_flg4)\",\n  \"pde_file_proc_ts\" : \"date_format(to_timestamp(concat(date_check(aqnfce12), time_check(aqbqtz12)), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')\",\n  \"pde_ndc_unit_cost\" : \"(numeric_non_nk(CAST(asbfqu AS DECIMAL(11,2))) / numeric_non_nk(CAST(asionb AS DECIMAL(13,3))))\",\n  \"pde_drg_cvg_cd\" : \"str_non_nk(aso6h9)\",\n  \"orig_sbm_contract_id\" : \"str_non_nk(asb4hn)\",\n  \"pde_edit_cd_10\" : \"str_non_nk(asc8hd)\",\n  \"mdh_chg_ts\" : \"date_format(to_timestamp(concat(date_check(aqbmdt12), time_check(aqabtm12)), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')\",\n  \"floor_price\" : \"numeric_non_nk(floor_price21)\",\n  \"pde_claim_nbr\" : \"CAST(numeric_nk(CAST(asp2nb AS DECIMAL(17,0))) AS DECIMAL(38,0))\",\n  \"mpf_dispensing_fee\" : \"numeric_non_nk(CASE WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN brand_dispensing_fee_3019 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN generic_dispensing_fee_3019 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN brand_dispensing_fee_6019 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN generic_dispensing_fee_6019 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN brand_dispensing_fee_9019 ELSE CASE WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN generic_dispensing_fee_9019 END END)\",\n  \"alt_srv_provider_id\" : \"str_non_nk(asb3hn)\",\n  \"mdh_det_rcd_count\" : \"CAST(numeric_non_nk(aqfuhs12) AS DECIMAL(38,0))\",\n  \"pde_ben_phs_end\" : \"str_non_nk(asc6ai)\",\n  \"pde_refill_nbr\" : \"str_non_nk(asulcd)\",\n  \"trans_rpt_sts_uid\" : \"str_non_nk(asd0io)\",\n  \"pde_adj_del_cd\" : \"str_non_nk(asvgh9)\",\n  \"adj_begin_ts\" : \"date_format(to_timestamp(substring(CAST(asbqir AS STRING), 1, 20), 'yyyy-MM-dd-HH.mm.ss.'), 'yyyyMMdd HH:mm:ss')\",\n  \"pde_phr_svc_typ\" : \"str_non_nk(asavod)\",\n  \"cms_proxy_ndc_rxcui_sk\" : \"in1_cms_proxy_ndc_rxcui_sk\",\n  \"pde_ndc_obsolete_dt\" : \"date_check(drg_ndc_term_dt18)\",\n  \"claim_phr_sk\" : \"CAST(numeric_non_nk(phr_sk2) AS DECIMAL(38,0))\",\n  \"tot_est_mpf_cost\" : \"CAST(((CAST(numeric_non_nk(unit_cost13) AS DECIMAL(14,4)) * CAST(numeric_non_nk(CAST(asionb AS DECIMAL(13,3))) AS DECIMAL(12,3))) + CAST(numeric_non_nk(CASE WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN brand_dispensing_fee_3019 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN generic_dispensing_fee_3019 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN brand_dispensing_fee_6019 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN generic_dispensing_fee_6019 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN brand_dispensing_fee_9019 ELSE CASE WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN generic_dispensing_fee_9019 END END) AS DECIMAL(14,4))) AS STRING)\"\n}",
    "reformat_rules_join" : "joins = [\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cag\",\n       \"join-cond\": \"in1.carrier_id = in0.asaacd AND in1.account_id = in0.asaccd AND in1.employer_group_id = in0.asadcd\",\n       \"val-cols\": [\n         \"in1.cag_sk as in1_cag_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT) AND in1.cal_start_dt = date_check(CAST(asbbda AS DECIMAL(10,0)))\",\n       \"val-cols\": [\n         \"in1.cal_start_dt AS cal_start_dt0\",\n         \"in1.prod_directory_dt_sk AS prod_directory_dt_sk0\",\n         \"in1.cal_end_dt AS cal_end_dt0\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT) AND in1.cal_start_dt = date_format(to_date(date_check(CAST(asbbda AS DECIMAL(10,0))), 'yyyyMMdd'), 'yyyyMMdd')\",\n       \"val-cols\": [\n         \"in1.cal_end_dt AS cal_end_dt1\",\n         \"in1.prod_directory_dt AS prod_directory_dt1\",\n         \"in1.prod_directory_dt_sk AS prod_directory_dt_sk1\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cms_stars_calendar_submission\",\n       \"join-cond\": \"in1.cal_start_dt = date_check(cal_start_dt0) AND in1.cal_end_dt = date_check(cal_end_dt1) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS DECIMAL(38,0))\",\n       \"val-cols\": [\n         \"in1.cms_stars_calendar_submission_sk as in1_cms_stars_calendar_submission_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_pharmacy\",\n       \"join-cond\": \"in1.phr_id = trim(in0.asythe)\",\n       \"val-cols\": [\n         \"in1.phr_npi_no AS phr_npi_no2\",\n         \"in1.phr_sk AS phr_sk2\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.cms_contract_id = trim(in0.asvwhc) AND in1.cms_pbp_id = trim(in0.asvyhc) AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt_sk = prod_directory_dt_sk0\",\n       \"val-cols\": [\n         \"in1.cms_segment_id AS cms_segment_id3\",\n         \"in1.price_id AS price_id3\",\n         \"in1.phr_mail_flg AS phr_mail_flg3\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cms_pharmacy_cost\",\n       \"join-cond\": \"in1.cms_contract_id = str_non_nk(asvwhc) AND in1.cms_pbp_id = str_non_nk(asvyhc) AND in1.cms_segment_id = str_non_nk(cms_segment_id3) AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt = date_check(prod_directory_dt1)\",\n       \"val-cols\": [\n         \"in1.cms_pharmacy_cost_sk as in1_cms_pharmacy_cost_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_member\",\n       \"join-cond\": \"in1.carrier_id = in0.asaacd AND in1.account_id = in0.asaccd AND in1.employer_group_id = in0.asadcd AND in1.mbr_id = in0.asabcd\",\n       \"val-cols\": [\n         \"in1.mbr_sk as in1_mbr_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.cms_contract_id = trim(in0.asvwhc) AND in1.cms_pbp_id = trim(in0.asvyhc) AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt_sk = prod_directory_dt_sk1\",\n       \"val-cols\": [\n         \"in1.price_id AS price_id4\",\n         \"in1.phr_mail_flg AS phr_mail_flg4\",\n         \"in1.cms_segment_id AS cms_segment_id4\",\n         \"in1.preferred_status_mail_flg AS preferred_status_mail_flg4\",\n         \"in1.phr_retail_flg AS phr_retail_flg4\",\n         \"in1.phr_la_drugs_flg AS phr_la_drugs_flg4\",\n         \"in1.phr_hi_flg AS phr_hi_flg4\",\n         \"in1.phr_ltc_flg AS phr_ltc_flg4\",\n         \"in1.preferred_status_retail_flg AS preferred_status_retail_flg4\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cms_prxy_ndc_rxcui\",\n       \"join-cond\": \"in1.prod_id = trim(in0.asric4) AND in1.src_env_sk = CAST(500 AS INT) AND in1.efft_dt = date_format(to_date(CAST(in0.asbbda AS STRING), 'yyyyMMdd'), 'yyyyMMdd')\",\n       \"val-cols\": [\n         \"in1.rxcui AS rxcui5\",\n         \"in1.gpi_id AS gpi_id5\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cms_prxy_ndc_rxcui_prod_id\",\n       \"join-cond\": \"in1.rxcui = rxcui5 AND in1.src_env_sk = CAST(500 AS INT) AND in1.efft_dt = date_format(to_date(CAST(in0.asbbda AS STRING), 'yyyyMMdd'), 'yyyyMMdd')\",\n       \"val-cols\": [\n         \"in1.prod_id AS prod_id6\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cms_drug_pricing_file\",\n       \"join-cond\": \"in1.cms_contract_id = str_non_nk(asvwhc) AND in1.price_id = str_non_nk(price_id4) AND in1.cms_proxy_ndc_id = str_non_nk(prod_id6) AND in1.days_of_supply = CAST(CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) AND in1.pricing_file_mail_flg = str_non_nk(phr_mail_flg4) AND in1.prod_directory_dt = date_check(prod_directory_dt1)\",\n       \"val-cols\": [\n         \"in1.cms_drug_pricing_file_sk as in1_cms_drug_pricing_file_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_product\",\n       \"join-cond\": \"in1.prod_id = in0.asric4 AND in1.prod_id_qlfr_cd = '03'\",\n       \"val-cols\": [\n         \"in1.prod_sk as in1_prod_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cms_prxy_ndc_rxcui\",\n       \"join-cond\": \"in1.prod_id = in0.asric4 AND in1.src_env_sk = CAST(500 AS INT) AND in1.efft_dt = CAST(in0.asbbda AS STRING)\",\n       \"val-cols\": [\n         \"in1.rxcui AS rxcui7\",\n         \"in1.ext_ovrd_id AS ext_ovrd_id7\",\n         \"in1.efft_dt AS efft_dt7\",\n         \"in1.rxcui_type_cd AS rxcui_type_cd7\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cms_prxy_ndc_rxcui\",\n       \"join-cond\": \"in1.prod_id = trim(in0.asric4) AND in1.rxcui = CAST(rxcui7 AS DECIMAL(38,0)) AND in1.active_ind = 'Y' AND in1.mpd_ind = 'Y' AND in1.ext_ovrd_id = ext_ovrd_id7 AND in1.efft_dt = efft_dt7 AND in1.rxcui_type_cd = rxcui_type_cd7 AND in1.src_env_sk = 500\",\n       \"val-cols\": [\n         \"in1.cms_proxy_ndc_rxcui_sk as in1_cms_proxy_ndc_rxcui_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.f_pde_rec_cag\",\n       \"join-cond\": \"in1.carrier_id = in0.asaacd AND in1.account_id = in0.asaccd AND in1.employer_group_id = in0.asadcd\",\n       \"val-cols\": [\n         \"in1.f_pde_rec_cag as in1_f_pde_rec_cag\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.f_pde_rec_cal_sub\",\n       \"join-cond\": \"in1.cal_start_dt = date_check(cal_start_dt0) AND in1.cal_end_dt = date_check(cal_end_dt1) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS DECIMAL(38,0))\",\n       \"val-cols\": [\n         \"in1.f_pde_rec_cal_sub as in1_f_pde_rec_cal_sub\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.f_pde_rec_cost\",\n       \"join-cond\": \"in1.cms_contract_id = str_non_nk(asvwhc) AND in1.cms_pbp_id = str_non_nk(asvyhc) AND in1.cms_segment_id = str_non_nk(cms_segment_id4) AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt = date_check(prod_directory_dt1)\",\n       \"val-cols\": [\n         \"in1.f_pde_rec_cost as in1_f_pde_rec_cost\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.f_pde_rec_mbr\",\n       \"join-cond\": \"in1.carrier_id = in0.asaacd AND in1.account_id = in0.asaccd AND in1.employer_group_id = in0.asadcd AND in1.mbr_id = in0.asabcd\",\n       \"val-cols\": [\n         \"in1.f_pde_rec_mbr as in1_f_pde_rec_mbr\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.f_pde_rec_prc_file\",\n       \"join-cond\": \"in1.cms_contract_id = str_non_nk(asvwhc) AND in1.price_id = str_non_nk(price_id4) AND in1.cms_proxy_ndc_id = str_non_nk(prod_id6) AND in1.days_of_supply = CAST(CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) AND in1.pricing_file_mail_flg = str_non_nk(phr_mail_flg4) AND in1.prod_directory_dt = date_check(prod_directory_dt1)\",\n       \"val-cols\": [\n         \"in1.f_pde_rec_prc_file as in1_f_pde_rec_prc_file\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.f_pde_rec_prd\",\n       \"join-cond\": \"in1.prod_id = trim(in0.asric4) AND in1.prod_id_qlfr_cd = '03'\",\n       \"val-cols\": [\n         \"in1.f_pde_rec_prd as in1_f_pde_rec_prd\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.f_pde_rec_prxy_ndc\",\n       \"join-cond\": \"in1.prod_id = trim(in0.asric4) AND in1.rxcui = CAST(rxcui7 AS DECIMAL(38,0)) AND in1.active_ind = 'Y' AND in1.mpd_ind = 'Y' AND in1.ext_ovrd_id = ext_ovrd_id7 AND in1.efft_dt = efft_dt7 AND in1.rxcui_type_cd = rxcui_type_cd7 AND in1.src_env_sk = 500\",\n       \"val-cols\": [\n         \"in1.f_pde_rec_prxy_ndc as in1_f_pde_rec_prxy_ndc\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cms_prxy_ndc_rxcui\",\n       \"join-cond\": \"in1.prod_id = trim(in0.asric4) AND in1.src_env_sk = CAST(500 AS INT) AND in1.efft_dt = CAST(in0.asbbda AS STRING)\",\n       \"val-cols\": [\n         \"in1.rxcui AS rxcui8\",\n         \"in1.prod_lbl AS prod_lbl8\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cms_prxy_ndc_rxcui_prod_id\",\n       \"join-cond\": \"in1.rxcui = rxcui8 AND in1.src_env_sk = CAST(500 AS INT) AND in1.efft_dt = CAST(in0.asbbda AS STRING)\",\n       \"val-cols\": [\n         \"in1.prod_id AS prod_id9\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.d_cms_prxy_ndc_rxcui\",\n       \"join-cond\": \"in1.prod_id = trim(str_non_nk(prod_id9)) AND in1.src_env_sk = CAST(500 AS INT) AND in1.efft_dt = CAST(in0.asbbda AS STRING)\",\n       \"val-cols\": [\n         \"in1.prod_lbl AS prod_lbl10\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"orx_idw_dm_prd.l_residence\",\n       \"join-cond\": \"in1.residence_cd = str_non_nk(asaxod)\",\n       \"val-cols\": [\n         \"in1.residence_cd_desc AS residence_cd_desc11\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.aqpwih = in0.aspwih\",\n       \"val-cols\": [\n         \"in1.aqc2dt AS aqc2dt12\",\n         \"in1.aqadtm AS aqadtm12\",\n         \"in1.aqnfce AS aqnfce12\",\n         \"in1.aqbqtz AS aqbqtz12\",\n         \"in1.aqo1hg AS aqo1hg12\",\n         \"in1.aqo2hg AS aqo2hg12\",\n         \"in1.aqveh9 AS aqveh912\",\n         \"in1.aqf1hf AS aqf1hf12\",\n         \"in1.aqeyai AS aqeyai12\",\n         \"in1.aqfuhs AS aqfuhs12\",\n         \"in1.aqfvhs AS aqfvhs12\",\n         \"in1.aqadht AS aqadht12\",\n         \"in1.aqfwhs AS aqfwhs12\",\n         \"in1.aqakvn AS aqakvn12\",\n         \"in1.aqalvn AS aqalvn12\",\n         \"in1.aqadvn AS aqadvn12\",\n         \"in1.aqbmdt AS aqbmdt12\",\n         \"in1.aqabtm AS aqabtm12\",\n         \"in1.aqaevn AS aqaevn12\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.cms_contract_id = trim(in0.asvwhc) AND in1.price_id = price_id3 AND in1.cms_proxy_ndc_id = str_non_nk(prod_id9) AND in1.days_of_supply = CAST(CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) AND in1.pricing_file_mail_flg = phr_mail_flg3 AND in1.prod_directory_dt_sk = prod_directory_dt_sk0\",\n       \"val-cols\": [\n         \"in1.unit_cost AS unit_cost13\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.e0p2nb = CAST(in0.asp2nb AS DECIMAL(17,0)) AND in1.e0oinb = CAST(in0.asoinb AS DECIMAL(5,0)) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT)\",\n       \"val-cols\": [\n         \"in1.e0uicd AS e0uicd14\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.dnp2nb = CAST(in0.asp2nb AS DECIMAL(17,0)) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT)\",\n       \"val-cols\": [\n         \"in1.dnkust AS dnkust15\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.rip2nb = CAST(in0.asp2nb AS DECIMAL(17,0)) AND in1.rioinb = CAST(in0.asoinb AS DECIMAL(5,0)) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT)\",\n       \"val-cols\": [\n         \"in1.riawod AS riawod16\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.prod_id = trim(in0.asric4)\",\n       \"val-cols\": [\n         \"in1.package_size_uom_cd AS package_size_uom_cd17\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.prod_id = trim(str_non_nk(prod_id9))\",\n       \"val-cols\": [\n         \"in1.package_size_uom_cd AS package_size_uom_cd18\",\n         \"in1.drg_ndc_term_dt AS drg_ndc_term_dt18\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.cms_contract_id = in0.asvwhc AND in1.cms_pbp_id = in0.asvyhc AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt_sk = prod_directory_dt_sk0\",\n       \"val-cols\": [\n         \"in1.brand_dispensing_fee_30 AS brand_dispensing_fee_3019\",\n         \"in1.generic_dispensing_fee_30 AS generic_dispensing_fee_3019\",\n         \"in1.brand_dispensing_fee_60 AS brand_dispensing_fee_6019\",\n         \"in1.generic_dispensing_fee_60 AS generic_dispensing_fee_6019\",\n         \"in1.brand_dispensing_fee_90 AS brand_dispensing_fee_9019\",\n         \"in1.generic_dispensing_fee_90 AS generic_dispensing_fee_9019\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.cms_contract_id = trim(in0.asvwhc) AND in1.price_id = price_id4 AND in1.cms_proxy_ndc_id = trim(str_non_nk(prod_id6)) AND in1.days_of_supply = CAST(CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) AND in1.pricing_file_mail_flg = phr_mail_flg4 AND in1.prod_directory_dt_sk = prod_directory_dt_sk1\",\n       \"val-cols\": [\n         \"in1.pricing_file_mail_flg AS pricing_file_mail_flg20\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.cms_contract_id = in0.asvwhc AND in1.cms_pbp_id = in0.asvyhc AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt_sk = prod_directory_dt_sk1\",\n       \"val-cols\": [\n         \"in1.floor_price AS floor_price21\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"/path\",\n       \"join-cond\": \"in1.aqpwih = trim(in0.aspwih)\",\n       \"val-cols\": [\n         \"in1.aqp3ih AS aqp3ih22\"\n       ]\n    }\n]",
    "source_path" : "srcs = [{\n    \"fmt\" : \"parquet\",\n    \"src\" : \"dbfs:/PATH/*\"\n}]",
    "source_table" : "",
    "target_table" : ""
}
-------
  val key = "6F6826F7F791E1A8EE7E1BD7717D3ED"
  val tweak = "CBD09280979564"
  val alphabet = FF3Cipher.DIGITS+FF3Cipher.ASCII_UPPERCASE+FF3Cipher.ASCII_LOWERCASE
  val ff3 = new FF3Cipher(key, tweak, alphabet)
  println(ff3.encrypt("23422342"))

  ---


  CASE WHEN src_env_sk IN (480, 490) THEN ((((NOT (carrierid IS NULL)) AND ((NOT CAST(string_like(CAST(upper(carrierid) AS STRING), '%TEST%') AS BOOLEAN)) AND (NOT CAST(string_like(CAST(upper(carrierid) AS STRING), '%TST%') AS BOOLEAN)))) AND ((NOT array_contains(array('1718634', '0556540', '1497704431', '1669498515'), srvprovid)) OR (CAST(rxnumber AS DOUBLE) >= 10000))) OR (carrierid IS NULL)) AND (claim_match_ind = 'Y') ELSE ((NOT (carrierid IS NULL)) AND (((CAST(rccesp_lkp_match0 AS BOOLEAN) AND (coalesce(niiyc31, ' ') = 'Y')) OR ((NOT CAST(rccesp_lkp_match0 AS BOOLEAN)) AND (CAST(rccesp_lkp_match2 AS BOOLEAN) AND (coalesce(niiyc33, ' ') = 'Y')))) OR ((niiyc34 IS NULL) AND (coalesce(niiyc35, ' ') = 'Y')))) AND (claim_match_ind = 'Y') END
  -----
  joins = [
      {
         "fmt": "table",
         "src": "orx_idw_dm_prd.unknown_f_pde_hist_cag",
         "join-cond": "in1.carrier_id = in0.asaacd AND in1.account_id = in0.asaccd AND in1.employer_group_id = in0.asadcd",
         "val-cols": [
           "in1.f_pde_hist_cag as in1_f_pde_hist_cag"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT) AND in1.cal_start_dt = date_check(CAST(asbbda AS DECIMAL(10,0)))",
         "val-cols": [
           "in1.cal_start_dt AS cal_start_dt0",
           "in1.prod_directory_dt_sk AS prod_directory_dt_sk0",
           "in1.cal_end_dt AS cal_end_dt0"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT) AND in1.cal_start_dt = date_format(to_date(date_check(CAST(asbbda AS DECIMAL(10,0))), 'yyyyMMdd'), 'yyyyMMdd')",
         "val-cols": [
           "in1.cal_end_dt AS cal_end_dt1",
           "in1.prod_directory_dt AS prod_directory_dt1",
           "in1.prod_directory_dt_sk AS prod_directory_dt_sk1"
         ]
      },
      {
         "fmt": "table",
         "src": "orx_idw_dm_prd.unknown_f_pde_hist_cal_sub",
         "join-cond": "in1.cal_start_dt = date_check(cal_start_dt0) AND in1.cal_end_dt = date_check(cal_end_dt1) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS DECIMAL(38,0))",
         "val-cols": [
           "in1.f_pde_hist_cal_sub as in1_f_pde_hist_cal_sub"
         ]
      },
      {
         "fmt": "csv",
         "src": "/{AI_SERIAL_LOOKUP}/lookup.ids_common/lookup.ids_common.d_pharmacy.dat",
         "join-cond": "in1.phr_id = trim(in0.asythe)",
         "val-cols": [
           "in1.phr_npi_no AS phr_npi_no2",
           "in1.phr_sk AS phr_sk2"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.cms_contract_id = trim(in0.asvwhc) AND in1.cms_pbp_id = trim(in0.asvyhc) AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt_sk = prod_directory_dt_sk0",
         "val-cols": [
           "in1.cms_segment_id AS cms_segment_id3",
           "in1.price_id AS price_id3",
           "in1.phr_mail_flg AS phr_mail_flg3"
         ]
      },
      {
         "fmt": "table",
         "src": "orx_idw_dm_prd.unknown_f_pde_hist_cost",
         "join-cond": "in1.cms_contract_id = str_non_nk(asvwhc) AND in1.cms_pbp_id = str_non_nk(asvyhc) AND in1.cms_segment_id = str_non_nk(cms_segment_id3) AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt = date_check(prod_directory_dt1)",
         "val-cols": [
           "in1.f_pde_hist_cost as in1_f_pde_hist_cost"
         ]
      },
      {
         "fmt": "table",
         "src": "orx_idw_dm_prd.unknown_f_pde_hist_mbr",
         "join-cond": "in1.carrier_id = in0.asaacd AND in1.account_id = in0.asaccd AND in1.employer_group_id = in0.asadcd AND in1.mbr_id = in0.asabcd",
         "val-cols": [
           "in1.f_pde_hist_mbr as in1_f_pde_hist_mbr"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.cms_contract_id = trim(in0.asvwhc) AND in1.cms_pbp_id = trim(in0.asvyhc) AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt_sk = prod_directory_dt_sk1",
         "val-cols": [
           "in1.price_id AS price_id4",
           "in1.phr_mail_flg AS phr_mail_flg4",
           "in1.cms_segment_id AS cms_segment_id4",
           "in1.preferred_status_mail_flg AS preferred_status_mail_flg4",
           "in1.phr_retail_flg AS phr_retail_flg4",
           "in1.phr_la_drugs_flg AS phr_la_drugs_flg4",
           "in1.phr_hi_flg AS phr_hi_flg4",
           "in1.phr_ltc_flg AS phr_ltc_flg4",
           "in1.preferred_status_retail_flg AS preferred_status_retail_flg4"
         ]
      },
      {
         "fmt": "csv",
         "src": "/{AI_SERIAL_LOOKUP}/lookup.ids_rxclaim/lookup.ids_rxclaim.d_cms_prxy_ndc_rxcui.dat",
         "join-cond": "in1.prod_id = trim(in0.asric4) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT) AND in1.efft_dt = date_format(to_date(CAST(in0.asbbda AS STRING), 'yyyyMMdd'), 'yyyyMMdd')",
         "val-cols": [
           "in1.rxcui AS rxcui5",
           "in1.prod_lbl AS prod_lbl5",
           "in1.gpi_id AS gpi_id5"
         ]
      },
      {
         "fmt": "csv",
         "src": "/{AI_SERIAL_LOOKUP}/lookup.ids_rxclaim/lookup.ids_rxclaim.d_cms_prxy_ndc_rxcui_prod_id.dat",
         "join-cond": "in1.rxcui = rxcui5 AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT) AND in1.efft_dt = date_format(to_date(CAST(in0.asbbda AS STRING), 'yyyyMMdd'), 'yyyyMMdd')",
         "val-cols": [
           "in1.prod_id AS prod_id6"
         ]
      },
      {
         "fmt": "table",
         "src": "orx_idw_dm_prd.unknown_f_pde_hist_prc_file",
         "join-cond": "in1.cms_contract_id = str_non_nk(asvwhc) AND in1.price_id = str_non_nk(price_id4) AND in1.cms_proxy_ndc_id = str_non_nk(prod_id6) AND in1.days_of_supply = CAST(CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) AND in1.pricing_file_mail_flg = str_non_nk(phr_mail_flg4) AND in1.prod_directory_dt = date_check(prod_directory_dt1)",
         "val-cols": [
           "in1.f_pde_hist_prc_file as in1_f_pde_hist_prc_file"
         ]
      },
      {
         "fmt": "table",
         "src": "orx_idw_dm_prd.unknown_f_pde_hist_prd",
         "join-cond": "in1.prod_id = in0.asric4 AND in1.prod_id_qlfr_cd = '03'",
         "val-cols": [
           "in1.f_pde_hist_prd as in1_f_pde_hist_prd"
         ]
      },
      {
         "fmt": "csv",
         "src": "/{AI_SERIAL_LOOKUP}/lookup.ids_rxclaim/lookup.ids_rxclaim.d_cms_prxy_ndc_rxcui.dat",
         "join-cond": "in1.prod_id = in0.asric4 AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT) AND in1.efft_dt = CAST(in0.asbbda AS STRING)",
         "val-cols": [
           "in1.rxcui AS rxcui7",
           "in1.ext_ovrd_id AS ext_ovrd_id7",
           "in1.efft_dt AS efft_dt7",
           "in1.rxcui_type_cd AS rxcui_type_cd7"
         ]
      },
      {
         "fmt": "table",
         "src": "orx_idw_dm_prd.unknown_f_pde_hist_prxy_ndc",
         "join-cond": "in1.prod_id = trim(in0.asric4) AND in1.rxcui = CAST(rxcui7 AS DECIMAL(38,0)) AND in1.active_ind = 'Y' AND in1.mpd_ind = 'Y' AND in1.ext_ovrd_id = ext_ovrd_id7 AND in1.efft_dt = efft_dt7 AND in1.rxcui_type_cd = rxcui_type_cd7 AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS DECIMAL(38,0))",
         "val-cols": [
           "in1.f_pde_hist_prxy_ndc as in1_f_pde_hist_prxy_ndc"
         ]
      },
      {
         "fmt": "table",
         "src": "ids_common.d_cag",
         "join-cond": "in1.carrier_id = in0.asaacd AND in1.account_id = in0.asaccd AND in1.employer_group_id = in0.asadcd",
         "val-cols": [
           "in1.cag_sk as in1_cag_sk"
         ]
      },
      {
         "fmt": "table",
         "src": "ids_rxclaim.d_cms_stars_calendar_submission",
         "join-cond": "in1.cal_start_dt = date_check(cal_start_dt0) AND in1.cal_end_dt = date_check(cal_end_dt1) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS DECIMAL(38,0))",
         "val-cols": [
           "in1.cms_stars_calendar_submission_sk as in1_cms_stars_calendar_submission_sk"
         ]
      },
      {
         "fmt": "table",
         "src": "ids_rxclaim.d_cms_pharmacy_cost",
         "join-cond": "in1.cms_contract_id = str_non_nk(asvwhc) AND in1.cms_pbp_id = str_non_nk(asvyhc) AND in1.cms_segment_id = str_non_nk(cms_segment_id4) AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt = date_check(prod_directory_dt1)",
         "val-cols": [
           "in1.cms_pharmacy_cost_sk as in1_cms_pharmacy_cost_sk"
         ]
      },
      {
         "fmt": "table",
         "src": "ids_common.d_member",
         "join-cond": "in1.carrier_id = in0.asaacd AND in1.account_id = in0.asaccd AND in1.employer_group_id = in0.asadcd AND in1.mbr_id = in0.asabcd",
         "val-cols": [
           "in1.mbr_sk as in1_mbr_sk"
         ]
      },
      {
         "fmt": "table",
         "src": "ids_rxclaim.d_cms_drug_pricing_file",
         "join-cond": "in1.cms_contract_id = str_non_nk(asvwhc) AND in1.price_id = str_non_nk(price_id4) AND in1.cms_proxy_ndc_id = str_non_nk(prod_id6) AND in1.days_of_supply = CAST(CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) AND in1.pricing_file_mail_flg = str_non_nk(phr_mail_flg4) AND in1.prod_directory_dt = date_check(prod_directory_dt1)",
         "val-cols": [
           "in1.cms_drug_pricing_file_sk as in1_cms_drug_pricing_file_sk"
         ]
      },
      {
         "fmt": "table",
         "src": "ids_common.d_product",
         "join-cond": "in1.prod_id = trim(in0.asric4) AND in1.prod_id_qlfr_cd = '03'",
         "val-cols": [
           "in1.prod_sk as in1_prod_sk"
         ]
      },
      {
         "fmt": "table",
         "src": "ids_rxclaim.d_cms_prxy_ndc_rxcui",
         "join-cond": "in1.prod_id = trim(in0.asric4) AND in1.rxcui = CAST(rxcui7 AS DECIMAL(38,0)) AND in1.active_ind = 'Y' AND in1.mpd_ind = 'Y' AND in1.ext_ovrd_id = ext_ovrd_id7 AND in1.efft_dt = efft_dt7 AND in1.rxcui_type_cd = rxcui_type_cd7 AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS DECIMAL(38,0))",
         "val-cols": [
           "in1.cms_proxy_ndc_rxcui_sk as in1_cms_proxy_ndc_rxcui_sk"
         ]
      },
      {
         "fmt": "csv",
         "src": "/{AI_SERIAL_LOOKUP}/lookup.ids_rxclaim/lookup.ids_rxclaim.d_cms_prxy_ndc_rxcui.dat",
         "join-cond": "in1.prod_id = trim(str_non_nk(prod_id6)) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT) AND in1.efft_dt = CAST(in0.asbbda AS STRING)",
         "val-cols": [
           "in1.prod_lbl AS prod_lbl8"
         ]
      },
      {
         "fmt": "csv",
         "src": "/{AI_SERIAL_LOOKUP}/lookup.ids_rxclaim/lookup.ids_rxclaim.l_residence.dat",
         "join-cond": "in1.residence_cd = str_non_nk(asaxod)",
         "val-cols": [
           "in1.residence_cd_desc AS residence_cd_desc9"
         ]
      },
      {
         "fmt": "csv",
         "src": "/{AI_SERIAL_LOOKUP}/lookup.rxclaim_ctrx/lookup.rxclaim_ctrx.rcmdhp.dat",
         "join-cond": "in1.aqpwih = in0.aspwih",
         "val-cols": [
           "in1.aqc2dt AS aqc2dt10",
           "in1.aqadtm AS aqadtm10",
           "in1.aqnfce AS aqnfce10",
           "in1.aqbqtz AS aqbqtz10",
           "in1.aqo1hg AS aqo1hg10",
           "in1.aqo2hg AS aqo2hg10",
           "in1.aqveh9 AS aqveh910",
           "in1.aqf1hf AS aqf1hf10",
           "in1.aqeyai AS aqeyai10",
           "in1.aqfuhs AS aqfuhs10",
           "in1.aqfvhs AS aqfvhs10",
           "in1.aqadht AS aqadht10",
           "in1.aqfwhs AS aqfwhs10",
           "in1.aqakvn AS aqakvn10",
           "in1.aqalvn AS aqalvn10",
           "in1.aqadvn AS aqadvn10",
           "in1.aqbmdt AS aqbmdt10",
           "in1.aqabtm AS aqabtm10",
           "in1.aqaevn AS aqaevn10"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.cms_contract_id = trim(in0.asvwhc) AND in1.price_id = price_id3 AND in1.cms_proxy_ndc_id = trim(str_non_nk(prod_id6)) AND in1.days_of_supply = CAST(CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) AND in1.pricing_file_mail_flg = phr_mail_flg3 AND in1.prod_directory_dt_sk = prod_directory_dt_sk0",
         "val-cols": [
           "in1.unit_cost AS unit_cost11"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.e0p2nb = CAST(in0.asp2nb AS DECIMAL(17,0)) AND in1.e0oinb = CAST(in0.asoinb AS DECIMAL(5,0)) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT)",
         "val-cols": [
           "in1.e0uicd AS e0uicd12"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.dnp2nb = CAST(in0.asp2nb AS DECIMAL(17,0)) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT)",
         "val-cols": [
           "in1.dnkust AS dnkust13"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.rip2nb = CAST(in0.asp2nb AS DECIMAL(17,0)) AND in1.rioinb = CAST(in0.asoinb AS DECIMAL(5,0)) AND in1.src_env_sk = CAST(in0.dxf_src_sys_id AS INT)",
         "val-cols": [
           "in1.riawod AS riawod14"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.prod_id = trim(in0.asric4)",
         "val-cols": [
           "in1.package_size_uom_cd AS package_size_uom_cd15"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.prod_id = trim(str_non_nk(prod_id6))",
         "val-cols": [
           "in1.package_size_uom_cd AS package_size_uom_cd16",
           "in1.drg_ndc_term_dt AS drg_ndc_term_dt16"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.cms_contract_id = in0.asvwhc AND in1.cms_pbp_id = in0.asvyhc AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt_sk = prod_directory_dt_sk0",
         "val-cols": [
           "in1.brand_dispensing_fee_30 AS brand_dispensing_fee_3017",
           "in1.generic_dispensing_fee_30 AS generic_dispensing_fee_3017",
           "in1.brand_dispensing_fee_60 AS brand_dispensing_fee_6017",
           "in1.generic_dispensing_fee_60 AS generic_dispensing_fee_6017",
           "in1.brand_dispensing_fee_90 AS brand_dispensing_fee_9017",
           "in1.generic_dispensing_fee_90 AS generic_dispensing_fee_9017"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.cms_contract_id = trim(in0.asvwhc) AND in1.price_id = price_id4 AND in1.cms_proxy_ndc_id = trim(str_non_nk(prod_id6)) AND in1.days_of_supply = CAST(CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(in0.asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(in0.asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) AND in1.pricing_file_mail_flg = phr_mail_flg4 AND in1.prod_directory_dt_sk = prod_directory_dt_sk1",
         "val-cols": [
           "in1.pricing_file_mail_flg AS pricing_file_mail_flg18"
         ]
      },
      {
         "fmt": "delta",
         "src": "/path",
         "join-cond": "in1.cms_contract_id = in0.asvwhc AND in1.cms_pbp_id = in0.asvyhc AND in1.cms_phr_npi_id = str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END) AND in1.prod_directory_dt_sk = prod_directory_dt_sk1",
         "val-cols": [
           "in1.floor_price AS floor_price19"
         ]
      },
      {
         "fmt": "csv",
         "src": "/{AI_SERIAL_LOOKUP}/lookup.rxclaim_ctrx/lookup.rxclaim_ctrx.rcmdhp.dat",
         "join-cond": "in1.aqpwih = trim(in0.aspwih)",
         "val-cols": [
           "in1.aqp3ih AS aqp3ih20"
         ]
      }
  ]

{
  "pde_clm_rcvd_dt" : "coalesce(date_format(to_date(CAST(asaqce AS STRING), 'yyyyMMdd'), 'yyyyMMdd'), date_format(to_date('19000101', 'yyyyMMdd'), 'yyyyMMdd'))",
  "mdh_add_pgm" : "str_non_nk(aqalvn10)",
  "pde_paid_dt" : "date_check(CAST(asaoce AS DECIMAL(10,0)))",
  "mdh_add_ts" : "date_format(to_timestamp(concat(date_check(aqc2dt10), time_check(aqadtm10)), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')",
  "pde_resubmission_stat" : "str_non_nk(askmia)",
  "pde_pat_pay_amt" : "numeric_non_nk(CAST(asfuik AS DECIMAL(11,2)))",
  "sbm_prod_select_cd" : "str_non_nk(ask3st)",
  "alt_srv_provider_qual" : "str_non_nk(asb2hn)",
  "pde_brand_generic_cd" : "str_non_nk(asc4ai)",
  "pde_edit_cd_9" : "str_non_nk(asc7hd)",
  "pde_residence_cd_desc" : "str_non_nk(residence_cd_desc9)",
  "pde_vaccn_fee" : "numeric_non_nk(CAST(asfwik AS DECIMAL(11,2)))",
  "cag_sk" : "in1_cag_sk",
  "cal_start_dt" : "date_check(cal_start_dt0)",
  "pde_proxy_prod_id" : "str_non_nk(prod_id6)",
  "pde_file_sbm_ts" : "date_format(to_timestamp(concat(date_check(aqc2dt10), time_check(aqadtm10)), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')",
  "pde_gdca_amt" : "numeric_non_nk(CAST(asclik AS DECIMAL(11,2)))",
  "pde_trans_rpt_sts_ts" : "date_format(to_timestamp(concat(date_check(CAST(aswwhg AS DECIMAL(9,0))), time_check(CAST(asvghe AS DECIMAL(8,0)))), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')",
  "phr_hi_flg" : "str_non_nk(phr_hi_flg4)",
  "pde_clnt_lst_nm" : "str_non_nk(aqf1hf10)",
  "pde_edit_cd_5" : "str_non_nk(asc3hd)",
  "pde_prod_id" : "str_non_nk(asric4)",
  "mdh_det_rcd_infml" : "CAST(numeric_non_nk(aqadht10) AS DECIMAL(38,0))",
  "mdd_add_user_id" : "str_non_nk(asakvn)",
  "sales_tax" : "numeric_non_nk(CAST(asbhqu AS DECIMAL(11,2)))",
  "tot_est_pde_cost" : "CAST((CAST(numeric_non_nk(CAST(asbfqu AS DECIMAL(11,2))) AS DECIMAL(14,2)) + CAST(numeric_non_nk(CAST(asbgqu AS DECIMAL(11,2))) AS DECIMAL(10,2))) AS STRING)",
  "pde_proxy_ndc_label_nm" : "str_non_nk(prod_lbl8)",
  "mdd_seq_nbr" : "CAST(numeric_non_nk(CAST(asf0hs AS DECIMAL(9,0))) AS DECIMAL(38,0))",
  "pde_carrier_id" : "str_non_nk(asaacd)",
  "phr_cost_type" : "str_non_nk(e0uicd12)",
  "catast_cvg_cd" : "str_non_nk(asvjh9)",
  "cal_end_dt" : "date_check(cal_end_dt0)",
  "cms_drug_pricing_file_sk" : "in1_cms_drug_pricing_file_sk",
  "pde_record_id" : "str_non_nk(ascfhn)",
  "corrected_medicare_id" : "str_non_nk(aspxih)",
  "pde_gap_discnt_amt" : "numeric_non_nk(CAST(asbkqu AS DECIMAL(11,2)))",
  "pde_phr_npi_id" : "str_non_nk(CASE WHEN (trim(asn5ia) = '01') THEN str_non_nk(asythe) ELSE CASE WHEN (NOT (trim(asn5ia) = '01')) THEN phr_npi_no2 END END)",
  "pde_sbmtr_id" : "str_non_nk(aqp3ih20)",
  "price_id" : "str_non_nk(price_id3)",
  "pde_phr_id" : "str_non_nk(asythe)",
  "pde_edit_cd_6" : "str_non_nk(asc4hd)",
  "pde_medicare_id" : "str_non_nk(asb0hn)",
  "sbm_prescriber_qual" : "str_non_nk(asilcj)",
  "mpf_days_of_supply" : "CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0))",
  "final_pln_eff_dt" : "date_check(CAST(asasda AS DECIMAL(9,0)))",
  "pde_reproces_uid" : "str_non_nk(asd2io)",
  "pde_ndc_uom" : "str_non_nk(package_size_uom_cd15)",
  "pde_reproc_ts" : "date_format(to_timestamp(concat(date_check(CAST(aswyhg AS DECIMAL(9,0))), time_check(CAST(asvihe AS DECIMAL(8,0)))), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')",
  "contract_of_record" : "str_non_nk(asb5hn)",
  "pde_final_pln_cd" : "str_non_nk(astjcd)",
  "pde_group_id" : "str_non_nk(asadcd)",
  "pde_edit_cd_3" : "str_non_nk(asc1hd)",
  "pde_ndc_label_nm" : "str_non_nk(prod_lbl5)",
  "cms_stat_id" : "str_non_nk(asklia)",
  "pde_othr_troop_amt" : "numeric_non_nk(CAST(ase6ik AS DECIMAL(11,2)))",
  "pde_plro_amt" : "numeric_non_nk(CAST(ascnik AS DECIMAL(11,2)))",
  "pde_edit_cd_8" : "str_non_nk(asc6hd)",
  "pde_edit_cnt" : "CAST(numeric_non_nk(CAST(trim(CAST(asf1hs AS DECIMAL(5,0))) AS STRING)) AS DECIMAL(38,0))",
  "pde_exclution_rsn_cd" : "str_non_nk(asfdie)",
  "pde_reproc_sbmtr_id" : "str_non_nk(aslcij)",
  "prod_sk" : "in1_prod_sk",
  "proxy_ndc_uom" : "str_non_nk(package_size_uom_cd16)",
  "mbr_sk" : "in1_mbr_sk",
  "pde_edit_cd_7" : "str_non_nk(asc5hd)",
  "pde_edit_cd_1" : "str_non_nk(asczhd)",
  "pde_npp_amt" : "numeric_non_nk(CAST(ascpik AS DECIMAL(11,2)))",
  "sbm_rx_nbr" : "str_non_nk(asukcd)",
  "pde_dispensing_fee" : "numeric_non_nk(CAST(asbgqu AS DECIMAL(11,2)))",
  "mdd_fill_type" : "str_non_nk(aswgat)",
  "pde_adj_rsn_cd" : "str_non_nk(asbbve)",
  "mdh_chg_user_id" : "str_non_nk(aqadvn10)",
  "pde_version" : "str_non_nk(aqeyai10)",
  "pde_reproc_file_id" : "str_non_nk(aslbij)",
  "mdh_add_user_id" : "str_non_nk(aqakvn10)",
  "pde_rx_org_cd" : "str_non_nk(ask6st)",
  "mdd_chg_pgm" : "str_non_nk(asaevn)",
  "pde_gpi_id" : "str_non_nk(gpi_id5)",
  "pde_formulary_cd" : "str_non_nk(asc8ai)",
  "mdh_det_rcd_accpt" : "CAST(numeric_non_nk(aqfvhs10) AS DECIMAL(38,0))",
  "pbp_of_record" : "str_non_nk(asb1hn)",
  "pde_drg_qty" : "numeric_non_nk(CAST(asionb AS DECIMAL(13,3)))",
  "pricing_file_mail_flg" : "str_non_nk(coalesce(pricing_file_mail_flg18, phr_mail_flg4))",
  "pde_file_type" : "str_non_nk(aqveh910)",
  "pde_file_id" : "str_non_nk(aspwih)",
  "drop_record" : "lpad(CASE WHEN (flg = 'R') THEN 0 ELSE 2 END, 1, ' ')",
  "pde_resbm_cms_type" : "str_non_nk(asaoib)",
  "cms_segment_id" : "str_non_nk(cms_segment_id3)",
  "pl_of_svc_submd" : "str_non_nk(riawod14)",
  "sbm_srv_provider_qual" : "str_non_nk(asn5ia)",
  "pde_lics_amt" : "numeric_non_nk(CAST(ascmik AS DECIMAL(11,2)))",
  "pde_file_from_dt" : "date_check(aqo1hg10)",
  "phr_retail_flg" : "str_non_nk(phr_retail_flg4)",
  "cms_cal_gap_dscnt_amt" : "numeric_non_nk(CAST(asblqu AS DECIMAL(11,2)))",
  "pde_edit_cd_2" : "str_non_nk(asc0hd)",
  "pde_filled_dt" : "date_check(CAST(asbbda AS DECIMAL(10,0)))",
  "pde_claim_seq_nbr_src" : "CAST((1000 - numeric_non_nk(CAST(asoinb AS DECIMAL(5,0)))) AS DECIMAL(38,0))",
  "mdd_add_pgm" : "str_non_nk(asalvn)",
  "pde_edit_cd_4" : "str_non_nk(asc2hd)",
  "pde_gdcb_amt" : "numeric_non_nk(CAST(asckik AS DECIMAL(11,2)))",
  "mdh_det_rcd_rejct" : "CAST(numeric_non_nk(aqfwhs10) AS DECIMAL(38,0))",
  "pde_resbm_sts_ts" : "date_format(to_timestamp(concat(date_check(CAST(aswxhg AS DECIMAL(9,0))), time_check(CAST(asvhhe AS DECIMAL(8,0)))), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')",
  "mpf_ndc_unit_cost" : "numeric_non_nk(unit_cost11)",
  "pde_ndc_inactive_dt" : "CASE WHEN (date_check(drg_ndc_term_dt16) = '19000101') THEN '19000101' ELSE date_check(date_format(to_date(add_months(drg_ndc_term_dt16, -18), 'yyyy-MM-dd HH:mm:ss.SSSS'), 'yyyyMMdd')) END",
  "preferred_status_mail_flg" : "str_non_nk(preferred_status_mail_flg4)",
  "pde_file_thru_dt" : "date_check(aqo2hg10)",
  "pde_residence_cd" : "str_non_nk(asaxod)",
  "phr_la_drugs_flg" : "str_non_nk(phr_la_drugs_flg4)",
  "sbm_clarification_cd" : "str_non_nk(ask7st)",
  "phr_mail_flg" : "str_non_nk(phr_mail_flg4)",
  "pde_account_id" : "str_non_nk(asaccd)",
  "tot_mpf_drug_cost" : "CAST((CAST(numeric_non_nk(unit_cost11) AS DECIMAL(14,4)) * CAST(numeric_non_nk(CAST(asionb AS DECIMAL(13,3))) AS DECIMAL(12,3))) AS STRING)",
  "pde_days_of_supply" : "CAST(numeric_non_nk(CAST(asimnb AS DECIMAL(5,0))) AS DECIMAL(38,0))",
  "prod_directory_dt" : "date_check(prod_directory_dt1)",
  "cms_stars_calendar_submission_sk" : "in1_cms_stars_calendar_submission_sk",
  "pde_contract_id" : "str_non_nk(asvwhc)",
  "pde_est_rbt_amt" : "numeric_non_nk(CAST(asfvik AS DECIMAL(11,2)))",
  "pde_true_troop_accom" : "numeric_non_nk(CAST(asbjqu AS DECIMAL(11,2)))",
  "pde_adj_rsn_cd_qual" : "str_non_nk(asy0ar)",
  "mdd_chg_ts" : "date_format(to_timestamp(concat(CAST(asbmdt AS DECIMAL(9,0)), time_check(CAST(asabtm AS DECIMAL(8,0)))), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')",
  "cur_claim_stat_id" : "str_non_nk(dnkust13)",
  "pde_pbp_id" : "str_non_nk(asvyhc)",
  "pde_drug_tier" : "str_non_nk(asc7ai)",
  "pde_resbm_uid" : "str_non_nk(asd1io)",
  "gap_discnt_pln_ovcd" : "str_non_nk(asc9ai)",
  "tot_est_discrepancy" : "CAST(((CAST(numeric_non_nk(CAST(asbfqu AS DECIMAL(11,2))) AS DECIMAL(14,2)) + CAST(numeric_non_nk(CAST(asbgqu AS DECIMAL(11,2))) AS DECIMAL(10,2))) - ((CAST(numeric_non_nk(unit_cost11) AS DECIMAL(14,4)) * CAST(numeric_non_nk(CAST(asionb AS DECIMAL(13,3))) AS DECIMAL(12,3))) + CAST(numeric_non_nk(CASE WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN brand_dispensing_fee_3017 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN generic_dispensing_fee_3017 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN brand_dispensing_fee_6017 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN generic_dispensing_fee_6017 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN brand_dispensing_fee_9017 ELSE CASE WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN generic_dispensing_fee_9017 END END) AS DECIMAL(14,4)))) AS STRING)",
  "tot_pde_drug_cost" : "numeric_non_nk(CAST(asbfqu AS DECIMAL(11,2)))",
  "mdh_chg_pgm" : "str_non_nk(aqaevn10)",
  "pde_ben_phs_begn" : "str_non_nk(asc5ai)",
  "pde_non_stnd_cd" : "str_non_nk(asvhh9)",
  "pde_cpp_amt" : "numeric_non_nk(CAST(ascoik AS DECIMAL(11,2)))",
  "price_exceptn_cd" : "str_non_nk(asvih9)",
  "preferred_status_retail_flg" : "str_non_nk(preferred_status_retail_flg4)",
  "cms_pharmacy_cost_sk" : "in1_cms_pharmacy_cost_sk",
  "pde_dispns_stat" : "str_non_nk(asj3cj)",
  "pde_pbr_id" : "str_non_nk(astccd)",
  "pde_mbr_id" : "str_non_nk(asabcd)",
  "mdd_add_ts" : "date_format(to_timestamp(concat(CAST(asc2dt AS DECIMAL(9,0)), time_check(CAST(asadtm AS DECIMAL(8,0)))), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')",
  "pde_claim_stat_id" : "str_non_nk(ass6st)",
  "pde_ndc_cost" : "numeric_non_nk(CAST(asbfqu AS DECIMAL(11,2)))",
  "pde_compound_cd" : "str_non_nk(ask2st)",
  "src_env_sk" : "CAST(dxf_src_sys_id AS DECIMAL(38,0))",
  "mdh_file_trns_dt" : "date_check(aqc2dt10)",
  "mdd_chg_user_id" : "str_non_nk(asadvn)",
  "pde_tot_drg_grs_cost" : "numeric_non_nk(CAST(asbiqu AS DECIMAL(11,2)))",
  "phr_ltc_flg" : "str_non_nk(phr_ltc_flg4)",
  "pde_file_proc_ts" : "date_format(to_timestamp(concat(date_check(aqnfce10), time_check(aqbqtz10)), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')",
  "pde_ndc_unit_cost" : "(numeric_non_nk(CAST(asbfqu AS DECIMAL(11,2))) / numeric_non_nk(CAST(asionb AS DECIMAL(13,3))))",
  "pde_drg_cvg_cd" : "str_non_nk(aso6h9)",
  "orig_sbm_contract_id" : "str_non_nk(asb4hn)",
  "pde_edit_cd_10" : "str_non_nk(asc8hd)",
  "mdh_chg_ts" : "date_format(to_timestamp(concat(date_check(aqbmdt10), time_check(aqabtm10)), 'yyyyMMddHHmmss'), 'yyyyMMdd HH:mm:ss')",
  "floor_price" : "numeric_non_nk(floor_price19)",
  "pde_claim_nbr" : "CAST(numeric_nk(CAST(asp2nb AS DECIMAL(17,0))) AS DECIMAL(38,0))",
  "mpf_dispensing_fee" : "numeric_non_nk(CASE WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN brand_dispensing_fee_3017 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN generic_dispensing_fee_3017 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN brand_dispensing_fee_6017 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN generic_dispensing_fee_6017 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN brand_dispensing_fee_9017 ELSE CASE WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN generic_dispensing_fee_9017 END END)",
  "alt_srv_provider_id" : "str_non_nk(asb3hn)",
  "mdh_det_rcd_count" : "CAST(numeric_non_nk(aqfuhs10) AS DECIMAL(38,0))",
  "pde_ben_phs_end" : "str_non_nk(asc6ai)",
  "pde_refill_nbr" : "str_non_nk(asulcd)",
  "trans_rpt_sts_uid" : "str_non_nk(asd0io)",
  "pde_adj_del_cd" : "str_non_nk(asvgh9)",
  "adj_begin_ts" : "date_format(to_timestamp(substring(CAST(asbqir AS STRING), 1, 20), 'yyyy-MM-dd-HH.mm.ss.'), 'yyyyMMdd HH:mm:ss')",
  "pde_phr_svc_typ" : "str_non_nk(asavod)",
  "cms_proxy_ndc_rxcui_sk" : "in1_cms_proxy_ndc_rxcui_sk",
  "pde_ndc_obsolete_dt" : "date_check(drg_ndc_term_dt16)",
  "claim_phr_sk" : "CAST(numeric_non_nk(phr_sk2) AS DECIMAL(38,0))",
  "tot_est_mpf_cost" : "CAST(((CAST(numeric_non_nk(unit_cost11) AS DECIMAL(14,4)) * CAST(numeric_non_nk(CAST(asionb AS DECIMAL(13,3))) AS DECIMAL(12,3))) + CAST(numeric_non_nk(CASE WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN brand_dispensing_fee_3017 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 30)) THEN generic_dispensing_fee_3017 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN brand_dispensing_fee_6017 WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 60)) THEN generic_dispensing_fee_6017 WHEN ((str_non_nk(asc4ai) = 'B') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN brand_dispensing_fee_9017 ELSE CASE WHEN ((str_non_nk(asc4ai) = 'G') AND (CAST(CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 28) AND (CAST(asimnb AS DECIMAL(5,0)) <= 34)) THEN 30 WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 60) AND (CAST(asimnb AS DECIMAL(5,0)) <= 62)) THEN 60 ELSE CASE WHEN ((CAST(asimnb AS DECIMAL(5,0)) >= 90) AND (CAST(asimnb AS DECIMAL(5,0)) <= 93)) THEN 90 END END AS DECIMAL(38,0)) = 90)) THEN generic_dispensing_fee_9017 END END) AS DECIMAL(14,4))) AS STRING)"
}

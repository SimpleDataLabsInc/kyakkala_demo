{
    "final_table_schema" : "{\"qmb_sk\": \"double\",\n\"mbr_sk\": \"double\",\n\"cag_sk\": \"double\",\n\"carrier_sk\": \"double\",\n\"carrier_id\": \"string\",\n\"account_id\": \"string\",\n\"employer_group_id\": \"string\",\n\"mbr_id\": \"string\",\n\"qmb_medicare_id\": \"string\",\n\"qmb_seq_no\": \"double\",\n\"qmb_medicaid_dual_sts_cd\": \"string\",\n\"qmb_from_dt_sk\": \"double\",\n\"qmb_from_dt\": \"date\",\n\"qmb_thru_dt_sk\": \"double\",\n\"qmb_thru_dt\": \"date\",\n\"qmb_status_cd\": \"string\",\n\"src_env_sk\": \"double\",\n\"sec_flg\": \"double\",\n\"rec_stat_cd\": \"short\",\n\"run_id\": \"long\",\n\"update_uid\": \"string\",\n\"update_ts\": \"timestamp\",\n\"insert_uid\": \"string\",\n\"insert_ts\": \"timestamp\"}",
    "length_rules" : "CASE WHEN (length(carrier_id) > 30) THEN 'carrier_id' WHEN (length(account_id) > 40) THEN 'account_id' WHEN (length(employer_group_id) > 30) THEN 'employer_group_id' WHEN (length(mbr_id) > 20) THEN 'mbr_id' WHEN (length(qmb_medicare_id) > 20) THEN 'qmb_medicare_id' WHEN (length(qmb_medicaid_dual_sts_cd) > 2) THEN 'qmb_medicaid_dual_sts_cd' WHEN (length(qmb_from_dt) > 8) THEN 'qmb_from_dt' WHEN (length(qmb_thru_dt) > 8) THEN 'qmb_thru_dt' WHEN (length(qmb_status_cd) > 1) THEN 'qmb_status_cd'  ELSE 'pass' END",
    "pipeline_name" : "orx_d_qual_medicare_benf",
    "primary_key" : "",
    "reformat_rules" : "{\n  \"qmb_thru_dt_sk\" : \"in1_qmb_thru_dt_sk\",\n  \"cag_sk\" : \"in1_cag_sk\",\n  \"mbr_id\" : \"getDefaultedElseTrimmed(CAST(ahabcd AS STRING), '')\",\n  \"sec_flg\" : \"0\",\n  \"mbr_sk\" : \"in1_mbr_sk\",\n  \"qmb_sk\" : \"-1\",\n  \"qmb_seq_no\" : \"CASE WHEN isNullOrBlank(ahp0bt) THEN '' ELSE coalesce(ahp0bt, force_error('Not a valid number')) END\",\n  \"qmb_from_dt\" : \"CASE WHEN coalesce((array_contains(array(6, 7), length(trim(ahm5cg))) AND ((NOT (CASE WHEN (length(trim((19000000 + trim(CAST(ahm5cg AS DECIMAL(9,0)))))) = 8) THEN date_format(to_date(trim((19000000 + trim(CAST(ahm5cg AS DECIMAL(9,0))))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim((19000000 + trim(ahm5cg)))) = 8) THEN date_format(to_date(trim((19000000 + trim(ahm5cg))), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce(((length(trim(ahm5cg)) = 8) AND ((NOT (CASE WHEN (length(trim(trim(CAST(ahm5cg AS DECIMAL(9,0))))) = 8) THEN date_format(to_date(trim(trim(CAST(ahm5cg AS DECIMAL(9,0)))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(trim(ahm5cg))) = 8) THEN date_format(to_date(trim(trim(ahm5cg)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\",\n  \"qmb_from_dt_sk\" : \"in1_qmb_from_dt_sk\",\n  \"qmb_medicaid_dual_sts_cd\" : \"getDefaultedElseTrimmed(CAST(ahiiax AS STRING), '-')\",\n  \"carrier_sk\" : \"in1_carrier_sk\",\n  \"account_id\" : \"getDefaultedElseTrimmed(CAST(ahaccd AS STRING), '')\",\n  \"carrier_id\" : \"getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '')\",\n  \"qmb_medicare_id\" : \"getDefaultedElseTrimmed(CAST(ahg1vi AS STRING), '')\",\n  \"employer_group_id\" : \"getDefaultedElseTrimmed(CAST(ahadcd AS STRING), '')\",\n  \"qmb_status_cd\" : \"getDefaultedElseTrimmed(CAST(ahijax AS STRING), '-')\",\n  \"src_env_sk\" : \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\n  \"qmb_thru_dt\" : \"CASE WHEN coalesce((array_contains(array(6, 7), length(trim(ahm6cg))) AND ((NOT (CASE WHEN (length(trim((19000000 + trim(CAST(ahm6cg AS DECIMAL(9,0)))))) = 8) THEN date_format(to_date(trim((19000000 + trim(CAST(ahm6cg AS DECIMAL(9,0))))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim((19000000 + trim(ahm6cg)))) = 8) THEN date_format(to_date(trim((19000000 + trim(ahm6cg))), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce(((length(trim(ahm6cg)) = 8) AND ((NOT (CASE WHEN (length(trim(trim(CAST(ahm6cg AS DECIMAL(9,0))))) = 8) THEN date_format(to_date(trim(trim(CAST(ahm6cg AS DECIMAL(9,0)))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(trim(ahm6cg))) = 8) THEN date_format(to_date(trim(trim(ahm6cg)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\"\n}",
    "reformat_rules_join" : "joins = [\n    {\n       \"fmt\": \"table\",\n       \"src\": \"ids_common.d_cag\",\n       \"join-cond\": \"in1.carrier_id = getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '') AND in1.account_id = getDefaultedElseTrimmed(CAST(ahaccd AS STRING), '') AND in1.employer_group_id = getDefaultedElseTrimmed(CAST(ahadcd AS STRING), '')\",\n       \"val-cols\": [\n         \"in1.cag_sk as in1_cag_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"ids_common.d_carrier\",\n       \"join-cond\": \"in1.carrier_id = getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '')\",\n       \"val-cols\": [\n         \"in1.carrier_sk as in1_carrier_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"ids_common.d_date\",\n       \"join-cond\": \"in1.cal_day_dt = CASE WHEN coalesce((array_contains(array(6, 7), length(trim(in0.ahm5cg))) AND ((NOT (CASE WHEN (length(trim((19000000 + trim(CAST(in0.ahm5cg AS DECIMAL(9,0)))))) = 8) THEN date_format(to_date(trim((19000000 + trim(CAST(in0.ahm5cg AS DECIMAL(9,0))))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim((19000000 + trim(in0.ahm5cg)))) = 8) THEN date_format(to_date(trim((19000000 + trim(in0.ahm5cg))), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce(((length(trim(in0.ahm5cg)) = 8) AND ((NOT (CASE WHEN (length(trim(trim(CAST(in0.ahm5cg AS DECIMAL(9,0))))) = 8) THEN date_format(to_date(trim(trim(CAST(in0.ahm5cg AS DECIMAL(9,0)))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(trim(in0.ahm5cg))) = 8) THEN date_format(to_date(trim(trim(in0.ahm5cg)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\",\n       \"val-cols\": [\n         \"in1.qmb_from_dt_sk as in1_qmb_from_dt_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"ids_common.d_member\",\n       \"join-cond\": \"in1.carrier_id = getDefaultedElseTrimmed(CAST(ahaacd AS STRING), '') AND in1.account_id = getDefaultedElseTrimmed(CAST(ahaccd AS STRING), '') AND in1.employer_group_id = getDefaultedElseTrimmed(CAST(ahadcd AS STRING), '') AND in1.mbr_id = getDefaultedElseTrimmed(CAST(ahabcd AS STRING), '')\",\n       \"val-cols\": [\n         \"in1.mbr_sk as in1_mbr_sk\"\n       ]\n    },\n    {\n       \"fmt\": \"table\",\n       \"src\": \"ids_common.d_date\",\n       \"join-cond\": \"in1.cal_day_dt = CASE WHEN coalesce((array_contains(array(6, 7), length(trim(in0.ahm6cg))) AND ((NOT (CASE WHEN (length(trim((19000000 + trim(CAST(in0.ahm6cg AS DECIMAL(9,0)))))) = 8) THEN date_format(to_date(trim((19000000 + trim(CAST(in0.ahm6cg AS DECIMAL(9,0))))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim((19000000 + trim(in0.ahm6cg)))) = 8) THEN date_format(to_date(trim((19000000 + trim(in0.ahm6cg))), 'yyyyMMdd'), 'yyyyMMdd') END WHEN coalesce(((length(trim(in0.ahm6cg)) = 8) AND ((NOT (CASE WHEN (length(trim(trim(CAST(in0.ahm6cg AS DECIMAL(9,0))))) = 8) THEN date_format(to_date(trim(trim(CAST(in0.ahm6cg AS DECIMAL(9,0)))), 'yyyyMMdd'), 'yyyyMMdd') END IS NULL)) = 1)), CAST(0 AS BOOLEAN)) THEN CASE WHEN (length(trim(trim(in0.ahm6cg))) = 8) THEN date_format(to_date(trim(trim(in0.ahm6cg)), 'yyyyMMdd'), 'yyyyMMdd') END ELSE '$AI_MIN_DATETIME' END\",\n       \"val-cols\": [\n         \"in1.qmb_thru_dt_sk as in1_qmb_thru_dt_sk\"\n       ]\n    }\n]",
    "source_path" : "srcs = [{\n    \"fmt\" : \"parquet\",\n    \"src\" : \"dbfs:/PATH/*\"\n}]",
    "source_table" : "",
    "target_table" : ""
}
